2020-06-25 11:30:53 INFO 119: ['i-03041efb6b517cb3f', 'i-078bf0c7a41ccbe82', 'i-027d190ecb7bea37b', 'i-00b6a8e0bd7111afd', 'i-0f547c7be6214e537', 'i-0ed4ec2659400040f', 'i-03c498a4c0b3b784f', 'i-0ab31fe63d6480814']
2020-06-25 11:32:53 INFO 59: week start date 2020-05-29
2020-06-25 11:33:21 INFO 70: no of splits 8
2020-06-25 11:33:31 INFO 133: {'i-0ab31fe63d6480814': 'ec2-52-66-233-15.ap-south-1.compute.amazonaws.com', 'i-03c498a4c0b3b784f': 'ec2-13-235-62-189.ap-south-1.compute.amazonaws.com', 'i-0ed4ec2659400040f': 'ec2-3-6-116-56.ap-south-1.compute.amazonaws.com', 'i-027d190ecb7bea37b': 'ec2-13-234-11-63.ap-south-1.compute.amazonaws.com', 'i-078bf0c7a41ccbe82': 'ec2-15-206-213-19.ap-south-1.compute.amazonaws.com', 'i-0f547c7be6214e537': 'ec2-13-235-84-238.ap-south-1.compute.amazonaws.com', 'i-00b6a8e0bd7111afd': 'ec2-15-206-204-172.ap-south-1.compute.amazonaws.com', 'i-03041efb6b517cb3f': 'ec2-13-234-11-58.ap-south-1.compute.amazonaws.com'}
2020-06-25 11:33:35 INFO 156: The whole thing took: 2.72 min
2020-06-25 12:01:33 ERROR 173: extraction failed due to 
Traceback (most recent call last):
  File "extraction.py", line 108, in <module>
    for f in glob('usage*.csv'):
NameError: name 'glob' is not defined
2020-06-25 12:02:31 INFO 136: ['i-085b9c191332921be', 'i-09975d798721830c8', 'i-0cf70af415fd45434', 'i-072bb615608820ca2', 'i-0a1c9bdebe2ea82ef', 'i-0fe3b18103a000579', 'i-02ad4156e8313aa2a', 'i-0d7b5544d310a2ae4']
2020-06-25 12:04:31 INFO 61: week start date 2020-05-29
2020-06-25 12:04:48 INFO 71: Total students 882567
2020-06-25 12:04:48 INFO 72: usage data length 882567
2020-06-25 12:04:48 INFO 73: topics data length 208384
2020-06-25 12:04:48 INFO 77: no of splits 8
2020-06-25 12:04:58 INFO 150: {'i-0d7b5544d310a2ae4': 'ec2-13-233-135-168.ap-south-1.compute.amazonaws.com', 'i-09975d798721830c8': 'ec2-3-7-57-11.ap-south-1.compute.amazonaws.com', 'i-0cf70af415fd45434': 'ec2-52-66-215-236.ap-south-1.compute.amazonaws.com', 'i-085b9c191332921be': 'ec2-15-206-207-202.ap-south-1.compute.amazonaws.com', 'i-0fe3b18103a000579': 'ec2-13-235-252-123.ap-south-1.compute.amazonaws.com', 'i-02ad4156e8313aa2a': 'ec2-13-235-53-196.ap-south-1.compute.amazonaws.com', 'i-072bb615608820ca2': 'ec2-13-235-59-89.ap-south-1.compute.amazonaws.com', 'i-0a1c9bdebe2ea82ef': 'ec2-13-235-255-71.ap-south-1.compute.amazonaws.com'}
2020-06-25 12:05:00 INFO 173: The whole thing took: 2.5 min
2020-06-26 10:29:50 INFO 136: ['i-04c8a48d0b4cd1417']
2020-06-26 10:31:50 INFO 61: week start date 2020-05-29
2020-06-26 10:32:14 INFO 71: Total students 882567
2020-06-26 10:32:14 INFO 72: usage data length 882567
2020-06-26 10:32:14 INFO 73: topics data length 205715
2020-06-26 10:32:14 INFO 77: no of splits 1
2020-06-26 10:32:23 INFO 150: {'i-04c8a48d0b4cd1417': 'ec2-3-6-150-123.ap-south-1.compute.amazonaws.com'}
2020-06-26 10:32:27 INFO 173: The whole thing took: 2.64 min
2020-06-27 21:55:28 INFO 142: ['i-02d22283934d03a61']
2020-06-27 21:57:29 INFO 65: week start date 2020-05-29
2020-06-27 21:57:49 INFO 77: Total students 176
2020-06-27 21:57:49 INFO 78: usage data length 176
2020-06-27 21:57:49 INFO 79: topics data length 109
2020-06-27 21:57:49 INFO 83: no of splits 1
2020-06-27 21:57:49 INFO 156: {'i-02d22283934d03a61': 'ec2-52-66-224-207.ap-south-1.compute.amazonaws.com'}
2020-06-27 21:57:52 INFO 179: The whole thing took: 2.41 min
2020-06-27 22:07:33 INFO 144: ['i-0ef8c90012e6d2bff']
2020-06-27 22:09:34 INFO 67: week start date 2020-05-29
2020-06-27 22:09:34 INFO 44: select upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= 2020-05-29 and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > 2020-06-04) )
2020-06-27 22:09:34 INFO 54: select upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= 2020-05-29 and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > 2020-06-04) )
2020-06-27 22:09:36 INFO 79: Total students 176
2020-06-27 22:09:36 INFO 80: usage data length 176
2020-06-27 22:09:36 INFO 81: topics data length 109
2020-06-27 22:09:36 INFO 85: no of splits 1
2020-06-27 22:09:37 INFO 158: {'i-0ef8c90012e6d2bff': 'ec2-15-206-206-97.ap-south-1.compute.amazonaws.com'}
2020-06-27 22:09:38 INFO 181: The whole thing took: 2.09 min
2020-06-27 22:11:06 INFO 144: ['i-0bdb682205f593eb0']
2020-06-27 22:13:06 INFO 67: week start date 2020-05-29
2020-06-27 22:13:06 INFO 44: select upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
2020-06-27 22:13:10 INFO 54: select upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
2020-06-27 22:13:27 INFO 79: Total students 346279
2020-06-27 22:13:27 INFO 80: usage data length 346279
2020-06-27 22:13:27 INFO 81: topics data length 186920
2020-06-27 22:13:27 INFO 85: no of splits 1
2020-06-27 22:13:32 INFO 158: {'i-0bdb682205f593eb0': 'ec2-52-66-229-73.ap-south-1.compute.amazonaws.com'}
2020-06-27 22:13:33 INFO 181: The whole thing took: 2.48 min
2020-06-29 14:35:46 INFO 118: week start date 2020-05-29
2020-06-29 14:35:47 INFO 148: ['i-07bff9b322cf1eea5']
2020-06-29 14:37:47 INFO 45: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 14:37:58 INFO 56: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 14:38:08 INFO 73: Total students 3
2020-06-29 14:38:08 INFO 74: usage data length 3
2020-06-29 14:38:08 INFO 75: topics data length 96
2020-06-29 14:38:08 INFO 79: no of splits 1
2020-06-29 14:38:08 INFO 162: {'i-07bff9b322cf1eea5': 'ec2-52-66-225-252.ap-south-1.compute.amazonaws.com'}
2020-06-29 14:38:13 INFO 199: The whole thing took: 2.45 min
2020-06-29 14:50:39 INFO 118: week start date 2020-05-29
2020-06-29 14:50:39 ERROR 201: extraction failed due to 
Traceback (most recent call last):
  File "extraction.py", line 133, in <module>
    no_of_instances=int(sys.argv[1])
IndexError: list index out of range
2020-06-29 14:50:46 INFO 118: week start date 2020-05-29
2020-06-29 14:50:47 INFO 148: ['i-01cf62106bbc2f185']
2020-06-29 14:52:47 INFO 45: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 14:52:48 INFO 56: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 14:52:50 INFO 73: Total students 3
2020-06-29 14:52:50 INFO 74: usage data length 3
2020-06-29 14:52:50 INFO 75: topics data length 96
2020-06-29 14:52:50 INFO 79: no of splits 1
2020-06-29 14:52:50 INFO 162: {'i-01cf62106bbc2f185': 'ec2-15-206-184-107.ap-south-1.compute.amazonaws.com'}
2020-06-29 14:52:54 INFO 199: The whole thing took: 2.13 min
2020-06-29 15:02:49 INFO 118: week start date 2020-05-29
2020-06-29 15:02:51 INFO 148: ['i-052fc7d5c391ec2f6']
2020-06-29 15:04:51 INFO 45: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:04:51 INFO 56: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:04:53 INFO 73: Total students 3
2020-06-29 15:04:53 INFO 74: usage data length 3
2020-06-29 15:04:53 INFO 75: topics data length 96
2020-06-29 15:04:53 INFO 79: no of splits 1
2020-06-29 15:04:54 INFO 162: {'i-052fc7d5c391ec2f6': 'ec2-52-66-220-62.ap-south-1.compute.amazonaws.com'}
2020-06-29 15:04:56 INFO 199: The whole thing took: 2.11 min
2020-06-29 15:07:53 INFO 118: week start date 2020-05-29
2020-06-29 15:07:54 INFO 148: ['i-005fcf12dc7048854']
2020-06-29 15:09:54 INFO 45: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:09:55 INFO 56: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:09:57 INFO 73: Total students 3
2020-06-29 15:09:57 INFO 74: usage data length 3
2020-06-29 15:09:57 INFO 75: topics data length 96
2020-06-29 15:09:57 INFO 79: no of splits 1
2020-06-29 15:09:57 INFO 162: {'i-005fcf12dc7048854': 'ec2-3-7-37-5.ap-south-1.compute.amazonaws.com'}
2020-06-29 15:10:05 INFO 199: The whole thing took: 2.2 min
2020-06-29 15:12:38 INFO 118: week start date 2020-05-29
2020-06-29 15:12:39 INFO 148: ['i-0a0fab6b9fa8f5c36']
2020-06-29 15:14:39 INFO 45: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:14:40 INFO 56: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:14:42 INFO 73: Total students 3
2020-06-29 15:14:42 INFO 74: usage data length 3
2020-06-29 15:14:42 INFO 75: topics data length 96
2020-06-29 15:14:42 INFO 79: no of splits 1
2020-06-29 15:14:42 INFO 162: {'i-0a0fab6b9fa8f5c36': 'ec2-15-206-184-34.ap-south-1.compute.amazonaws.com'}
2020-06-29 15:14:49 INFO 199: The whole thing took: 2.19 min
2020-06-29 15:23:12 INFO 118: week start date 2020-05-29
2020-06-29 15:23:13 INFO 148: ['i-021cc13d8d06b07a4']
2020-06-29 15:25:13 INFO 45: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:25:14 INFO 56: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
    and upid in ('134942','5e82d57d56db69132260036e','1763782','5caaf7be56db6977ca788532')
2020-06-29 15:25:16 INFO 73: Total students 3
2020-06-29 15:25:16 INFO 74: usage data length 3
2020-06-29 15:25:16 INFO 75: topics data length 96
2020-06-29 15:25:16 INFO 79: no of splits 1
2020-06-29 15:25:16 INFO 162: {'i-021cc13d8d06b07a4': 'ec2-15-206-213-228.ap-south-1.compute.amazonaws.com'}
2020-06-29 15:25:18 INFO 199: The whole thing took: 2.11 min
2020-06-29 16:02:55 INFO 116: week start date 2020-05-29
2020-06-29 16:02:56 INFO 147: ['i-042569a867acc400f', 'i-0ecdd791b0a220faa', 'i-07620d79f53a97bfe', 'i-029158e9877578b2d', 'i-0d7383c24a0dd0566', 'i-04ecd8227be8690df', 'i-094a4326655f473a9', 'i-00d46359afd29f27d']
2020-06-29 16:04:56 INFO 44: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
2020-06-29 16:05:06 INFO 54: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
2020-06-29 16:05:17 INFO 71: Total students 346988
2020-06-29 16:05:17 INFO 72: usage data length 346988
2020-06-29 16:05:17 INFO 73: topics data length 187049
2020-06-29 16:05:17 INFO 77: no of splits 8
2020-06-29 16:05:22 INFO 161: {'i-042569a867acc400f': 'ec2-13-235-214-20.ap-south-1.compute.amazonaws.com', 'i-00d46359afd29f27d': 'ec2-3-6-7-164.ap-south-1.compute.amazonaws.com', 'i-04ecd8227be8690df': 'ec2-3-6-43-222.ap-south-1.compute.amazonaws.com', 'i-029158e9877578b2d': 'ec2-13-235-65-77.ap-south-1.compute.amazonaws.com', 'i-094a4326655f473a9': 'ec2-13-233-135-209.ap-south-1.compute.amazonaws.com', 'i-0d7383c24a0dd0566': 'ec2-3-7-250-161.ap-south-1.compute.amazonaws.com', 'i-07620d79f53a97bfe': 'ec2-13-235-57-214.ap-south-1.compute.amazonaws.com', 'i-0ecdd791b0a220faa': 'ec2-15-206-204-86.ap-south-1.compute.amazonaws.com'}
2020-06-29 16:39:57 INFO 198: The whole thing took: 37.03 min
2020-07-04 09:21:20 INFO 116: week start date 2020-06-26
2020-07-04 09:21:22 INFO 147: ['i-0d29e82067e18042b', 'i-0d93144304f83c500', 'i-05169724a8d2743a6', 'i-054e66b41fd14ef9f', 'i-009db6127b8724bb4', 'i-0342cf40ec057b50d', 'i-0b9b8c922f603af25', 'i-0f65965fb714c0544']
2020-07-04 09:23:22 INFO 44: select oldupid as upid,childname as child_name,class,gender,weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-04 09:23:30 INFO 54: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-06-26'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-04 09:23:39 INFO 71: Total students 189739
2020-07-04 09:23:39 INFO 72: usage data length 189739
2020-07-04 09:23:39 INFO 73: topics data length 76265
2020-07-04 09:23:39 INFO 77: no of splits 8
2020-07-04 09:23:41 INFO 161: {'i-0f65965fb714c0544': 'ec2-3-7-255-83.ap-south-1.compute.amazonaws.com', 'i-0b9b8c922f603af25': 'ec2-13-235-255-205.ap-south-1.compute.amazonaws.com', 'i-054e66b41fd14ef9f': 'ec2-13-235-84-180.ap-south-1.compute.amazonaws.com', 'i-0d93144304f83c500': 'ec2-52-66-217-69.ap-south-1.compute.amazonaws.com', 'i-0342cf40ec057b50d': 'ec2-13-235-60-105.ap-south-1.compute.amazonaws.com', 'i-05169724a8d2743a6': 'ec2-52-66-224-150.ap-south-1.compute.amazonaws.com', 'i-0d29e82067e18042b': 'ec2-15-206-184-2.ap-south-1.compute.amazonaws.com', 'i-009db6127b8724bb4': 'ec2-15-206-190-87.ap-south-1.compute.amazonaws.com'}
2020-07-04 09:44:29 INFO 222: The whole thing took: 23.13 min
2020-07-04 12:39:35 INFO 116: week start date 2020-06-26
2020-07-04 12:39:36 INFO 147: ['i-02365f902ebc1dd3f', 'i-0852850be87ab981a', 'i-048d43f0fc5144586', 'i-0ee937cec7bf434c9', 'i-04ef2f4dc5416e686', 'i-05fe0ff4ff97a3ffb', 'i-0c1ca83905c301f3a', 'i-0297f45ebf6ac5328']
2020-07-04 12:41:37 INFO 44: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy),weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-04 12:41:42 INFO 54: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-06-26'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-04 12:41:45 INFO 71: Total students 189739
2020-07-04 12:41:45 INFO 72: usage data length 189739
2020-07-04 12:41:45 INFO 73: topics data length 76265
2020-07-04 12:41:45 INFO 77: no of splits 8
2020-07-04 12:41:48 INFO 161: {'i-048d43f0fc5144586': 'ec2-15-206-183-128.ap-south-1.compute.amazonaws.com', 'i-05fe0ff4ff97a3ffb': 'ec2-3-7-59-131.ap-south-1.compute.amazonaws.com', 'i-04ef2f4dc5416e686': 'ec2-13-235-216-78.ap-south-1.compute.amazonaws.com', 'i-0ee937cec7bf434c9': 'ec2-13-234-14-88.ap-south-1.compute.amazonaws.com', 'i-0852850be87ab981a': 'ec2-13-235-55-199.ap-south-1.compute.amazonaws.com', 'i-02365f902ebc1dd3f': 'ec2-15-206-183-166.ap-south-1.compute.amazonaws.com', 'i-0297f45ebf6ac5328': 'ec2-15-206-2-84.ap-south-1.compute.amazonaws.com', 'i-0c1ca83905c301f3a': 'ec2-3-7-57-205.ap-south-1.compute.amazonaws.com'}
2020-07-04 12:50:05 INFO 222: The whole thing took: 10.49 min
2020-07-04 13:30:04 INFO 116: week start date 2020-06-26
2020-07-04 13:30:05 INFO 147: ['i-04391c9928ef3a073', 'i-010443452a63be1e3', 'i-04a0f2e2f48e58bb3', 'i-014d9622c1879f9d9', 'i-0c9297178d1b85650', 'i-0285d4b3f37fbb6d1', 'i-03ca32c94ecd73c9d', 'i-0e1cfd30f168b768e']
2020-07-04 13:32:05 INFO 44: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-04 13:32:09 INFO 54: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-06-26'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-04 13:32:12 INFO 71: Total students 189739
2020-07-04 13:32:12 INFO 72: usage data length 189739
2020-07-04 13:32:12 INFO 73: topics data length 76265
2020-07-04 13:32:12 INFO 77: no of splits 8
2020-07-04 13:32:15 INFO 161: {'i-0285d4b3f37fbb6d1': 'ec2-13-234-10-176.ap-south-1.compute.amazonaws.com', 'i-04a0f2e2f48e58bb3': 'ec2-13-235-55-133.ap-south-1.compute.amazonaws.com', 'i-04391c9928ef3a073': 'ec2-15-206-202-103.ap-south-1.compute.amazonaws.com', 'i-03ca32c94ecd73c9d': 'ec2-13-235-53-125.ap-south-1.compute.amazonaws.com', 'i-0e1cfd30f168b768e': 'ec2-13-235-255-118.ap-south-1.compute.amazonaws.com', 'i-014d9622c1879f9d9': 'ec2-13-235-215-94.ap-south-1.compute.amazonaws.com', 'i-0c9297178d1b85650': 'ec2-15-206-190-76.ap-south-1.compute.amazonaws.com', 'i-010443452a63be1e3': 'ec2-3-6-210-216.ap-south-1.compute.amazonaws.com'}
2020-07-04 13:53:38 INFO 222: The whole thing took: 23.56 min
2020-07-10 16:21:01 INFO 199: week start date 2020-07-03
2020-07-10 16:21:01 ERROR 313: extraction failed due to 
Traceback (most recent call last):
  File "extraction2.py", line 215, in <module>
    no_of_instances=int(sys.argv[1])
IndexError: list index out of range
2020-07-10 16:21:35 INFO 199: week start date 2020-07-03
2020-07-10 16:21:36 INFO 230: ['i-014ffa70243246ff9', 'i-092e70b28d88afcb5', 'i-0f941efbea27b9afc', 'i-041c2d14ea873ed22', 'i-083d7c3a4b3e44376', 'i-04e73dabc351cec6b', 'i-0ce44d257f333b30d', 'i-001938f3e72e09cd8']
2020-07-10 16:23:36 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-03' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 16:23:40 INFO 65: SELECT distinct MS_userid
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 16:23:44 ERROR 313: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2897, in get_loc
    return self._engine.get_loc(key)
  File "pandas/_libs/index.pyx", line 107, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 131, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1607, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1614, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'MS_userID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction2.py", line 233, in <module>
    split_and_save(no_of_instances)
  File "extraction2.py", line 108, in split_and_save
    b2c_users = set(b2c_users['MS_userID'])
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/frame.py", line 2995, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2899, in get_loc
    return self._engine.get_loc(self._maybe_cast_indexer(key))
  File "pandas/_libs/index.pyx", line 107, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 131, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1607, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1614, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'MS_userID'
2020-07-10 16:28:57 INFO 199: week start date 2020-07-03
2020-07-10 16:28:58 INFO 230: ['i-088f0da07a0434e72', 'i-0f969293a2f9a269b', 'i-0b9b8a6c4b458c095', 'i-0ade379bc398070a5', 'i-0f2898f3b120c276e', 'i-09fbaf36d050ebc9c', 'i-0b4a79eb50a1f075d', 'i-0af5e7dd7d81697f5']
2020-07-10 16:30:58 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-03' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 16:30:59 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 16:31:02 ERROR 313: extraction failed due to 
Traceback (most recent call last):
  File "extraction2.py", line 233, in <module>
    split_and_save(no_of_instances)
  File "extraction2.py", line 109, in split_and_save
    b2b_b2b2c_users = b2b_b2b2c(last_fri_str,thur_str)
NameError: name 'b2b_b2b2c' is not defined
2020-07-10 16:32:31 INFO 199: week start date 2020-07-03
2020-07-10 16:32:32 INFO 230: ['i-03da617307f1d2b4f', 'i-021b67c54bd479e35', 'i-00d0e199106330acd', 'i-05fde7a73279aa0cd', 'i-0dcfc39e25b2b72dd', 'i-08addb345066d4518', 'i-0f07e9e072a5e62cb', 'i-09ba3766af0bf7e24']
2020-07-10 16:34:32 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-03' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 16:34:39 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 16:34:45 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 16:35:20 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-03' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-03' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-09') )
2020-07-10 16:35:29 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-03'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-03' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-09') )
2020-07-10 16:35:37 INFO 125: Total students 0
2020-07-10 16:35:37 INFO 126: usage data length 0
2020-07-10 16:35:37 INFO 127: topics data length 0
2020-07-10 16:35:38 INFO 133: b2b2c students 0
2020-07-10 16:35:38 INFO 134: b2c students 0
2020-07-10 16:35:38 INFO 135: b2b students 0 (not processing now)
2020-07-10 16:35:38 INFO 244: {'i-03da617307f1d2b4f': 'ec2-13-235-58-43.ap-south-1.compute.amazonaws.com', 'i-00d0e199106330acd': 'ec2-13-234-11-184.ap-south-1.compute.amazonaws.com', 'i-0dcfc39e25b2b72dd': 'ec2-3-7-249-212.ap-south-1.compute.amazonaws.com', 'i-08addb345066d4518': 'ec2-13-233-135-241.ap-south-1.compute.amazonaws.com', 'i-021b67c54bd479e35': 'ec2-13-235-214-118.ap-south-1.compute.amazonaws.com', 'i-05fde7a73279aa0cd': 'ec2-13-235-60-67.ap-south-1.compute.amazonaws.com', 'i-0f07e9e072a5e62cb': 'ec2-3-7-57-160.ap-south-1.compute.amazonaws.com', 'i-09ba3766af0bf7e24': 'ec2-13-232-79-14.ap-south-1.compute.amazonaws.com'}
2020-07-10 16:36:09 ERROR 313: extraction failed due to 
Traceback (most recent call last):
  File "extraction2.py", line 311, in <module>
    logging.info('The whole thing took: '+str(round((t2-t1).total_seconds()/60 , 2))+ ' min')
NameError: name 't2' is not defined
2020-07-10 16:59:37 INFO 199: week start date 2020-05-29
2020-07-10 16:59:37 ERROR 314: extraction failed due to 
Traceback (most recent call last):
  File "extraction2.py", line 215, in <module>
    no_of_instances=int(sys.argv[1])
IndexError: list index out of range
2020-07-10 17:00:27 INFO 199: week start date 2020-05-29
2020-07-10 17:00:29 INFO 230: ['i-0563a4ea78a6c5a16', 'i-0c2b860a4e566fb6a', 'i-0819fd5f5fa28a506', 'i-0f628ba858db7a539', 'i-084032f740481b1c0', 'i-07c9fdb1cae5cf0e7', 'i-0b21ff16c501e8830', 'i-0a59feafe4ef437eb']
2020-07-10 17:02:29 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-05-29' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-04')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 17:02:38 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-05-29'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-04')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 17:03:02 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-05-29'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-04')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 17:03:58 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-05-29' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
2020-07-10 17:04:11 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-05-29'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-29' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-04') )
2020-07-10 17:04:20 INFO 125: Total students 349017
2020-07-10 17:04:20 INFO 126: usage data length 349017
2020-07-10 17:04:20 INFO 127: topics data length 0
2020-07-10 17:04:21 INFO 133: b2b2c students 0
2020-07-10 17:04:21 INFO 134: b2c students 0
2020-07-10 17:04:21 INFO 135: b2b students 0 (not processing now)
2020-07-10 17:04:22 INFO 244: {'i-0b21ff16c501e8830': 'ec2-13-235-54-125.ap-south-1.compute.amazonaws.com', 'i-084032f740481b1c0': 'ec2-3-7-58-201.ap-south-1.compute.amazonaws.com', 'i-0c2b860a4e566fb6a': 'ec2-52-66-216-52.ap-south-1.compute.amazonaws.com', 'i-0563a4ea78a6c5a16': 'ec2-13-235-255-102.ap-south-1.compute.amazonaws.com', 'i-0a59feafe4ef437eb': 'ec2-13-235-59-157.ap-south-1.compute.amazonaws.com', 'i-07c9fdb1cae5cf0e7': 'ec2-13-234-12-115.ap-south-1.compute.amazonaws.com', 'i-0f628ba858db7a539': 'ec2-52-66-233-29.ap-south-1.compute.amazonaws.com', 'i-0819fd5f5fa28a506': 'ec2-3-7-251-68.ap-south-1.compute.amazonaws.com'}
2020-07-10 17:05:11 INFO 312: The whole thing took: 4.73 min
2020-07-10 17:11:08 INFO 199: week start date 2020-06-26
2020-07-10 17:11:09 INFO 230: ['i-0e4e31c21132b6a0a', 'i-05c76af050117e806', 'i-09c954ae69f800d1c', 'i-0f3ec80c3c1ea7d9c', 'i-06dc50b2528666ce9', 'i-016a2fa2f76c3a878', 'i-0c4ad79df8b351b87', 'i-04e4c98ca972409a4']
2020-07-10 17:13:10 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-26' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 17:13:17 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 17:13:30 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 17:14:08 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 17:14:21 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-06-26'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 17:14:32 INFO 125: Total students 192040
2020-07-10 17:14:32 INFO 126: usage data length 192040
2020-07-10 17:14:32 INFO 127: topics data length 76439
2020-07-10 17:14:32 INFO 133: b2b2c students 0
2020-07-10 17:14:32 INFO 134: b2c students 0
2020-07-10 17:14:32 INFO 135: b2b students 0 (not processing now)
2020-07-10 17:14:32 INFO 244: {'i-05c76af050117e806': 'ec2-52-66-218-83.ap-south-1.compute.amazonaws.com', 'i-0f3ec80c3c1ea7d9c': 'ec2-3-7-251-89.ap-south-1.compute.amazonaws.com', 'i-09c954ae69f800d1c': 'ec2-13-235-61-57.ap-south-1.compute.amazonaws.com', 'i-016a2fa2f76c3a878': 'ec2-13-235-214-144.ap-south-1.compute.amazonaws.com', 'i-04e4c98ca972409a4': 'ec2-3-7-249-148.ap-south-1.compute.amazonaws.com', 'i-0c4ad79df8b351b87': 'ec2-3-6-43-77.ap-south-1.compute.amazonaws.com', 'i-06dc50b2528666ce9': 'ec2-52-66-228-26.ap-south-1.compute.amazonaws.com', 'i-0e4e31c21132b6a0a': 'ec2-13-235-57-8.ap-south-1.compute.amazonaws.com'}
2020-07-10 17:15:00 INFO 312: The whole thing took: 3.87 min
2020-07-10 18:21:38 INFO 202: week start date 2020-06-26
2020-07-10 18:21:40 INFO 233: ['i-00b3e6104be1df249', 'i-0bd0ed78b22456ec7', 'i-0572aa3f1e4580a75', 'i-0dbc7fceeafcff55e', 'i-0f51a71ee559f2ca6', 'i-06f16e2fcb17f75e5', 'i-0281ee4fd83cb3e81', 'i-039cf1affce5166e6']
2020-07-10 18:23:40 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-26' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 18:23:46 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 18:23:59 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 18:24:35 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 18:24:39 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-06-26'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 18:24:42 INFO 128: Total students 192040
2020-07-10 18:24:42 INFO 129: usage data length 192040
2020-07-10 18:24:42 INFO 130: topics data length 76439
2020-07-10 18:24:42 INFO 136: b2b2c students 1136
2020-07-10 18:24:42 INFO 137: b2c students 31118
2020-07-10 18:24:42 INFO 138: b2b students 159786 (not processing now)
2020-07-10 18:24:43 INFO 247: {'i-0572aa3f1e4580a75': 'ec2-15-206-1-216.ap-south-1.compute.amazonaws.com', 'i-0dbc7fceeafcff55e': 'ec2-3-7-37-242.ap-south-1.compute.amazonaws.com', 'i-00b3e6104be1df249': 'ec2-15-206-1-34.ap-south-1.compute.amazonaws.com', 'i-0bd0ed78b22456ec7': 'ec2-52-66-232-157.ap-south-1.compute.amazonaws.com', 'i-039cf1affce5166e6': 'ec2-52-66-231-115.ap-south-1.compute.amazonaws.com', 'i-06f16e2fcb17f75e5': 'ec2-3-7-255-155.ap-south-1.compute.amazonaws.com', 'i-0281ee4fd83cb3e81': 'ec2-13-235-57-183.ap-south-1.compute.amazonaws.com', 'i-0f51a71ee559f2ca6': 'ec2-13-235-58-113.ap-south-1.compute.amazonaws.com'}
2020-07-10 18:25:29 INFO 315: The whole thing took: 3.84 min
2020-07-10 19:37:31 INFO 152: month  June
2020-07-10 19:37:32 INFO 182: ['i-0ac8af945d5243f35', 'i-05a9afe08fa3a7d4c', 'i-002c7ddc55e26bd3d', 'i-05b06202fd951a6a0', 'i-00ecf35513aff6ee9', 'i-035787a1178654039', 'i-0cadc192f0d4b3f0a', 'i-02408b157a2b5655a']
2020-07-10 19:39:33 ERROR 237: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.DataError: invalid input syntax for integer: "June"


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction.py", line 185, in <module>
    time.sleep(120)
  File "mon_extraction.py", line 77, in split_and_save
    usage = get_usage_data(month,mon_first_day_str,mon_last_day_str)
  File "mon_extraction.py", line 52, in get_usage_data
    df = pd.read_sql(query, redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='June' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    ': invalid input syntax for integer: "June"

2020-07-10 19:41:35 INFO 152: month  June
2020-07-10 19:41:36 INFO 184: ['i-00a5116ad141c6d8f', 'i-0e3b45326efb38dd9', 'i-0afb833634e1c19ae', 'i-0056c55d319150b7e', 'i-08e3ae694814c11ce', 'i-0dbdf058c41407304', 'i-0f1b46299924f37ad', 'i-02bb755a6a55696c0']
2020-07-10 19:43:37 ERROR 239: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.DataError: invalid input syntax for integer: "June"


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction.py", line 187, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction.py", line 77, in split_and_save
    usage = get_usage_data(month,mon_first_day_str,mon_last_day_str)
  File "mon_extraction.py", line 52, in get_usage_data
    df = pd.read_sql(query, redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='June' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    ': invalid input syntax for integer: "June"

2020-07-10 19:47:24 INFO 152: month  June
2020-07-10 19:47:25 INFO 184: ['i-0f155e00da415ca71', 'i-01a54fc23656d5244', 'i-0e39f840583f70759', 'i-04c5c7ff9893811cf', 'i-0d6c1398d3795cbca', 'i-02abed722855af0da', 'i-08f690e9b408e4b63', 'i-088fafda4f30df6e2']
2020-07-10 19:49:26 ERROR 239: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.DataError: invalid input syntax for integer: "June"


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction.py", line 187, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction.py", line 77, in split_and_save
    usage = get_usage_data(month,mon_first_day_str,mon_last_day_str)
  File "mon_extraction.py", line 52, in get_usage_data
    df = pd.read_sql(query, redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='June' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    ': invalid input syntax for integer: "June"

2020-07-10 19:53:53 INFO 152: month  June
2020-07-10 19:53:54 INFO 184: ['i-0633124910ab6ed18', 'i-0c7547f31680dcf15', 'i-0ffd470dc091e5430', 'i-0d66921562bd2eab6', 'i-024130b83403a35eb', 'i-090fa946038640d10', 'i-07d36a542f5a2f315', 'i-0f0e42cfab8b30b10']
2020-07-10 19:55:55 ERROR 239: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.DataError: invalid input syntax for integer: "June"


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction.py", line 187, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction.py", line 77, in split_and_save
    usage = get_usage_data(month,mon_first_day_str,mon_last_day_str)
  File "mon_extraction.py", line 52, in get_usage_data
    df = pd.read_sql(query, redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='June' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    ': invalid input syntax for integer: "June"

2020-07-10 19:57:16 INFO 152: month  June
2020-07-10 19:57:17 INFO 184: ['i-0d0699107abee606d', 'i-0ce3b5c0797db9d0d', 'i-0f240ee8d63d33a8f', 'i-0aa1d857dd404eca3', 'i-0e57830ac741883c5', 'i-08d54735f545250b4', 'i-0052b0da3265a3481', 'i-09845449bddb8fcb7']
2020-07-10 19:59:28 ERROR 239: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.ProgrammingError: column "mapped_ttid" does not exist in msm_moduleprogress_monthly


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction.py", line 187, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction.py", line 78, in split_and_save
    topic_prog = get_topic_data(mon,mon_first_day_str,mon_last_day_str)
  File "mon_extraction.py", line 61, in get_topic_data
    df = pd.read_sql_query(query, redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 332, in read_sql_query
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select oldupid as upid,class,contenttype,contentid,mapped_ttid,content_attempt_no,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    ': column "mapped_ttid" does not exist in msm_moduleprogress_monthly

2020-07-10 20:02:22 INFO 152: month  June
2020-07-10 20:02:23 INFO 184: ['i-0b93fd6133572f250', 'i-00d9391f238e7c0e6', 'i-0d877c5db0062a096', 'i-0372706481bd14465', 'i-0f64305f817a5d42e', 'i-0a5fef6845bc71660', 'i-08480bc4462dc8f99', 'i-044ba8144eb801c25']
2020-07-10 20:04:34 ERROR 239: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/ops/__init__.py", line 968, in na_op
    result = expressions.evaluate(op, str_rep, x, y, **eval_kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/computation/expressions.py", line 221, in evaluate
    return _evaluate(op, op_str, a, b, **eval_kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/computation/expressions.py", line 127, in _evaluate_numexpr
    result = _evaluate_standard(op, op_str, a, b)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/computation/expressions.py", line 70, in _evaluate_standard
    return op(a, b)
TypeError: ufunc 'add' did not contain a loop with signature matching types dtype('<U21') dtype('<U21') dtype('<U21')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction.py", line 187, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction.py", line 79, in split_and_save
    usage['upid_class'] = usage['upid'] + '_' + usage['class']
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/ops/__init__.py", line 1048, in wrapper
    result = na_op(lvalues, rvalues)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/ops/__init__.py", line 970, in na_op
    result = masked_arith_op(x, y, op)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/ops/__init__.py", line 464, in masked_arith_op
    result[mask] = op(xrav[mask], y)
TypeError: ufunc 'add' did not contain a loop with signature matching types dtype('<U21') dtype('<U21') dtype('<U21')
2020-07-10 20:09:14 INFO 152: month  June
2020-07-10 20:09:15 INFO 184: ['i-0b7fd9b7c88662dfa', 'i-0aa02099002b43f12', 'i-0e662d16b1ff10c83', 'i-0c5fcf7bdf89d0741', 'i-08f17c6f0708349a5', 'i-04aac70b80979665f', 'i-08107748d924524c5', 'i-0e66e185fc2b2deb7']
2020-07-10 20:12:12 INFO 102: Total students 345098
2020-07-10 20:12:12 INFO 103: Distinct student and class count 345808
2020-07-10 20:12:12 INFO 104: usage data length 345808
2020-07-10 20:12:12 INFO 105: topics data length 0
2020-07-10 20:12:12 INFO 109: no of splits 8
2020-07-10 20:12:28 INFO 198: {'i-08107748d924524c5': 'ec2-3-6-150-20.ap-south-1.compute.amazonaws.com', 'i-0e662d16b1ff10c83': 'ec2-3-7-251-250.ap-south-1.compute.amazonaws.com', 'i-08f17c6f0708349a5': 'ec2-13-235-57-196.ap-south-1.compute.amazonaws.com', 'i-0e66e185fc2b2deb7': 'ec2-15-206-188-38.ap-south-1.compute.amazonaws.com', 'i-04aac70b80979665f': 'ec2-15-206-190-83.ap-south-1.compute.amazonaws.com', 'i-0aa02099002b43f12': 'ec2-3-7-251-13.ap-south-1.compute.amazonaws.com', 'i-0c5fcf7bdf89d0741': 'ec2-52-66-224-115.ap-south-1.compute.amazonaws.com', 'i-0b7fd9b7c88662dfa': 'ec2-13-234-10-88.ap-south-1.compute.amazonaws.com'}
2020-07-10 20:12:31 INFO 237: The whole thing took: 3.28 min
2020-07-10 21:29:51 INFO 205: week start date 2020-06-26
2020-07-10 21:29:52 INFO 236: ['i-0e13c1b1ccf250aed', 'i-0937dd74b906d068b', 'i-094748a0faae7d7f0', 'i-069b55e8d4f8df613', 'i-0f9f4cc0896f9c69b', 'i-0f97a9df0531e1e34', 'i-01d139dd8215d5202', 'i-052916bed6e5f1436']
2020-07-10 21:31:52 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-26' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 21:32:00 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 21:32:13 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 21:32:53 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 21:32:56 INFO 100: select oldupid as upid,a.contentid, b.contentname, weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,
    round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly a, msm_topic_flow b where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26'
    and (a.contentid = b.contentid or a.contentid = b.oldcontentid)
    and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 21:45:36 INFO 205: week start date 2020-06-26
2020-07-10 21:45:37 INFO 238: ['i-06e113a107f35a303', 'i-004ad585aab7dfaf9', 'i-064a092ea5b3cbdf9', 'i-05e828477627c7f18', 'i-072f0885e43419e62', 'i-0aad74dbe525ffcdf', 'i-06ccf2364be21f49d', 'i-0632567775bb86105']
2020-07-10 21:47:50 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 21:47:56 INFO 100: select oldupid as upid,a.contentid, b.contentname, weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,
    round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly a, msm_topic_flow b where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26'
    and (a.contentid = b.contentid or a.contentid = b.oldcontentid)
    and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 22:01:15 ERROR 320: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.InternalError: Disk Full
DETAIL:  
  -----------------------------------------------
  error:  Disk Full
  code:      1016
  context:   node: 0
  query:     886434
  location:  fdisk_api.cpp:623
  process:   query0_126_886434 [pid=26754]
  -----------------------------------------------



During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction2.py", line 239, in <module>
    time.sleep(120)
  File "extraction2.py", line 124, in split_and_save
    topic_prog = get_topic_data(last_fri_str,thur_str)
  File "extraction2.py", line 102, in get_topic_data
    df = pd.read_sql_query(query.format(), redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 332, in read_sql_query
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select oldupid as upid,a.contentid, b.contentname, weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,
    round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly a, msm_topic_flow b where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26'
    and (a.contentid = b.contentid or a.contentid = b.oldcontentid)
    and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )': Disk Full
DETAIL:  
  -----------------------------------------------
  error:  Disk Full
  code:      1016
  context:   node: 0
  query:     886434
  location:  fdisk_api.cpp:623
  process:   query0_126_886434 [pid=26754]
  -----------------------------------------------


2020-07-10 22:09:25 INFO 152: month  June
2020-07-10 22:09:26 INFO 184: ['i-0368e739539d6ca97', 'i-0ef4fb90f87cea944', 'i-0c3909e3fb5b80e2e', 'i-0b1210c6fd116d73d', 'i-03d1fa3090a38a658', 'i-047a03262549103ef', 'i-04af8545c7efd98d8', 'i-073616ae15f6bb6dd']
2020-07-10 22:19:51 INFO 102: Total students 345098
2020-07-10 22:19:51 INFO 103: Distinct student and class count 345808
2020-07-10 22:19:51 INFO 104: usage data length 345808
2020-07-10 22:19:51 INFO 105: topics data length 0
2020-07-10 22:19:51 INFO 109: no of splits 8
2020-07-10 22:20:09 INFO 198: {'i-0368e739539d6ca97': 'ec2-13-234-14-216.ap-south-1.compute.amazonaws.com', 'i-0ef4fb90f87cea944': 'ec2-3-7-249-22.ap-south-1.compute.amazonaws.com', 'i-0b1210c6fd116d73d': 'ec2-15-206-206-6.ap-south-1.compute.amazonaws.com', 'i-047a03262549103ef': 'ec2-13-235-58-98.ap-south-1.compute.amazonaws.com', 'i-04af8545c7efd98d8': 'ec2-15-206-183-203.ap-south-1.compute.amazonaws.com', 'i-073616ae15f6bb6dd': 'ec2-3-7-37-85.ap-south-1.compute.amazonaws.com', 'i-0c3909e3fb5b80e2e': 'ec2-52-66-228-229.ap-south-1.compute.amazonaws.com', 'i-03d1fa3090a38a658': 'ec2-52-66-83-60.ap-south-1.compute.amazonaws.com'}
2020-07-10 22:20:12 INFO 237: The whole thing took: 10.79 min
2020-07-10 22:53:44 INFO 155: month  June
2020-07-10 22:53:45 INFO 187: ['i-0a8d9d890e1535494', 'i-00879fb451906eff6', 'i-068e3f43fabc107d3', 'i-0ebe09b3a7d2c3fae', 'i-0dacd903242d190d9', 'i-05a1e62476d3a084c', 'i-03a4c39e4fdc86af2', 'i-0444c84c2637a1dfa']
2020-07-10 22:55:46 INFO 53: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 22:55:51 INFO 63: select oldupid as upid,class,contentid,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 22:56:09 INFO 42: select contentid,contentname from msm_topic_flow    
2020-07-10 22:56:11 INFO 73: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 22:56:41 INFO 105: Total students 345098
2020-07-10 22:56:41 INFO 106: Distinct student and class count 345808
2020-07-10 22:56:41 INFO 107: usage data length 345808
2020-07-10 22:56:41 INFO 108: topics data length 339339
2020-07-10 22:56:41 INFO 112: no of splits 8
2020-07-10 22:57:01 INFO 201: {'i-0dacd903242d190d9': 'ec2-3-6-210-200.ap-south-1.compute.amazonaws.com', 'i-00879fb451906eff6': 'ec2-13-234-7-246.ap-south-1.compute.amazonaws.com', 'i-0a8d9d890e1535494': 'ec2-15-206-202-238.ap-south-1.compute.amazonaws.com', 'i-0ebe09b3a7d2c3fae': 'ec2-13-235-210-32.ap-south-1.compute.amazonaws.com', 'i-068e3f43fabc107d3': 'ec2-3-6-210-134.ap-south-1.compute.amazonaws.com', 'i-0444c84c2637a1dfa': 'ec2-52-66-231-98.ap-south-1.compute.amazonaws.com', 'i-03a4c39e4fdc86af2': 'ec2-15-206-204-191.ap-south-1.compute.amazonaws.com', 'i-05a1e62476d3a084c': 'ec2-15-206-184-77.ap-south-1.compute.amazonaws.com'}
2020-07-10 22:57:12 INFO 240: The whole thing took: 3.47 min
2020-07-10 23:00:01 INFO 155: month  June
2020-07-10 23:00:03 INFO 187: ['i-02b7d5fbf0856efa0', 'i-0c4fefc1421e8b3d7', 'i-0bd0f03ef249d1c41', 'i-041cce25b82d95f88', 'i-0c3cb230b4c24b8d6', 'i-016c1ee1422ca555c', 'i-0e8abb264143a4179', 'i-0c82abe74288007a3']
2020-07-10 23:02:03 INFO 53: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:02:07 INFO 63: select oldupid as upid,class,contentid,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:02:11 INFO 42: select contentid,contentname from msm_topic_flow    
2020-07-10 23:02:12 INFO 73: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:02:36 INFO 105: Total students 345098
2020-07-10 23:02:36 INFO 106: Distinct student and class count 345808
2020-07-10 23:02:36 INFO 107: usage data length 345808
2020-07-10 23:02:36 INFO 108: topics data length 339339
2020-07-10 23:02:36 INFO 112: no of splits 8
2020-07-10 23:02:57 INFO 201: {'i-0c82abe74288007a3': 'ec2-15-206-186-223.ap-south-1.compute.amazonaws.com', 'i-0e8abb264143a4179': 'ec2-13-235-70-237.ap-south-1.compute.amazonaws.com', 'i-016c1ee1422ca555c': 'ec2-13-235-91-12.ap-south-1.compute.amazonaws.com', 'i-0c3cb230b4c24b8d6': 'ec2-13-127-180-237.ap-south-1.compute.amazonaws.com', 'i-0bd0f03ef249d1c41': 'ec2-3-7-45-11.ap-south-1.compute.amazonaws.com', 'i-0c4fefc1421e8b3d7': 'ec2-15-206-178-85.ap-south-1.compute.amazonaws.com', 'i-02b7d5fbf0856efa0': 'ec2-15-207-20-29.ap-south-1.compute.amazonaws.com', 'i-041cce25b82d95f88': 'ec2-13-235-90-62.ap-south-1.compute.amazonaws.com'}
2020-07-10 23:03:05 INFO 241: The whole thing took: 3.07 min
2020-07-10 23:09:38 INFO 155: month  June
2020-07-10 23:09:39 INFO 187: ['i-02426d5c867adff81', 'i-034849f61ac0a9050', 'i-04706a17cf2a5e53f', 'i-006919920af4fd55d', 'i-09d46e394ea6113a1', 'i-03ec33a3874cf7c20', 'i-07b5c063023844007', 'i-082fb4d429ad7b1cc']
2020-07-10 23:11:40 INFO 53: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:11:44 INFO 63: select oldupid as upid,class,contentid,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:11:49 INFO 42: select contentid,contentname from msm_topic_flow    
2020-07-10 23:11:50 INFO 73: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:12:15 INFO 105: Total students 345098
2020-07-10 23:12:15 INFO 106: Distinct student and class count 345808
2020-07-10 23:12:15 INFO 107: usage data length 345808
2020-07-10 23:12:15 INFO 108: topics data length 339339
2020-07-10 23:12:15 INFO 112: no of splits 8
2020-07-10 23:12:35 INFO 201: {'i-04706a17cf2a5e53f': 'ec2-13-235-215-62.ap-south-1.compute.amazonaws.com', 'i-034849f61ac0a9050': 'ec2-13-235-58-214.ap-south-1.compute.amazonaws.com', 'i-03ec33a3874cf7c20': 'ec2-52-66-220-148.ap-south-1.compute.amazonaws.com', 'i-082fb4d429ad7b1cc': 'ec2-52-66-223-61.ap-south-1.compute.amazonaws.com', 'i-07b5c063023844007': 'ec2-3-7-250-90.ap-south-1.compute.amazonaws.com', 'i-02426d5c867adff81': 'ec2-52-66-214-241.ap-south-1.compute.amazonaws.com', 'i-09d46e394ea6113a1': 'ec2-13-235-84-19.ap-south-1.compute.amazonaws.com', 'i-006919920af4fd55d': ''}
2020-07-10 23:15:03 INFO 155: month  June
2020-07-10 23:15:04 INFO 187: ['i-06b7f4d0f7512f907', 'i-07affad0ea5c28171', 'i-0bafccd78bfea239b', 'i-053fa4679ff18de19', 'i-0b77f6c888ed1e2e4', 'i-06271f156cfa96d2f', 'i-04c4f82512849c717', 'i-0a44c39fd430726ad']
2020-07-10 23:17:04 INFO 53: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:17:08 INFO 63: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:17:20 INFO 42: select contentid,contentname from msm_topic_flow    
2020-07-10 23:17:21 INFO 73: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-10 23:17:45 INFO 105: Total students 345098
2020-07-10 23:17:45 INFO 106: Distinct student and class count 345808
2020-07-10 23:17:45 INFO 107: usage data length 345808
2020-07-10 23:17:45 INFO 108: topics data length 339339
2020-07-10 23:17:45 INFO 112: no of splits 8
2020-07-10 23:18:06 INFO 201: {'i-07affad0ea5c28171': 'ec2-13-127-187-69.ap-south-1.compute.amazonaws.com', 'i-0bafccd78bfea239b': 'ec2-35-154-113-131.ap-south-1.compute.amazonaws.com', 'i-053fa4679ff18de19': 'ec2-52-66-245-189.ap-south-1.compute.amazonaws.com', 'i-0b77f6c888ed1e2e4': 'ec2-13-233-121-116.ap-south-1.compute.amazonaws.com', 'i-06271f156cfa96d2f': 'ec2-13-233-118-95.ap-south-1.compute.amazonaws.com', 'i-04c4f82512849c717': 'ec2-13-127-146-236.ap-south-1.compute.amazonaws.com', 'i-0a44c39fd430726ad': 'ec2-13-127-204-99.ap-south-1.compute.amazonaws.com', 'i-06b7f4d0f7512f907': 'ec2-13-232-229-151.ap-south-1.compute.amazonaws.com'}
2020-07-10 23:20:41 INFO 205: week start date 2020-06-26
2020-07-10 23:20:42 INFO 238: ['i-001f7905d005049fc', 'i-08198726066614225', 'i-0f9a892111335ed95', 'i-050dcd06ff2a6c05e', 'i-08ca870f703985279', 'i-0969d4daff9e885be', 'i-0f3bed99b3426da0b', 'i-05b367296a287a59c']
2020-07-10 23:22:42 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-26' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 23:22:50 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 23:23:03 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 23:23:40 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 23:23:43 INFO 100: select oldupid as upid,a.contentid, b.contentname, weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,
    round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly a, msm_topic_flow b where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26'
    and (a.contentid = b.contentid or a.contentid = b.oldcontentid)
    and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 23:50:05 INFO 222: week start date 2020-06-26
2020-07-10 23:50:06 INFO 255: ['i-09e58dacd16b030fd', 'i-0f29d1f7e26990de7', 'i-0173b398127908261', 'i-0e8c36eb260b3fc20', 'i-0d6974f1ff1652f13', 'i-02956c60efdeaf632', 'i-01c2d1ce1dc9d7d76', 'i-0bc5c5b28c25b5426']
2020-07-10 23:52:06 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-26' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-10 23:52:13 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 23:52:25 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-10 23:53:01 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 23:53:05 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-06-26'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-10 23:53:06 ERROR 339: extraction failed due to 
Traceback (most recent call last):
  File "extraction3.py", line 258, in <module>
    split_and_save(no_of_instances)
  File "extraction3.py", line 136, in split_and_save
    livecon()
NameError: name 'livecon' is not defined
2020-07-11 00:00:33 INFO 131: Total students 192040
2020-07-11 00:00:33 INFO 132: usage data length 192040
2020-07-11 00:00:33 INFO 133: topics data length 75825
2020-07-11 00:00:34 INFO 139: b2b2c students 1140
2020-07-11 00:00:34 INFO 140: b2c students 31116
2020-07-11 00:00:34 INFO 141: b2b students 159784 (not processing now)
2020-07-11 00:00:35 INFO 252: {'i-050dcd06ff2a6c05e': '', 'i-0969d4daff9e885be': '', 'i-001f7905d005049fc': '', 'i-05b367296a287a59c': '', 'i-0f3bed99b3426da0b': 'ec2-13-235-215-57.ap-south-1.compute.amazonaws.com', 'i-0f9a892111335ed95': 'ec2-13-235-89-228.ap-south-1.compute.amazonaws.com', 'i-08ca870f703985279': '', 'i-08198726066614225': ''}
2020-07-11 00:01:05 INFO 320: The whole thing took: 40.4 min
2020-07-11 08:54:50 INFO 222: week start date 2020-06-26
2020-07-11 08:54:50 ERROR 339: extraction failed due to 
Traceback (most recent call last):
  File "extraction3.py", line 240, in <module>
    no_of_instances=int(sys.argv[1])
IndexError: list index out of range
2020-07-11 08:55:10 INFO 222: week start date 2020-06-26
2020-07-11 08:55:11 INFO 255: ['i-0e13f01c2a72b5396', 'i-01b110c800d6fa4d6', 'i-014a434c7f427db64', 'i-06c93196643f0a05e', 'i-00d4ad5d7d3f30471', 'i-0898ded41e8f8267a', 'i-073c93781c804a23f', 'i-024ab585e57e6f5a9']
2020-07-11 08:57:11 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-26' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-11 08:57:19 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-11 08:57:31 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-26'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-02')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-11 08:58:10 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-06-26' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-11 08:58:14 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-06-26'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-26' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-02') )
2020-07-11 08:58:19 INFO 148: Total students 192196
2020-07-11 08:58:19 INFO 149: usage data length 192196
2020-07-11 08:58:19 INFO 150: topics data length 76597
2020-07-11 08:58:19 INFO 156: b2b2c students 1143
2020-07-11 08:58:19 INFO 157: b2c students 31116
2020-07-11 08:58:19 INFO 158: b2b students 159937 (not processing now)
2020-07-11 08:58:20 INFO 269: {'i-073c93781c804a23f': 'ec2-13-235-255-229.ap-south-1.compute.amazonaws.com', 'i-024ab585e57e6f5a9': 'ec2-52-66-229-131.ap-south-1.compute.amazonaws.com', 'i-014a434c7f427db64': 'ec2-13-233-135-182.ap-south-1.compute.amazonaws.com', 'i-06c93196643f0a05e': 'ec2-52-66-233-105.ap-south-1.compute.amazonaws.com', 'i-0e13f01c2a72b5396': 'ec2-3-6-43-234.ap-south-1.compute.amazonaws.com', 'i-01b110c800d6fa4d6': 'ec2-3-7-54-59.ap-south-1.compute.amazonaws.com', 'i-0898ded41e8f8267a': 'ec2-52-66-229-213.ap-south-1.compute.amazonaws.com', 'i-00d4ad5d7d3f30471': 'ec2-13-233-59-185.ap-south-1.compute.amazonaws.com'}
2020-07-11 09:03:44 INFO 222: week start date 2020-07-03
2020-07-11 09:03:45 INFO 255: ['i-03c3d17bbccc06b3b', 'i-0ef218c196997c18c', 'i-09d7decb6ea902b1d', 'i-0d786238913e1f16d', 'i-04fb0527bbfd65550', 'i-09d2eb2cd37ec1c74', 'i-0963644373983cbf8', 'i-0a615c31a3e2cf554']
2020-07-11 09:05:45 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-03' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-11 09:05:46 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-11 09:05:48 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-11 09:05:55 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-03' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-03' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-09') )
2020-07-11 09:05:57 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-03'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-03' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-09') )
2020-07-11 09:06:02 INFO 148: Total students 110174
2020-07-11 09:06:02 INFO 149: usage data length 110174
2020-07-11 09:06:02 INFO 150: topics data length 62847
2020-07-11 09:06:02 INFO 156: b2b2c students 1266
2020-07-11 09:06:02 INFO 157: b2c students 23385
2020-07-11 09:06:02 INFO 158: b2b students 85523 (not processing now)
2020-07-11 09:06:02 INFO 269: {'i-03c3d17bbccc06b3b': 'ec2-13-235-53-131.ap-south-1.compute.amazonaws.com', 'i-0963644373983cbf8': 'ec2-3-7-59-59.ap-south-1.compute.amazonaws.com', 'i-0a615c31a3e2cf554': 'ec2-13-235-89-218.ap-south-1.compute.amazonaws.com', 'i-04fb0527bbfd65550': 'ec2-15-206-206-217.ap-south-1.compute.amazonaws.com', 'i-09d2eb2cd37ec1c74': 'ec2-3-7-59-2.ap-south-1.compute.amazonaws.com', 'i-0d786238913e1f16d': 'ec2-52-66-230-170.ap-south-1.compute.amazonaws.com', 'i-0ef218c196997c18c': 'ec2-52-66-221-43.ap-south-1.compute.amazonaws.com', 'i-09d7decb6ea902b1d': 'ec2-13-235-216-155.ap-south-1.compute.amazonaws.com'}
2020-07-11 09:07:23 INFO 337: The whole thing took: 3.66 min
2020-07-11 10:11:02 INFO 155: month  June
2020-07-11 10:11:03 INFO 187: ['i-0fd188fe905278eb2', 'i-00ca05bdb2c079b31', 'i-03288b35b7af1196e', 'i-0ae9ecfb2e7456fec', 'i-07c4821e192aa87f6', 'i-06d13576a9f9aaaab', 'i-0e89f15d9a36860ae', 'i-002cd651abdba871a']
2020-07-11 10:13:04 INFO 53: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 10:13:08 INFO 63: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 10:13:12 INFO 42: select contentid,contentname from msm_topic_flow    
2020-07-11 10:13:16 INFO 73: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 10:13:40 INFO 105: Total students 345254
2020-07-11 10:13:40 INFO 106: Distinct student and class count 345965
2020-07-11 10:13:40 INFO 107: usage data length 345965
2020-07-11 10:13:40 INFO 108: topics data length 339366
2020-07-11 10:13:40 INFO 112: no of splits 8
2020-07-11 10:13:59 INFO 201: {'i-03288b35b7af1196e': 'ec2-3-7-54-163.ap-south-1.compute.amazonaws.com', 'i-07c4821e192aa87f6': 'ec2-15-206-184-255.ap-south-1.compute.amazonaws.com', 'i-00ca05bdb2c079b31': 'ec2-13-234-7-200.ap-south-1.compute.amazonaws.com', 'i-0ae9ecfb2e7456fec': 'ec2-3-6-116-204.ap-south-1.compute.amazonaws.com', 'i-06d13576a9f9aaaab': 'ec2-15-206-206-67.ap-south-1.compute.amazonaws.com', 'i-0e89f15d9a36860ae': 'ec2-13-235-60-75.ap-south-1.compute.amazonaws.com', 'i-002cd651abdba871a': 'ec2-3-7-251-183.ap-south-1.compute.amazonaws.com', 'i-0fd188fe905278eb2': 'ec2-15-206-1-215.ap-south-1.compute.amazonaws.com'}
2020-07-11 10:34:13 INFO 155: month  June
2020-07-11 10:34:14 INFO 187: ['i-00ccd423cb887ebdf', 'i-0412b1f1543fa2de5', 'i-0652be9fbf1aca7c3', 'i-020e11bf3d39ce02b', 'i-0b0f475fd91dba215', 'i-05367ca031ad27e3a', 'i-01493bb13658f53fc', 'i-073a131cd8ef64f4e']
2020-07-11 10:36:15 INFO 53: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 10:36:19 INFO 63: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 10:36:23 INFO 42: select contentid,contentname from msm_topic_flow    
2020-07-11 10:36:24 INFO 73: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 10:36:48 INFO 105: Total students 345254
2020-07-11 10:36:48 INFO 106: Distinct student and class count 345965
2020-07-11 10:36:48 INFO 107: usage data length 345965
2020-07-11 10:36:48 INFO 108: topics data length 339366
2020-07-11 10:36:48 INFO 112: no of splits 8
2020-07-11 10:37:08 INFO 201: {'i-0b0f475fd91dba215': 'ec2-52-66-230-53.ap-south-1.compute.amazonaws.com', 'i-0412b1f1543fa2de5': 'ec2-13-235-65-160.ap-south-1.compute.amazonaws.com', 'i-00ccd423cb887ebdf': 'ec2-52-66-217-99.ap-south-1.compute.amazonaws.com', 'i-05367ca031ad27e3a': 'ec2-13-235-53-106.ap-south-1.compute.amazonaws.com', 'i-073a131cd8ef64f4e': 'ec2-52-66-225-235.ap-south-1.compute.amazonaws.com', 'i-01493bb13658f53fc': 'ec2-52-66-224-214.ap-south-1.compute.amazonaws.com', 'i-020e11bf3d39ce02b': 'ec2-15-206-1-71.ap-south-1.compute.amazonaws.com', 'i-0652be9fbf1aca7c3': 'ec2-13-233-135-35.ap-south-1.compute.amazonaws.com'}
2020-07-11 11:03:47 INFO 155: month  June
2020-07-11 11:03:48 INFO 187: ['i-04156f2d7d9bbbd62', 'i-08dda95712724d941', 'i-03fea3cda98e18755', 'i-07aeef1ffa16749f8', 'i-0c2b99a531f6a246d', 'i-05ba49779b65a9a3c', 'i-0c82ca40f15b7fa25', 'i-018d11b9b01e2f030']
2020-07-11 11:05:49 INFO 53: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 11:05:53 INFO 63: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 11:05:56 INFO 42: select contentid,contentname from msm_topic_flow    
2020-07-11 11:05:58 INFO 73: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-11 11:06:22 INFO 105: Total students 345254
2020-07-11 11:06:22 INFO 106: Distinct student and class count 345965
2020-07-11 11:06:22 INFO 107: usage data length 345965
2020-07-11 11:06:22 INFO 108: topics data length 339366
2020-07-11 11:06:22 INFO 112: no of splits 8
2020-07-11 11:06:42 INFO 201: {'i-04156f2d7d9bbbd62': 'ec2-15-206-213-165.ap-south-1.compute.amazonaws.com', 'i-08dda95712724d941': 'ec2-52-66-228-196.ap-south-1.compute.amazonaws.com', 'i-0c2b99a531f6a246d': 'ec2-13-235-56-91.ap-south-1.compute.amazonaws.com', 'i-05ba49779b65a9a3c': 'ec2-3-7-58-212.ap-south-1.compute.amazonaws.com', 'i-0c82ca40f15b7fa25': 'ec2-13-235-62-146.ap-south-1.compute.amazonaws.com', 'i-018d11b9b01e2f030': 'ec2-13-234-7-245.ap-south-1.compute.amazonaws.com', 'i-03fea3cda98e18755': 'ec2-52-66-218-66.ap-south-1.compute.amazonaws.com', 'i-07aeef1ffa16749f8': 'ec2-3-7-249-6.ap-south-1.compute.amazonaws.com'}
2020-07-11 12:31:40 INFO 241: The whole thing took: 140.63 min
2020-07-11 12:34:15 INFO 241: The whole thing took: 120.03 min
2020-07-11 12:34:15 INFO 241: The whole thing took: 90.47 min
2020-07-11 18:24:13 INFO 215: week start date 2020-07-03
2020-07-11 18:24:14 INFO 248: ['i-04b083f2388bc48d8', 'i-02b124c55929aa24d', 'i-04f3ccd31b5166c4a', 'i-0fd8166c7d02765d2', 'i-0fb6631fdf378102d', 'i-00927e209ec514f9b', 'i-0ac4914ce26c6cffc', 'i-0a2e5ad32dade114b']
2020-07-11 18:26:14 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-03' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-11 18:26:21 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-11 18:26:33 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-03'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-09')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-11 18:27:09 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-03' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-03' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-09') )
2020-07-11 18:27:11 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-03'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-03' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-09') )
2020-07-11 18:27:16 INFO 141: Total students 110174
2020-07-11 18:27:16 INFO 142: usage data length 110174
2020-07-11 18:27:16 INFO 143: topics data length 60687
2020-07-11 18:27:16 INFO 149: b2b2c students 1266
2020-07-11 18:27:16 INFO 150: b2c students 23379
2020-07-11 18:27:16 INFO 151: b2b students 85529 (not processing now)
2020-07-11 18:27:17 INFO 262: {'i-0a2e5ad32dade114b': 'ec2-13-234-12-12.ap-south-1.compute.amazonaws.com', 'i-00927e209ec514f9b': 'ec2-13-127-175-151.ap-south-1.compute.amazonaws.com', 'i-0fd8166c7d02765d2': 'ec2-52-66-227-129.ap-south-1.compute.amazonaws.com', 'i-0ac4914ce26c6cffc': 'ec2-3-7-255-20.ap-south-1.compute.amazonaws.com', 'i-0fb6631fdf378102d': 'ec2-13-234-7-232.ap-south-1.compute.amazonaws.com', 'i-04f3ccd31b5166c4a': 'ec2-52-66-216-163.ap-south-1.compute.amazonaws.com', 'i-02b124c55929aa24d': 'ec2-3-7-62-98.ap-south-1.compute.amazonaws.com', 'i-04b083f2388bc48d8': 'ec2-13-235-64-86.ap-south-1.compute.amazonaws.com'}
2020-07-11 18:28:37 INFO 330: The whole thing took: 4.41 min
2020-07-12 10:30:31 INFO 289: month  June
2020-07-12 10:30:33 INFO 321: ['i-04636352792965381', 'i-010399feaf376e06d', 'i-0c1eefb5b5e8bd9a4', 'i-03596c8494fbbd881', 'i-0700cc6170e3313b8', 'i-04f17ded105e2f6d3', 'i-0c6e09aceda89a95f', 'i-00e6ff169fd8141a5']
2020-07-12 10:43:01 INFO 289: month  June
2020-07-12 10:43:03 INFO 321: ['i-0d81ac0b86e304860', 'i-0b7ee9d9be9cb139d', 'i-0489a98b15faa2b80', 'i-0f5926db6299f67ce', 'i-01805e324ad935a2e', 'i-0263a37f4773ec2af', 'i-091b63f895689438f', 'i-0b3876c859c1315d3']
2020-07-12 10:45:03 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 10:45:09 INFO 72: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 10:45:10 ERROR 409: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.InternalError: (1054, "Unknown column 'A.MS_userID' in 'field list'")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction2.py", line 324, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction2.py", line 135, in split_and_save
    b2c_users = get_b2c(mon_first_day_str,mon_last_day_str)
  File "mon_extraction2.py", line 74, in get_b2c
    df = pd.read_sql(query, mysql)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
pandas.io.sql.DatabaseError: Execution failed on sql 'SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)': (1054, "Unknown column 'A.MS_userID' in 'field list'")
2020-07-12 11:12:12 INFO 289: month  June
2020-07-12 11:12:13 INFO 321: ['i-03e367de85faaab00', 'i-00ba6efeb9ac0129a', 'i-0a38171dbd6b0a6b2', 'i-0bdfbbf6b141a8943', 'i-0248aa31bf36bba9f', 'i-02134093113968dba', 'i-0573de78e8c5f7d5b', 'i-085304ff16c54e2c6']
2020-07-12 11:14:13 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 11:14:20 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:14:35 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:15:34 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:15:43 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:15:56 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:16:24 ERROR 409: extraction failed due to 
Traceback (most recent call last):
  File "mon_extraction2.py", line 324, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction2.py", line 177, in split_and_save
    c_df = c_df.merge(c_df[['contentid','contentname']],on='contentid',how='left')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/frame.py", line 3001, in __getitem__
    indexer = self.loc._convert_to_indexer(key, axis=1, raise_missing=True)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1285, in _convert_to_indexer
    return self._get_listlike_indexer(obj, axis, **kwargs)[1]
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1092, in _get_listlike_indexer
    keyarr, indexer, o._get_axis_number(axis), raise_missing=raise_missing
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/indexing.py", line 1185, in _validate_read_indexer
    raise KeyError("{} not in index".format(not_found))
KeyError: "['contentname'] not in index"
2020-07-12 11:26:35 INFO 289: month  June
2020-07-12 11:26:36 INFO 321: ['i-0c5d33b02ef677e45', 'i-07e0a8ddf31d52292', 'i-05281534fbb4866af', 'i-0a885f69b71d6d8cb', 'i-0f457258e819929c9', 'i-031bef19af6e5e08d', 'i-009140abd461d0e87', 'i-0f37bfdf581bb7ee7']
2020-07-12 11:28:36 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 11:28:42 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:28:54 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:29:46 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:29:50 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:29:57 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:30:26 ERROR 409: extraction failed due to 
Traceback (most recent call last):
  File "mon_extraction2.py", line 324, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction2.py", line 184, in split_and_save
    idx = c_df.groupby(['upid_class','conceptid'])['contentattemptnumber'].transform(max) == c_df['contentattemptnumber']
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/generic.py", line 7894, in groupby
    **kwargs
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/groupby/groupby.py", line 2522, in groupby
    return klass(obj, by, **kwds)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/groupby/groupby.py", line 391, in __init__
    mutated=self.mutated,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/groupby/grouper.py", line 621, in _get_grouper
    raise KeyError(gpr)
KeyError: 'conceptid'
2020-07-12 11:33:40 INFO 289: month  June
2020-07-12 11:33:41 INFO 321: ['i-04ba1efd957054d5a', 'i-02d9a865c5e785cd2', 'i-053ab2b9758eae1cc', 'i-07bb831bef2a4914c', 'i-0558e398a58b87f9a', 'i-017ff9ab16108338c', 'i-0b62e8d4245cb431d', 'i-00dc38a88e86c52b9']
2020-07-12 11:35:41 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 11:35:42 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:35:47 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:36:12 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:36:16 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:36:23 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:36:52 INFO 193: Total students 345238
2020-07-12 11:36:52 INFO 194: Distinct student and class count 345949
2020-07-12 11:36:52 INFO 195: usage data length 345949
2020-07-12 11:36:52 INFO 196: topics data length 349105
2020-07-12 11:36:52 INFO 197: concepts data length 1781770
2020-07-12 11:36:52 INFO 203: b2b2c students 1249
2020-07-12 11:36:52 INFO 204: b2c students 77786
2020-07-12 11:36:52 INFO 205: b2b students 263163 n
2020-07-12 11:36:52 INFO 207: no of splits 8
2020-07-12 11:36:57 INFO 335: {'i-00dc38a88e86c52b9': 'ec2-3-7-54-206.ap-south-1.compute.amazonaws.com', 'i-0b62e8d4245cb431d': 'ec2-13-233-135-223.ap-south-1.compute.amazonaws.com', 'i-017ff9ab16108338c': 'ec2-3-7-74-34.ap-south-1.compute.amazonaws.com', 'i-0558e398a58b87f9a': 'ec2-13-233-135-81.ap-south-1.compute.amazonaws.com', 'i-07bb831bef2a4914c': 'ec2-3-6-210-9.ap-south-1.compute.amazonaws.com', 'i-053ab2b9758eae1cc': 'ec2-3-6-205-207.ap-south-1.compute.amazonaws.com', 'i-02d9a865c5e785cd2': 'ec2-3-6-116-253.ap-south-1.compute.amazonaws.com', 'i-04ba1efd957054d5a': 'ec2-52-66-226-243.ap-south-1.compute.amazonaws.com'}
2020-07-12 11:37:04 INFO 407: The whole thing took: 3.4 min
2020-07-12 11:42:06 INFO 289: month  June
2020-07-12 11:42:07 INFO 321: ['i-00075d7f37b9e7508', 'i-083e21c4f6c6aca4b', 'i-0f41d23f444a84a53', 'i-0da99ee9c843c2099', 'i-03a6dc94447655587', 'i-07538d29be591f5e6', 'i-07404465be79de4b9', 'i-08a9419f1a0d06cbd']
2020-07-12 11:44:07 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 11:44:09 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:44:17 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:44:55 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:44:59 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:45:06 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:45:37 INFO 193: Total students 345238
2020-07-12 11:45:37 INFO 194: Distinct student and class count 345949
2020-07-12 11:45:37 INFO 195: usage data length 345949
2020-07-12 11:45:37 INFO 196: topics data length 349105
2020-07-12 11:45:37 INFO 197: concepts data length 1781770
2020-07-12 11:45:37 INFO 203: b2b2c students 1249
2020-07-12 11:45:37 INFO 204: b2c students 77786
2020-07-12 11:45:37 INFO 205: b2b students 263163 n
2020-07-12 11:45:37 INFO 207: no of splits 8
2020-07-12 11:45:41 INFO 335: {'i-07538d29be591f5e6': 'ec2-15-206-190-59.ap-south-1.compute.amazonaws.com', 'i-03a6dc94447655587': 'ec2-13-235-210-57.ap-south-1.compute.amazonaws.com', 'i-08a9419f1a0d06cbd': 'ec2-13-235-61-60.ap-south-1.compute.amazonaws.com', 'i-07404465be79de4b9': 'ec2-52-66-226-161.ap-south-1.compute.amazonaws.com', 'i-0f41d23f444a84a53': 'ec2-52-66-232-223.ap-south-1.compute.amazonaws.com', 'i-083e21c4f6c6aca4b': 'ec2-13-235-54-201.ap-south-1.compute.amazonaws.com', 'i-0da99ee9c843c2099': 'ec2-15-206-204-39.ap-south-1.compute.amazonaws.com', 'i-00075d7f37b9e7508': 'ec2-13-235-89-36.ap-south-1.compute.amazonaws.com'}
2020-07-12 11:45:49 INFO 407: The whole thing took: 3.72 min
2020-07-12 11:49:36 INFO 289: month  June
2020-07-12 11:49:37 INFO 321: ['i-05d81edae5d7bd65d', 'i-07cb669767042e721', 'i-07c9ff86060cf3106', 'i-0e6d135e02242e3dd', 'i-0c1cd6c6ebd766324', 'i-0eb4a0633835a60c2', 'i-038dd86a019fed919', 'i-026f1b488d88dab97']
2020-07-12 11:51:37 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 11:51:38 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:51:43 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:52:09 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:52:12 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:52:20 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:52:48 INFO 193: Total students 345238
2020-07-12 11:52:48 INFO 194: Distinct student and class count 345949
2020-07-12 11:52:48 INFO 195: usage data length 345949
2020-07-12 11:52:48 INFO 196: topics data length 349105
2020-07-12 11:52:48 INFO 197: concepts data length 1781770
2020-07-12 11:52:49 INFO 203: b2b2c students 1249
2020-07-12 11:52:49 INFO 204: b2c students 77786
2020-07-12 11:52:49 INFO 205: b2b students 263163 n
2020-07-12 11:52:49 INFO 207: no of splits 8
2020-07-12 11:52:53 INFO 335: {'i-0c1cd6c6ebd766324': 'ec2-15-206-204-236.ap-south-1.compute.amazonaws.com', 'i-07c9ff86060cf3106': 'ec2-3-7-250-33.ap-south-1.compute.amazonaws.com', 'i-0e6d135e02242e3dd': 'ec2-3-7-59-29.ap-south-1.compute.amazonaws.com', 'i-05d81edae5d7bd65d': 'ec2-52-66-216-77.ap-south-1.compute.amazonaws.com', 'i-07cb669767042e721': 'ec2-3-7-62-169.ap-south-1.compute.amazonaws.com', 'i-026f1b488d88dab97': 'ec2-3-7-62-189.ap-south-1.compute.amazonaws.com', 'i-038dd86a019fed919': 'ec2-52-66-227-38.ap-south-1.compute.amazonaws.com', 'i-0eb4a0633835a60c2': 'ec2-15-206-1-16.ap-south-1.compute.amazonaws.com'}
2020-07-12 11:53:00 INFO 407: The whole thing took: 3.4 min
2020-07-12 11:56:17 INFO 289: month  June
2020-07-12 11:56:18 INFO 321: ['i-08f94ea1a3805f265', 'i-080c5efdf8155173a', 'i-0fa68f91bd78c9f27', 'i-0d129c3d3709402f4', 'i-0049d63925963e691', 'i-0cd51d146c981f657', 'i-01633137f6bd0eae0', 'i-0704a346525a2749f']
2020-07-12 11:58:18 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 11:58:19 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:58:24 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 11:58:50 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:58:53 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:59:01 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 11:59:30 INFO 193: Total students 345238
2020-07-12 11:59:30 INFO 194: Distinct student and class count 345949
2020-07-12 11:59:30 INFO 195: usage data length 345949
2020-07-12 11:59:30 INFO 196: topics data length 349105
2020-07-12 11:59:30 INFO 197: concepts data length 1781770
2020-07-12 11:59:30 INFO 203: b2b2c students 1249
2020-07-12 11:59:30 INFO 204: b2c students 77786
2020-07-12 11:59:30 INFO 205: b2b students 263163 n
2020-07-12 11:59:30 INFO 207: no of splits 8
2020-07-12 11:59:35 INFO 335: {'i-0d129c3d3709402f4': 'ec2-13-235-255-126.ap-south-1.compute.amazonaws.com', 'i-01633137f6bd0eae0': 'ec2-3-7-74-150.ap-south-1.compute.amazonaws.com', 'i-0704a346525a2749f': 'ec2-13-234-14-124.ap-south-1.compute.amazonaws.com', 'i-0049d63925963e691': 'ec2-13-235-61-116.ap-south-1.compute.amazonaws.com', 'i-0cd51d146c981f657': 'ec2-13-235-214-185.ap-south-1.compute.amazonaws.com', 'i-080c5efdf8155173a': 'ec2-13-235-60-221.ap-south-1.compute.amazonaws.com', 'i-0fa68f91bd78c9f27': 'ec2-13-235-66-10.ap-south-1.compute.amazonaws.com', 'i-08f94ea1a3805f265': 'ec2-13-233-135-151.ap-south-1.compute.amazonaws.com'}
2020-07-12 12:00:03 INFO 407: The whole thing took: 3.76 min
2020-07-12 12:26:14 INFO 289: month  June
2020-07-12 12:26:15 INFO 321: ['i-00f59456b0551b5c7', 'i-0eaa9bb93d4ccf9bc', 'i-02ac79f5fc9ca291a', 'i-02cedfe53f1d10816', 'i-09ac95bf37d076be6', 'i-0ab2c69cdb80ac052', 'i-00afeb63996c2d12c', 'i-0fcb44069545c2324']
2020-07-12 12:28:15 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 12:28:22 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 12:28:38 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 12:29:38 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 12:29:42 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 12:29:49 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 12:30:19 INFO 193: Total students 345238
2020-07-12 12:30:19 INFO 194: Distinct student and class count 345949
2020-07-12 12:30:19 INFO 195: usage data length 345949
2020-07-12 12:30:19 INFO 196: topics data length 349105
2020-07-12 12:30:19 INFO 197: concepts data length 1781770
2020-07-12 12:30:20 INFO 203: b2b2c distinct student and class count 1249
2020-07-12 12:30:20 INFO 204: b2c distinct student and class count 77786
2020-07-12 12:30:20 INFO 205: b2b distinct student and class count 263163 n
2020-07-12 12:30:20 INFO 207: no of splits 8
2020-07-12 12:30:24 INFO 335: {'i-02cedfe53f1d10816': 'ec2-13-235-54-203.ap-south-1.compute.amazonaws.com', 'i-02ac79f5fc9ca291a': 'ec2-13-235-60-1.ap-south-1.compute.amazonaws.com', 'i-00f59456b0551b5c7': 'ec2-3-6-150-146.ap-south-1.compute.amazonaws.com', 'i-0eaa9bb93d4ccf9bc': 'ec2-3-7-59-55.ap-south-1.compute.amazonaws.com', 'i-00afeb63996c2d12c': 'ec2-13-235-89-76.ap-south-1.compute.amazonaws.com', 'i-0fcb44069545c2324': 'ec2-15-206-204-19.ap-south-1.compute.amazonaws.com', 'i-0ab2c69cdb80ac052': 'ec2-13-235-216-113.ap-south-1.compute.amazonaws.com', 'i-09ac95bf37d076be6': 'ec2-13-235-66-191.ap-south-1.compute.amazonaws.com'}
2020-07-12 12:35:24 INFO 407: The whole thing took: 9.17 min
2020-07-12 13:00:53 INFO 289: month  June
2020-07-12 13:00:54 INFO 321: ['i-0007c3587f72c9411', 'i-096e0e8adf79a843c', 'i-089dd4cd96039f7bb', 'i-0e7fe086f673c64a2', 'i-09abd6235547b1013', 'i-080d3af3c9d3adb02', 'i-0dc0ef0d683a5c6d6', 'i-042c85fe14cd2362e']
2020-07-12 13:05:03 INFO 289: month  June
2020-07-12 13:05:04 INFO 321: ['i-09f6fc4acb3ed932e', 'i-04b6551f176070020', 'i-0bc1119f97d284a27', 'i-0ecd2e0a8574a232b', 'i-02d5dead40bc6d425', 'i-044c505362aa34778', 'i-07d82d60499a3050c', 'i-0a402c9d394e4c7fe']
2020-07-12 13:07:04 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 13:07:11 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 13:07:26 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 13:08:23 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 13:08:34 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 13:08:51 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 13:09:28 INFO 193: Total students 345238
2020-07-12 13:09:28 INFO 194: Distinct student and class count 345949
2020-07-12 13:09:28 INFO 195: usage data length 345949
2020-07-12 13:09:28 INFO 196: topics data length 349105
2020-07-12 13:09:28 INFO 197: concepts data length 1781770
2020-07-12 13:09:29 INFO 203: b2b2c distinct student and class count 1250
2020-07-12 13:09:29 INFO 204: b2c distinct student and class count 77786
2020-07-12 13:09:29 INFO 205: b2b distinct student and class count 263162 n
2020-07-12 13:09:29 INFO 207: no of splits 8
2020-07-12 13:09:33 INFO 335: {'i-07d82d60499a3050c': 'ec2-52-66-219-37.ap-south-1.compute.amazonaws.com', 'i-02d5dead40bc6d425': 'ec2-15-206-184-81.ap-south-1.compute.amazonaws.com', 'i-044c505362aa34778': 'ec2-13-235-64-102.ap-south-1.compute.amazonaws.com', 'i-0a402c9d394e4c7fe': 'ec2-13-235-61-174.ap-south-1.compute.amazonaws.com', 'i-04b6551f176070020': 'ec2-15-206-206-102.ap-south-1.compute.amazonaws.com', 'i-0bc1119f97d284a27': 'ec2-52-66-215-236.ap-south-1.compute.amazonaws.com', 'i-0ecd2e0a8574a232b': 'ec2-13-127-39-169.ap-south-1.compute.amazonaws.com', 'i-09f6fc4acb3ed932e': 'ec2-3-7-250-35.ap-south-1.compute.amazonaws.com'}
2020-07-12 13:14:42 INFO 407: The whole thing took: 9.66 min
2020-07-12 13:49:29 INFO 289: month  June
2020-07-12 13:49:30 INFO 321: ['i-0c236f89aa98f5aa7', 'i-005b77a6ef4a7fdfd', 'i-054f66079d43587ff', 'i-0e90df2ee814edeb2', 'i-0e27586ad2d22d87a', 'i-03d1b63f29746627b', 'i-01247f3477538be99', 'i-07d039e0008c4c135']
2020-07-12 13:51:31 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 13:51:37 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 13:51:52 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 13:52:49 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 13:52:53 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 13:53:00 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 13:53:30 INFO 193: Total students 345238
2020-07-12 13:53:30 INFO 194: Distinct student and class count 345949
2020-07-12 13:53:30 INFO 195: usage data length 345949
2020-07-12 13:53:30 INFO 196: topics data length 349105
2020-07-12 13:53:30 INFO 197: concepts data length 1781770
2020-07-12 13:53:31 INFO 203: b2b2c distinct student and class count 1250
2020-07-12 13:53:31 INFO 204: b2c distinct student and class count 77786
2020-07-12 13:53:31 INFO 205: b2b distinct student and class count 263161 n
2020-07-12 13:53:31 INFO 207: no of splits 8
2020-07-12 13:53:35 INFO 335: {'i-0e90df2ee814edeb2': 'ec2-52-66-217-204.ap-south-1.compute.amazonaws.com', 'i-0e27586ad2d22d87a': 'ec2-15-206-188-119.ap-south-1.compute.amazonaws.com', 'i-03d1b63f29746627b': 'ec2-52-66-229-53.ap-south-1.compute.amazonaws.com', 'i-01247f3477538be99': 'ec2-13-234-56-242.ap-south-1.compute.amazonaws.com', 'i-07d039e0008c4c135': 'ec2-15-206-204-190.ap-south-1.compute.amazonaws.com', 'i-0c236f89aa98f5aa7': 'ec2-3-7-249-24.ap-south-1.compute.amazonaws.com', 'i-005b77a6ef4a7fdfd': 'ec2-13-235-57-9.ap-south-1.compute.amazonaws.com', 'i-054f66079d43587ff': 'ec2-13-234-10-205.ap-south-1.compute.amazonaws.com'}
2020-07-12 13:58:38 INFO 407: The whole thing took: 9.14 min
2020-07-12 15:04:27 INFO 289: month  June
2020-07-12 15:04:28 INFO 321: ['i-02bf38c8b26768d1c', 'i-03c91458a0327e3af', 'i-045875cab8e430aa7', 'i-09c4310dac6aae629', 'i-00f2a698456ac58a9', 'i-0cb97464cf9bd449b', 'i-0636b704940ddbaf0', 'i-0d5da19c94f965a40']
2020-07-12 15:06:28 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 15:06:35 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 15:06:51 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 15:07:49 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 15:07:53 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 15:08:00 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 15:08:32 INFO 193: Total students 345238
2020-07-12 15:08:32 INFO 194: Distinct student and class count 345949
2020-07-12 15:08:32 INFO 195: usage data length 345949
2020-07-12 15:08:32 INFO 196: topics data length 349105
2020-07-12 15:08:32 INFO 197: concepts data length 1781770
2020-07-12 15:08:33 INFO 203: b2b2c distinct student and class count 1250
2020-07-12 15:08:33 INFO 204: b2c distinct student and class count 77786
2020-07-12 15:08:33 INFO 205: b2b distinct student and class count 263161 n
2020-07-12 15:08:33 INFO 207: no of splits 8
2020-07-12 15:08:37 INFO 335: {'i-0d5da19c94f965a40': 'ec2-13-234-10-140.ap-south-1.compute.amazonaws.com', 'i-09c4310dac6aae629': 'ec2-13-234-14-37.ap-south-1.compute.amazonaws.com', 'i-0cb97464cf9bd449b': 'ec2-52-66-234-180.ap-south-1.compute.amazonaws.com', 'i-0636b704940ddbaf0': 'ec2-15-206-202-66.ap-south-1.compute.amazonaws.com', 'i-045875cab8e430aa7': 'ec2-15-206-204-14.ap-south-1.compute.amazonaws.com', 'i-00f2a698456ac58a9': 'ec2-52-66-233-192.ap-south-1.compute.amazonaws.com', 'i-03c91458a0327e3af': 'ec2-3-7-62-212.ap-south-1.compute.amazonaws.com', 'i-02bf38c8b26768d1c': 'ec2-52-66-223-206.ap-south-1.compute.amazonaws.com'}
2020-07-12 15:13:43 INFO 407: The whole thing took: 9.28 min
2020-07-12 16:12:31 INFO 289: month  June
2020-07-12 16:12:32 INFO 321: ['i-0c511413cb43b5d9e', 'i-034d892aeb74a8efb', 'i-0661a338b70861b41', 'i-0be57101fea5f588b', 'i-0e7b4ecbd42c568ce', 'i-03bcae51bb558c4d9', 'i-00c290b229079c84b', 'i-06f17e2e020804c14']
2020-07-12 16:14:32 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 16:14:39 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 16:14:54 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 16:15:52 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 16:15:56 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 16:16:03 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 16:16:34 INFO 193: Total students 345238
2020-07-12 16:16:34 INFO 194: Distinct student and class count 345949
2020-07-12 16:16:34 INFO 195: usage data length 345949
2020-07-12 16:16:34 INFO 196: topics data length 349105
2020-07-12 16:16:34 INFO 197: concepts data length 1781770
2020-07-12 16:16:35 INFO 203: b2b2c distinct student and class count 1250
2020-07-12 16:16:35 INFO 204: b2c distinct student and class count 77786
2020-07-12 16:16:35 INFO 205: b2b distinct student and class count 263161 n
2020-07-12 16:16:35 INFO 207: no of splits 8
2020-07-12 16:16:59 INFO 335: {'i-06f17e2e020804c14': 'ec2-52-66-217-234.ap-south-1.compute.amazonaws.com', 'i-0be57101fea5f588b': 'ec2-13-232-45-75.ap-south-1.compute.amazonaws.com', 'i-0e7b4ecbd42c568ce': 'ec2-13-233-135-219.ap-south-1.compute.amazonaws.com', 'i-03bcae51bb558c4d9': 'ec2-3-6-7-9.ap-south-1.compute.amazonaws.com', 'i-0c511413cb43b5d9e': 'ec2-15-206-184-48.ap-south-1.compute.amazonaws.com', 'i-034d892aeb74a8efb': 'ec2-15-206-184-218.ap-south-1.compute.amazonaws.com', 'i-0661a338b70861b41': 'ec2-15-206-208-168.ap-south-1.compute.amazonaws.com', 'i-00c290b229079c84b': 'ec2-15-206-208-100.ap-south-1.compute.amazonaws.com'}
2020-07-12 16:50:40 INFO 289: month  June
2020-07-12 16:50:41 INFO 321: ['i-0278891fe06486ad0', 'i-02ee9d9dfb1a0ea35', 'i-021387947d01c4681', 'i-096104f91bab5c8b0', 'i-05d58bf59554bb7e8', 'i-06dace70bc9cf45f9', 'i-08490b4260348d562', 'i-0e196861938e2b37c']
2020-07-12 16:52:41 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-12 16:52:47 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 16:52:55 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-12 16:53:50 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 16:53:54 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 16:54:02 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30' and progress=100 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-12 16:54:33 INFO 193: Total students 345238
2020-07-12 16:54:33 INFO 194: Distinct student and class count 345949
2020-07-12 16:54:33 INFO 195: usage data length 345949
2020-07-12 16:54:33 INFO 196: topics data length 349105
2020-07-12 16:54:33 INFO 197: concepts data length 1781770
2020-07-12 16:54:34 INFO 203: b2b2c distinct student and class count 1251
2020-07-12 16:54:34 INFO 204: b2c distinct student and class count 77786
2020-07-12 16:54:34 INFO 205: b2b distinct student and class count 263160 n
2020-07-12 16:54:34 INFO 207: no of splits 8
2020-07-12 16:54:58 INFO 335: {'i-0278891fe06486ad0': 'ec2-3-6-205-118.ap-south-1.compute.amazonaws.com', 'i-05d58bf59554bb7e8': 'ec2-13-235-53-179.ap-south-1.compute.amazonaws.com', 'i-06dace70bc9cf45f9': 'ec2-13-235-255-52.ap-south-1.compute.amazonaws.com', 'i-096104f91bab5c8b0': 'ec2-13-232-59-166.ap-south-1.compute.amazonaws.com', 'i-08490b4260348d562': 'ec2-13-235-214-245.ap-south-1.compute.amazonaws.com', 'i-0e196861938e2b37c': 'ec2-52-66-223-210.ap-south-1.compute.amazonaws.com', 'i-02ee9d9dfb1a0ea35': 'ec2-15-206-207-10.ap-south-1.compute.amazonaws.com', 'i-021387947d01c4681': 'ec2-52-66-225-88.ap-south-1.compute.amazonaws.com'}
2020-07-12 18:13:03 INFO 407: The whole thing took: 82.38 min
2020-07-13 13:03:28 INFO 289: month  June
2020-07-13 13:03:29 INFO 323: ['i-0bf886e69f6c3cc08', 'i-0ca75ee01320c3833', 'i-00d5f8dd286051a3a', 'i-085eeedd05f8fc7bd', 'i-094379e39581a938c', 'i-02b6b349a3c096674', 'i-020c28fb45911f9c1', 'i-060fbadb1b61884f9']
2020-07-13 13:05:29 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-13 13:05:36 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 13:05:51 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 13:06:50 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 13:06:56 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 13:07:05 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 13:07:55 INFO 193: Total students 345339
2020-07-13 13:07:55 INFO 194: Distinct student and class count 346049
2020-07-13 13:07:55 INFO 195: usage data length 346049
2020-07-13 13:07:55 INFO 196: topics data length 349097
2020-07-13 13:07:55 INFO 197: concepts data length 1781781
2020-07-13 13:07:56 INFO 203: b2b2c distinct student and class count 1255
2020-07-13 13:07:56 INFO 204: b2c distinct student and class count 77783
2020-07-13 13:07:56 INFO 205: b2b distinct student and class count 263254 n
2020-07-13 13:07:56 INFO 207: no of splits 8
2020-07-13 13:08:20 INFO 337: {'i-094379e39581a938c': 'ec2-3-7-251-22.ap-south-1.compute.amazonaws.com', 'i-085eeedd05f8fc7bd': 'ec2-13-235-210-214.ap-south-1.compute.amazonaws.com', 'i-00d5f8dd286051a3a': 'ec2-13-235-58-31.ap-south-1.compute.amazonaws.com', 'i-0ca75ee01320c3833': 'ec2-13-235-65-139.ap-south-1.compute.amazonaws.com', 'i-0bf886e69f6c3cc08': 'ec2-15-206-190-180.ap-south-1.compute.amazonaws.com', 'i-02b6b349a3c096674': 'ec2-52-66-225-78.ap-south-1.compute.amazonaws.com', 'i-060fbadb1b61884f9': 'ec2-13-234-11-239.ap-south-1.compute.amazonaws.com', 'i-020c28fb45911f9c1': 'ec2-13-235-216-128.ap-south-1.compute.amazonaws.com'}
2020-07-13 13:34:04 INFO 289: month  June
2020-07-13 13:34:05 INFO 323: ['i-06f36b2783b26f5a4', 'i-038908797fc0b6026', 'i-05e02dc4ec37da436', 'i-0b972e714efd84ed3', 'i-07aaf463aef7ab386', 'i-05f2a9be26a76a652', 'i-035c676ff3db167a3', 'i-07f7d9002638d4ee7']
2020-07-13 13:36:05 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-13 13:36:12 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 13:36:29 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 13:37:29 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 13:37:34 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 13:37:44 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 13:38:18 INFO 193: Total students 345339
2020-07-13 13:38:18 INFO 194: Distinct student and class count 346049
2020-07-13 13:38:18 INFO 195: usage data length 346049
2020-07-13 13:38:18 INFO 196: topics data length 349097
2020-07-13 13:38:18 INFO 197: concepts data length 1781781
2020-07-13 13:38:18 INFO 203: b2b2c distinct student and class count 1256
2020-07-13 13:38:18 INFO 204: b2c distinct student and class count 77783
2020-07-13 13:38:18 INFO 205: b2b distinct student and class count 263253 n
2020-07-13 13:38:18 INFO 207: no of splits 8
2020-07-13 13:38:43 INFO 337: {'i-07f7d9002638d4ee7': 'ec2-13-235-215-181.ap-south-1.compute.amazonaws.com', 'i-035c676ff3db167a3': 'ec2-13-234-14-161.ap-south-1.compute.amazonaws.com', 'i-05f2a9be26a76a652': 'ec2-13-234-12-25.ap-south-1.compute.amazonaws.com', 'i-05e02dc4ec37da436': 'ec2-15-206-188-210.ap-south-1.compute.amazonaws.com', 'i-07aaf463aef7ab386': 'ec2-3-7-57-146.ap-south-1.compute.amazonaws.com', 'i-0b972e714efd84ed3': 'ec2-15-206-202-241.ap-south-1.compute.amazonaws.com', 'i-038908797fc0b6026': 'ec2-3-7-251-174.ap-south-1.compute.amazonaws.com', 'i-06f36b2783b26f5a4': 'ec2-52-66-227-179.ap-south-1.compute.amazonaws.com'}
2020-07-13 13:38:49 INFO 404: no_usage b2b2c students 0
2020-07-13 13:38:49 INFO 405: not_done b2b2c students 0
2020-07-13 13:38:49 INFO 406: done b2b2c students 0
2020-07-13 13:38:49 INFO 404: no_usage b2b students 0
2020-07-13 13:38:49 INFO 405: not_done b2b students 0
2020-07-13 13:38:49 INFO 406: done b2b students 0
2020-07-13 13:38:50 INFO 404: no_usage b2c students 0
2020-07-13 13:38:50 INFO 405: not_done b2c students 0
2020-07-13 13:38:50 INFO 406: done b2c students 0
2020-07-13 13:38:50 INFO 416: The whole thing took: 4.77 min
2020-07-13 14:16:21 INFO 289: month  June
2020-07-13 14:16:23 INFO 323: ['i-0ba77e27fc168b40f', 'i-086163303ab0fc899', 'i-08a948ac55b436601', 'i-045c94d5400c1a545', 'i-0b8b0706281de7021', 'i-019ba9f9da49bd6b4', 'i-0bc62154bc4cf996f', 'i-096a8495e6ec3c017']
2020-07-13 14:21:32 INFO 289: month  June
2020-07-13 14:21:33 INFO 323: ['i-06b2d2038a9662f15', 'i-0f68e6cd29fae8fbe', 'i-02c7c0e7576b6e0d6', 'i-0214129b3f721c3c1', 'i-0202aba353dca2409', 'i-0c2c80c18102fc1af', 'i-0aa0576ac3e560660', 'i-0ffc4de3aaff5d86f']
2020-07-13 14:23:33 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-13 14:23:40 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 14:23:56 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 14:24:53 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 14:24:57 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 14:25:07 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 14:25:42 INFO 193: Total students 345339
2020-07-13 14:25:42 INFO 194: Distinct student and class count 346049
2020-07-13 14:25:42 INFO 195: usage data length 346049
2020-07-13 14:25:42 INFO 196: topics data length 349097
2020-07-13 14:25:42 INFO 197: concepts data length 1781781
2020-07-13 14:25:43 INFO 203: b2b2c distinct student and class count 1258
2020-07-13 14:25:43 INFO 204: b2c distinct student and class count 77783
2020-07-13 14:25:43 INFO 205: b2b distinct student and class count 263251 n
2020-07-13 14:25:43 INFO 207: no of splits 8
2020-07-13 14:26:08 INFO 337: {'i-0aa0576ac3e560660': 'ec2-52-66-218-62.ap-south-1.compute.amazonaws.com', 'i-0c2c80c18102fc1af': 'ec2-13-234-10-129.ap-south-1.compute.amazonaws.com', 'i-0202aba353dca2409': 'ec2-3-7-54-24.ap-south-1.compute.amazonaws.com', 'i-0ffc4de3aaff5d86f': 'ec2-13-233-19-74.ap-south-1.compute.amazonaws.com', 'i-06b2d2038a9662f15': 'ec2-3-7-255-248.ap-south-1.compute.amazonaws.com', 'i-0f68e6cd29fae8fbe': 'ec2-3-6-205-37.ap-south-1.compute.amazonaws.com', 'i-02c7c0e7576b6e0d6': 'ec2-3-6-7-159.ap-south-1.compute.amazonaws.com', 'i-0214129b3f721c3c1': 'ec2-13-235-53-179.ap-south-1.compute.amazonaws.com'}
2020-07-13 14:26:50 INFO 404: no_usage b2b2c students 0
2020-07-13 14:26:50 INFO 405: not_done b2b2c students 0
2020-07-13 14:26:50 INFO 406: done b2b2c students 0
2020-07-13 14:26:50 INFO 404: no_usage b2b students 0
2020-07-13 14:26:50 INFO 405: not_done b2b students 0
2020-07-13 14:26:50 INFO 406: done b2b students 0
2020-07-13 14:26:51 INFO 404: no_usage b2c students 0
2020-07-13 14:26:51 INFO 405: not_done b2c students 0
2020-07-13 14:26:51 INFO 406: done b2c students 0
2020-07-13 14:26:51 INFO 416: The whole thing took: 5.31 min
2020-07-13 14:39:14 INFO 289: month  June
2020-07-13 14:39:16 INFO 323: ['i-0c0ab4b0308f74ff6', 'i-0015ea4aca608b25d', 'i-0fb764d932cf80b5b', 'i-04c5a092f977e5e41', 'i-09d4ac1d55305c18c', 'i-0f328c5050ae11798', 'i-040bb837b9d2d89ed', 'i-0e06e661f0117df9d']
2020-07-13 14:41:16 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-13 14:41:21 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 14:41:31 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 14:42:28 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 14:42:32 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 14:42:42 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where enddate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 14:43:15 INFO 193: Total students 345339
2020-07-13 14:43:15 INFO 194: Distinct student and class count 346049
2020-07-13 14:43:15 INFO 195: usage data length 346049
2020-07-13 14:43:15 INFO 196: topics data length 349097
2020-07-13 14:43:15 INFO 197: concepts data length 1781781
2020-07-13 14:43:16 INFO 203: b2b2c distinct student and class count 1258
2020-07-13 14:43:16 INFO 204: b2c distinct student and class count 77783
2020-07-13 14:43:16 INFO 205: b2b distinct student and class count 263251 n
2020-07-13 14:43:16 INFO 207: no of splits 8
2020-07-13 14:43:41 INFO 337: {'i-040bb837b9d2d89ed': 'ec2-13-235-214-31.ap-south-1.compute.amazonaws.com', 'i-0015ea4aca608b25d': 'ec2-15-206-204-228.ap-south-1.compute.amazonaws.com', 'i-04c5a092f977e5e41': 'ec2-13-235-252-170.ap-south-1.compute.amazonaws.com', 'i-09d4ac1d55305c18c': 'ec2-3-7-37-83.ap-south-1.compute.amazonaws.com', 'i-0e06e661f0117df9d': 'ec2-13-234-56-174.ap-south-1.compute.amazonaws.com', 'i-0f328c5050ae11798': 'ec2-52-66-230-25.ap-south-1.compute.amazonaws.com', 'i-0c0ab4b0308f74ff6': 'ec2-3-7-250-177.ap-south-1.compute.amazonaws.com', 'i-0fb764d932cf80b5b': 'ec2-3-7-54-2.ap-south-1.compute.amazonaws.com'}
2020-07-13 16:03:34 INFO 404: no_usage b2b2c students 264
2020-07-13 16:03:34 INFO 405: not_done b2b2c students 0
2020-07-13 16:03:34 INFO 406: done b2b2c students 994
2020-07-13 16:03:36 INFO 404: no_usage b2b students 164684
2020-07-13 16:03:36 INFO 405: not_done b2b students 0
2020-07-13 16:03:36 INFO 406: done b2b students 98567
2020-07-13 16:03:37 INFO 404: no_usage b2c students 70676
2020-07-13 16:03:37 INFO 405: not_done b2c students 0
2020-07-13 16:03:37 INFO 406: done b2c students 7107
2020-07-13 16:03:37 INFO 419: The whole thing took: 84.38 min
2020-07-13 16:27:59 INFO 289: month  June
2020-07-13 16:28:00 INFO 323: ['i-073fd4dc50a8eb0f4', 'i-07ea36ed60c1b7f63', 'i-0bb82a451858c1c81', 'i-0ed45a15fa6c9de49', 'i-0e3b54e8532e3db93', 'i-0f79eb882c03b83d3', 'i-0f0127ef33cffb7b8', 'i-0a52b29480459cb1e']
2020-07-13 16:30:01 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-13 16:30:08 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 16:30:23 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 16:31:23 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 16:31:27 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 16:31:37 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where startdate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and startdate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-13 16:31:53 INFO 193: Total students 345339
2020-07-13 16:31:53 INFO 194: Distinct student and class count 346049
2020-07-13 16:31:53 INFO 195: usage data length 346049
2020-07-13 16:31:53 INFO 196: topics data length 349097
2020-07-13 16:31:53 INFO 197: concepts data length 100253
2020-07-13 16:31:54 INFO 203: b2b2c distinct student and class count 1260
2020-07-13 16:31:54 INFO 204: b2c distinct student and class count 77781
2020-07-13 16:31:54 INFO 205: b2b distinct student and class count 263250 n
2020-07-13 16:31:54 INFO 207: no of splits 8
2020-07-13 16:32:03 INFO 337: {'i-0ed45a15fa6c9de49': 'ec2-3-7-57-179.ap-south-1.compute.amazonaws.com', 'i-073fd4dc50a8eb0f4': 'ec2-3-7-249-252.ap-south-1.compute.amazonaws.com', 'i-0bb82a451858c1c81': 'ec2-3-7-251-175.ap-south-1.compute.amazonaws.com', 'i-0f79eb882c03b83d3': 'ec2-3-7-255-195.ap-south-1.compute.amazonaws.com', 'i-0e3b54e8532e3db93': 'ec2-13-235-57-62.ap-south-1.compute.amazonaws.com', 'i-0a52b29480459cb1e': 'ec2-13-232-107-51.ap-south-1.compute.amazonaws.com', 'i-0f0127ef33cffb7b8': 'ec2-52-66-224-25.ap-south-1.compute.amazonaws.com', 'i-07ea36ed60c1b7f63': 'ec2-15-206-208-217.ap-south-1.compute.amazonaws.com'}
2020-07-13 17:18:33 INFO 404: no_usage b2b2c students 264
2020-07-13 17:18:33 INFO 405: not_done b2b2c students 0
2020-07-13 17:18:33 INFO 406: done b2b2c students 996
2020-07-13 17:18:34 INFO 404: no_usage b2b students 164684
2020-07-13 17:18:34 INFO 405: not_done b2b students 0
2020-07-13 17:18:34 INFO 406: done b2b students 98566
2020-07-13 17:18:35 INFO 404: no_usage b2c students 70676
2020-07-13 17:18:35 INFO 405: not_done b2c students 0
2020-07-13 17:18:35 INFO 406: done b2c students 7105
2020-07-13 17:18:36 INFO 419: The whole thing took: 50.61 min
2020-07-13 18:44:10 INFO 289: month  June
2020-07-13 18:44:10 INFO 57: SELECT distinct concat(CAST(A.MS_userID AS char(100)) ,'_',cast(A.class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-13 18:44:17 INFO 72: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 18:44:32 INFO 85: SELECT distinct concat(CAST(MS_userID AS char(100)) ,'_',cast(class AS char(100)) ) as MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-13 18:45:29 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and  upid=1066686
    
2020-07-13 18:45:30 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and  upid=1066686
    
2020-07-13 18:45:49 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where startdate>='2020-06-01' and contenttype='concept' and startdate <='2020-06-30'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and startdate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and  upid=1066686
    
2020-07-13 18:45:59 ERROR 312: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.ProgrammingError: syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "local_extraction.py", line 310, in <module>
    split_and_save(no_of_instances)
  File "local_extraction.py", line 170, in split_and_save
    topic_name = get_topic_names(contentids)
  File "local_extraction.py", line 123, in get_topic_names
    topic_name_1 = pd.read_sql(query,redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select  contentid,contentname from msm_topic_flow where contentid in ()': syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^

2020-07-15 15:01:16 INFO 290: month  June
2020-07-15 15:01:16 ERROR 422: extraction failed due to 
Traceback (most recent call last):
  File "mon_extraction3.py", line 309, in <module>
    no_of_instances=int(sys.argv[1])
IndexError: list index out of range
2020-07-15 15:01:37 INFO 290: month  June
2020-07-15 15:01:38 INFO 324: ['i-058f15b79605736dc', 'i-056101cbb2afa9cc3', 'i-006471333eabe305e', 'i-0af2f23af116b90cc', 'i-0d1c75afd04e020f2', 'i-0d2baeab495df010c', 'i-06812c22e630359ab', 'i-0a76106c1253f4171']
2020-07-15 15:03:38 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-15 15:03:43 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 15:03:54 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 15:05:36 INFO 290: month  June
2020-07-15 15:05:37 INFO 324: ['i-06657a93e984e4c9a', 'i-02534a208637809e5', 'i-0e648f20c1c48e77c', 'i-043e2a4f029ac4600', 'i-0a44a4133bd8e54fb', 'i-04dca2630533a9482', 'i-07ca3d4b00a85d96a', 'i-045686cc5a72bff7e']
2020-07-15 15:07:37 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-15 15:07:38 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 15:07:41 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 15:08:02 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-15 15:08:06 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-15 15:08:14 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where ((startdate>='2020-06-01' and startdate <='2020-06-30') or (enddate>='2020-06-01' and enddate <='2020-06-30')) and  contenttype='concept'   
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) 
    
2020-07-15 15:09:03 INFO 194: Total students 346117
2020-07-15 15:09:03 INFO 195: Distinct student and class count 346827
2020-07-15 15:09:03 INFO 196: usage data length 346827
2020-07-15 15:09:03 INFO 197: topics data length 349363
2020-07-15 15:09:03 INFO 198: concepts data length 1994644
2020-07-15 15:09:04 INFO 204: b2b2c distinct student and class count 1361
2020-07-15 15:09:04 INFO 205: b2c distinct student and class count 77805
2020-07-15 15:09:04 INFO 206: b2b distinct student and class count 267661 n
2020-07-15 15:09:04 INFO 208: no of splits 8
2020-07-15 15:09:29 INFO 338: {'i-07ca3d4b00a85d96a': 'ec2-52-66-215-190.ap-south-1.compute.amazonaws.com', 'i-02534a208637809e5': 'ec2-13-127-232-244.ap-south-1.compute.amazonaws.com', 'i-043e2a4f029ac4600': 'ec2-3-7-59-125.ap-south-1.compute.amazonaws.com', 'i-04dca2630533a9482': 'ec2-13-235-56-153.ap-south-1.compute.amazonaws.com', 'i-045686cc5a72bff7e': 'ec2-3-6-43-14.ap-south-1.compute.amazonaws.com', 'i-06657a93e984e4c9a': 'ec2-13-235-66-236.ap-south-1.compute.amazonaws.com', 'i-0e648f20c1c48e77c': 'ec2-13-235-61-17.ap-south-1.compute.amazonaws.com', 'i-0a44a4133bd8e54fb': 'ec2-3-7-74-176.ap-south-1.compute.amazonaws.com'}
2020-07-15 15:09:38 INFO 405: no_usage b2b2c students 0
2020-07-15 15:09:38 INFO 406: not_done b2b2c students 0
2020-07-15 15:09:38 INFO 407: done b2b2c students 0
2020-07-15 15:09:39 INFO 405: no_usage b2b students 0
2020-07-15 15:09:39 INFO 406: not_done b2b students 0
2020-07-15 15:09:39 INFO 407: done b2b students 0
2020-07-15 15:09:39 INFO 405: no_usage b2c students 0
2020-07-15 15:09:39 INFO 406: not_done b2c students 0
2020-07-15 15:09:39 INFO 407: done b2c students 0
2020-07-15 15:09:40 INFO 420: The whole thing took: 4.07 min
2020-07-15 15:56:05 INFO 290: month  June
2020-07-15 15:56:07 INFO 324: ['i-03a0a230ce8afe8de', 'i-0a1a7a87898ee2eb3', 'i-0ad5437fe2868ce69', 'i-05c3b6d332c72c14c', 'i-0f8b4189393e0d165', 'i-042af9103ffa3d030', 'i-010615860bf5b8a22', 'i-0b2c37e86d93c65c0']
2020-07-15 15:58:07 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-15 15:58:14 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 15:58:27 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 15:59:06 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-15 15:59:10 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-15 15:59:17 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where ((startdate>='2020-06-01' and startdate <='2020-06-30') or (enddate>='2020-06-01' and enddate <='2020-06-30')) and  contenttype='concept'   
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) 
    
2020-07-15 16:00:01 INFO 194: Total students 346117
2020-07-15 16:00:01 INFO 195: Distinct student and class count 346827
2020-07-15 16:00:01 INFO 196: usage data length 346827
2020-07-15 16:00:01 INFO 197: topics data length 349363
2020-07-15 16:00:01 INFO 198: concepts data length 1994644
2020-07-15 16:00:01 INFO 204: b2b2c distinct student and class count 1362
2020-07-15 16:00:01 INFO 205: b2c distinct student and class count 77805
2020-07-15 16:00:01 INFO 206: b2b distinct student and class count 267660 n
2020-07-15 16:00:01 INFO 208: no of splits 8
2020-07-15 16:00:27 INFO 338: {'i-0b2c37e86d93c65c0': 'ec2-3-6-43-60.ap-south-1.compute.amazonaws.com', 'i-010615860bf5b8a22': 'ec2-3-7-74-30.ap-south-1.compute.amazonaws.com', 'i-05c3b6d332c72c14c': 'ec2-13-235-53-178.ap-south-1.compute.amazonaws.com', 'i-0ad5437fe2868ce69': 'ec2-52-66-215-80.ap-south-1.compute.amazonaws.com', 'i-0a1a7a87898ee2eb3': 'ec2-13-235-62-235.ap-south-1.compute.amazonaws.com', 'i-03a0a230ce8afe8de': 'ec2-13-234-11-240.ap-south-1.compute.amazonaws.com', 'i-042af9103ffa3d030': 'ec2-52-66-215-194.ap-south-1.compute.amazonaws.com', 'i-0f8b4189393e0d165': 'ec2-15-206-206-92.ap-south-1.compute.amazonaws.com'}
2020-07-15 16:12:21 INFO 290: month  June
2020-07-15 16:12:23 INFO 324: ['i-019acfa64097341b1', 'i-09c2457640a0f79cc', 'i-05fad928b0af9f780', 'i-0f103f4988e714541', 'i-08cb8beec900c9f3f', 'i-0162b2685e7ca8e0b', 'i-016963e6066e71a34', 'i-0d4626a14789d75f8']
2020-07-15 16:14:23 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-15 16:14:30 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 16:14:42 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-15 16:15:22 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-15 16:15:26 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') )
    
2020-07-15 16:15:34 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where ((startdate>='2020-06-01' and startdate <='2020-06-30') or (enddate>='2020-06-01' and enddate <='2020-06-30')) and  contenttype='concept'   
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) 
    
2020-07-15 16:16:19 INFO 194: Total students 346117
2020-07-15 16:16:19 INFO 195: Distinct student and class count 346827
2020-07-15 16:16:19 INFO 196: usage data length 346827
2020-07-15 16:16:19 INFO 197: topics data length 349363
2020-07-15 16:16:19 INFO 198: concepts data length 1994644
2020-07-15 16:16:19 INFO 204: b2b2c distinct student and class count 1362
2020-07-15 16:16:19 INFO 205: b2c distinct student and class count 77805
2020-07-15 16:16:19 INFO 206: b2b distinct student and class count 267660 n
2020-07-15 16:16:19 INFO 208: no of splits 8
2020-07-15 16:16:44 INFO 338: {'i-05fad928b0af9f780': 'ec2-13-235-58-54.ap-south-1.compute.amazonaws.com', 'i-08cb8beec900c9f3f': 'ec2-15-206-202-242.ap-south-1.compute.amazonaws.com', 'i-016963e6066e71a34': 'ec2-3-7-251-11.ap-south-1.compute.amazonaws.com', 'i-0162b2685e7ca8e0b': 'ec2-3-6-210-11.ap-south-1.compute.amazonaws.com', 'i-0f103f4988e714541': 'ec2-15-206-204-178.ap-south-1.compute.amazonaws.com', 'i-09c2457640a0f79cc': 'ec2-15-206-206-252.ap-south-1.compute.amazonaws.com', 'i-019acfa64097341b1': 'ec2-13-235-54-98.ap-south-1.compute.amazonaws.com', 'i-0d4626a14789d75f8': 'ec2-13-234-56-6.ap-south-1.compute.amazonaws.com'}
2020-07-15 17:44:29 INFO 405: no_usage b2b2c students 290
2020-07-15 17:44:29 INFO 406: not_done b2b2c students 0
2020-07-15 17:44:29 INFO 407: done b2b2c students 1072
2020-07-15 17:44:30 INFO 405: no_usage b2b students 167219
2020-07-15 17:44:30 INFO 406: not_done b2b students 0
2020-07-15 17:44:30 INFO 407: done b2b students 100441
2020-07-15 17:44:31 INFO 405: no_usage b2c students 70693
2020-07-15 17:44:31 INFO 406: not_done b2c students 0
2020-07-15 17:44:31 INFO 407: done b2c students 7112
2020-07-15 17:44:32 INFO 420: The whole thing took: 92.18 min
2020-07-17 20:29:02 INFO 215: week start date 2020-07-10
2020-07-17 20:29:04 INFO 250: ['i-02dff1d554dc8a917', 'i-095813a749ed4fff0', 'i-0de9ab40fa035a3ea', 'i-09d619fbd1ad72947', 'i-014b01728213328ec', 'i-00b33effc6288046e', 'i-043347ce53dfc063b', 'i-0b28b5de136749853']
2020-07-17 20:31:04 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-17 20:31:12 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-17 20:31:25 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-17 20:32:00 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-10' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-17 20:32:12 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-10'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-17 20:32:27 INFO 141: Total students 106276
2020-07-17 20:32:27 INFO 142: usage data length 106276
2020-07-17 20:32:27 INFO 143: topics data length 60414
2020-07-17 20:32:27 INFO 149: b2b2c students 1425
2020-07-17 20:32:27 INFO 150: b2c students 18153
2020-07-17 20:32:27 INFO 151: b2b students 86698 (not processing now)
2020-07-17 20:32:27 INFO 264: {'i-02dff1d554dc8a917': 'ec2-15-206-183-213.ap-south-1.compute.amazonaws.com', 'i-0de9ab40fa035a3ea': 'ec2-3-6-43-39.ap-south-1.compute.amazonaws.com', 'i-014b01728213328ec': 'ec2-13-235-59-246.ap-south-1.compute.amazonaws.com', 'i-00b33effc6288046e': 'ec2-15-206-190-36.ap-south-1.compute.amazonaws.com', 'i-0b28b5de136749853': 'ec2-52-66-226-108.ap-south-1.compute.amazonaws.com', 'i-095813a749ed4fff0': 'ec2-52-66-218-204.ap-south-1.compute.amazonaws.com', 'i-09d619fbd1ad72947': 'ec2-13-235-252-134.ap-south-1.compute.amazonaws.com', 'i-043347ce53dfc063b': 'ec2-3-7-58-146.ap-south-1.compute.amazonaws.com'}
2020-07-17 20:33:52 INFO 323: no_usage_b2b2c_students 432
2020-07-17 20:33:52 INFO 324: not_done_b2b2c_students 0
2020-07-17 20:33:52 INFO 323: no_usage_b2c_students 16711
2020-07-17 20:33:52 INFO 324: not_done_b2c_students 0
2020-07-17 20:33:53 INFO 334: The whole thing took: 4.84 min
2020-07-20 16:31:29 INFO 215: week start date 2020-07-17
2020-07-20 16:31:30 INFO 252: ['i-0c05c3fef859719ac']
2020-07-20 16:33:30 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-17' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-20 16:33:36 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-17'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-20 16:34:02 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-17'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-20 16:35:15 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-17' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-17' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-23') )
2020-07-20 16:35:16 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-17'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-17' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-23') )
2020-07-20 16:35:23 ERROR 338: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.ProgrammingError: syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction3.py", line 255, in <module>
    split_and_save(no_of_instances)
  File "extraction3.py", line 130, in split_and_save
    topic_name_1 = pd.read_sql(query,redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select  contentid,contentname from msm_topic_flow where contentid in ()': syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^

2020-07-20 16:45:09 INFO 215: week start date 2020-07-10
2020-07-20 16:45:10 INFO 266: ['i-0c3beb62800ebce50']
2020-07-20 16:47:11 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-20 16:47:18 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-20 16:47:34 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-20 16:48:21 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-10' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-20 16:48:24 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-10'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-20 16:48:28 INFO 141: Total students 106609
2020-07-20 16:48:28 INFO 142: usage data length 106609
2020-07-20 16:48:28 INFO 143: topics data length 60508
2020-07-20 16:48:29 INFO 149: b2b2c students 1427
2020-07-20 16:48:29 INFO 150: b2c students 18152
2020-07-20 16:48:29 INFO 151: b2b students 87030 (not processing now)
2020-07-20 16:48:29 INFO 280: {'i-0c3beb62800ebce50': 'ec2-52-66-229-148.ap-south-1.compute.amazonaws.com'}
2020-07-20 16:55:04 INFO 339: no_usage_b2b2c_students 438
2020-07-20 16:55:04 INFO 340: not_done_b2b2c_students 0
2020-07-20 16:55:05 INFO 339: no_usage_b2c_students 16709
2020-07-20 16:55:05 INFO 340: not_done_b2c_students 0
2020-07-20 16:55:05 INFO 350: The whole thing took: 9.93 min
2020-07-22 11:34:59 INFO 292: month  May
2020-07-22 11:35:00 INFO 341: ['i-0b6b945762f5053e7']
2020-07-22 11:37:00 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-05-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-05-31')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 11:37:14 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-05-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-05-31')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 11:37:41 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-05-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-05-31')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 11:38:57 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='5' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-05-31') ) and oldschoolcode=4156961
    
2020-07-22 11:39:05 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =5  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-05-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-05-31') ) and oldschoolcode=4156961
    
2020-07-22 11:39:11 ERROR 439: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.ProgrammingError: syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mon_extraction3.py", line 344, in <module>
    split_and_save(no_of_instances)
  File "mon_extraction3.py", line 161, in split_and_save
    topic_name = get_topic_names(contentids)
  File "mon_extraction3.py", line 123, in get_topic_names
    topic_name_1 = pd.read_sql(query,redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select  contentid,contentname from msm_topic_flow where contentid in ()': syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^

2020-07-22 12:24:44 INFO 292: month  June
2020-07-22 12:24:45 INFO 341: ['i-0359c53d17208d7e5']
2020-07-22 12:26:45 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 12:26:59 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 12:27:23 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 12:28:40 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-22 12:28:47 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-22 12:28:59 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where ((startdate>='2020-06-01' and startdate <='2020-06-30') or (enddate>='2020-06-01' and enddate <='2020-06-30')) and  contenttype='concept'   
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and old_school_code=4156961
    
2020-07-22 12:29:08 INFO 194: Total students 20
2020-07-22 12:29:08 INFO 195: Distinct student and class count 20
2020-07-22 12:29:08 INFO 196: usage data length 20
2020-07-22 12:29:08 INFO 197: topics data length 77
2020-07-22 12:29:08 INFO 198: concepts data length 153
2020-07-22 12:29:08 INFO 204: b2b2c distinct student and class count 0
2020-07-22 12:29:08 INFO 205: b2c distinct student and class count 0
2020-07-22 12:29:08 INFO 206: b2b distinct student and class count 20 n
2020-07-22 12:29:08 INFO 208: no of splits 1
2020-07-22 12:29:10 INFO 355: {'i-0359c53d17208d7e5': 'ec2-13-235-216-84.ap-south-1.compute.amazonaws.com'}
2020-07-22 12:29:26 INFO 422: no_usage b2b2c students 0
2020-07-22 12:29:26 INFO 423: not_done b2b2c students 0
2020-07-22 12:29:26 INFO 424: done b2b2c students 0
2020-07-22 12:29:27 INFO 422: no_usage b2b students 0
2020-07-22 12:29:27 INFO 423: not_done b2b students 0
2020-07-22 12:29:27 INFO 424: done b2b students 0
2020-07-22 12:29:27 INFO 422: no_usage b2c students 0
2020-07-22 12:29:27 INFO 423: not_done b2c students 0
2020-07-22 12:29:27 INFO 424: done b2c students 0
2020-07-22 12:29:27 INFO 437: The whole thing took: 4.73 min
2020-07-22 12:47:17 INFO 289: month  June
2020-07-22 12:47:18 INFO 338: ['i-07744d731c20681ff']
2020-07-22 12:49:18 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 12:49:33 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 12:50:05 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 12:50:59 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-22 12:51:04 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-22 12:51:10 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where ((startdate>='2020-06-01' and startdate <='2020-06-30') or (enddate>='2020-06-01' and enddate <='2020-06-30')) and  contenttype='concept'   
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and old_school_code=4156961
    
2020-07-22 12:51:13 INFO 194: Total students 20
2020-07-22 12:51:13 INFO 195: Distinct student and class count 20
2020-07-22 12:51:13 INFO 196: usage data length 20
2020-07-22 12:51:13 INFO 197: topics data length 77
2020-07-22 12:51:13 INFO 198: concepts data length 153
2020-07-22 12:51:14 INFO 204: b2b2c distinct student and class count 0
2020-07-22 12:51:14 INFO 205: b2c distinct student and class count 0
2020-07-22 12:51:14 INFO 206: b2b distinct student and class count 20 n
2020-07-22 12:51:14 INFO 208: no of splits 1
2020-07-22 12:51:15 INFO 352: {'i-07744d731c20681ff': 'ec2-15-206-207-170.ap-south-1.compute.amazonaws.com'}
2020-07-22 12:51:56 INFO 418: no_usage b2b2c students 0
2020-07-22 12:51:56 INFO 419: not_done b2b2c students 0
2020-07-22 12:51:56 INFO 420: done b2b2c students 0
2020-07-22 12:51:57 INFO 418: no_usage b2b students 4
2020-07-22 12:51:57 INFO 419: not_done b2b students 0
2020-07-22 12:51:57 INFO 420: done b2b students 16
2020-07-22 12:51:57 INFO 418: no_usage b2c students 0
2020-07-22 12:51:57 INFO 419: not_done b2c students 0
2020-07-22 12:51:57 INFO 420: done b2c students 0
2020-07-22 12:51:58 INFO 433: The whole thing took: 4.68 min
2020-07-22 14:29:02 INFO 215: week start date 2020-07-10
2020-07-22 14:29:03 INFO 267: ['i-0ed83bc32981e9e3a']
2020-07-22 14:31:03 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 14:31:08 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 14:31:12 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 14:31:49 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-10' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 14:31:52 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-10'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 14:31:57 INFO 141: Total students 106809
2020-07-22 14:31:57 INFO 142: usage data length 106809
2020-07-22 14:31:57 INFO 143: topics data length 60558
2020-07-22 14:31:57 INFO 149: b2b2c students 1451
2020-07-22 14:31:57 INFO 150: b2c students 18130
2020-07-22 14:31:57 INFO 151: b2b students 87228 (not processing now)
2020-07-22 14:31:57 INFO 281: {'i-0ed83bc32981e9e3a': 'ec2-15-206-202-68.ap-south-1.compute.amazonaws.com'}
2020-07-22 14:38:48 INFO 346: no_usage_b2b2c_students 445
2020-07-22 14:38:48 INFO 347: not_done_b2b2c_students 0
2020-07-22 14:38:48 INFO 348: done b2b2c students 1006
2020-07-22 14:38:48 ERROR 377: extraction failed due to 
Traceback (most recent call last):
  File "extraction3.py", line 350, in <module>
    tmp4.append(df1)
NameError: name 'tmp4' is not defined
2020-07-22 14:46:36 INFO 289: month  June
2020-07-22 14:46:37 INFO 338: ['i-0ce0c45e8e9e2175a']
2020-07-22 14:48:37 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 14:48:44 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 14:48:56 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 14:49:32 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-22 14:49:33 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-22 14:49:36 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where ((startdate>='2020-06-01' and startdate <='2020-06-30') or (enddate>='2020-06-01' and enddate <='2020-06-30')) and  contenttype='concept'   
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and old_school_code=4156961
    
2020-07-22 14:49:39 INFO 194: Total students 20
2020-07-22 14:49:39 INFO 195: Distinct student and class count 20
2020-07-22 14:49:39 INFO 196: usage data length 20
2020-07-22 14:49:39 INFO 197: topics data length 77
2020-07-22 14:49:39 INFO 198: concepts data length 153
2020-07-22 14:49:40 INFO 204: b2b2c distinct student and class count 0
2020-07-22 14:49:40 INFO 205: b2c distinct student and class count 0
2020-07-22 14:49:40 INFO 206: b2b distinct student and class count 20 n
2020-07-22 14:49:40 INFO 208: no of splits 1
2020-07-22 14:49:42 INFO 352: {'i-0ce0c45e8e9e2175a': 'ec2-15-206-206-123.ap-south-1.compute.amazonaws.com'}
2020-07-22 14:50:15 INFO 418: no_usage b2b2c students 0
2020-07-22 14:50:15 INFO 419: not_done b2b2c students 0
2020-07-22 14:50:15 INFO 420: done b2b2c students 0
2020-07-22 14:50:15 INFO 418: no_usage b2b students 4
2020-07-22 14:50:15 INFO 419: not_done b2b students 0
2020-07-22 14:50:15 INFO 420: done b2b students 16
2020-07-22 14:50:16 INFO 418: no_usage b2c students 0
2020-07-22 14:50:16 INFO 419: not_done b2c students 0
2020-07-22 14:50:16 INFO 420: done b2c students 0
2020-07-22 14:50:16 INFO 433: The whole thing took: 3.67 min
2020-07-22 14:51:21 INFO 215: week start date 2020-07-10
2020-07-22 14:51:22 INFO 267: ['i-07ab67e584272cbf5']
2020-07-22 14:53:22 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 14:53:23 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 14:53:25 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 14:53:33 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-10' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 14:53:36 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-10'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 14:53:41 INFO 141: Total students 106809
2020-07-22 14:53:41 INFO 142: usage data length 106809
2020-07-22 14:53:41 INFO 143: topics data length 60558
2020-07-22 14:53:41 INFO 149: b2b2c students 1451
2020-07-22 14:53:41 INFO 150: b2c students 18130
2020-07-22 14:53:41 INFO 151: b2b students 87228 (not processing now)
2020-07-22 14:53:41 INFO 281: {'i-07ab67e584272cbf5': 'ec2-3-7-250-6.ap-south-1.compute.amazonaws.com'}
2020-07-22 15:00:16 INFO 347: no_usage_b2b2c_students 445
2020-07-22 15:00:16 INFO 348: not_done_b2b2c_students 0
2020-07-22 15:00:16 INFO 349: done b2b2c students 1006
2020-07-22 15:00:16 ERROR 378: extraction failed due to 
Traceback (most recent call last):
  File "extraction3.py", line 357, in <module>
    df4.append(temp4)
NameError: name 'temp4' is not defined
2020-07-22 15:02:33 INFO 215: week start date 2020-07-10
2020-07-22 15:02:35 INFO 267: ['i-05c386f4337843b9e']
2020-07-22 15:04:35 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 15:04:39 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 15:04:42 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 15:04:51 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-10' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 15:04:54 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-10'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 15:04:59 INFO 141: Total students 106809
2020-07-22 15:04:59 INFO 142: usage data length 106809
2020-07-22 15:04:59 INFO 143: topics data length 60558
2020-07-22 15:04:59 INFO 149: b2b2c students 1451
2020-07-22 15:04:59 INFO 150: b2c students 18130
2020-07-22 15:04:59 INFO 151: b2b students 87228 (not processing now)
2020-07-22 15:04:59 INFO 281: {'i-05c386f4337843b9e': 'ec2-3-7-74-211.ap-south-1.compute.amazonaws.com'}
2020-07-22 15:11:32 INFO 347: no_usage_b2b2c_students 445
2020-07-22 15:11:32 INFO 348: not_done_b2b2c_students 0
2020-07-22 15:11:32 INFO 349: done b2b2c students 1006
2020-07-22 15:11:33 INFO 347: no_usage_b2c_students 16706
2020-07-22 15:11:33 INFO 348: not_done_b2c_students 0
2020-07-22 15:11:33 INFO 349: done b2c students 1424
2020-07-22 15:11:33 INFO 366: students 0
2020-07-22 15:11:34 INFO 376: The whole thing took: 9.01 min
2020-07-22 15:14:32 INFO 215: week start date 2020-07-10
2020-07-22 15:14:34 INFO 267: ['i-0cac0ed211111e75e']
2020-07-22 15:16:34 INFO 50: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-22 15:16:35 INFO 65: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 15:16:37 INFO 78: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-10'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-22 15:16:44 INFO 87: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-10' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 15:16:47 INFO 97: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-10'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-10' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-16') )
2020-07-22 15:16:52 INFO 141: Total students 106809
2020-07-22 15:16:52 INFO 142: usage data length 106809
2020-07-22 15:16:52 INFO 143: topics data length 60558
2020-07-22 15:16:52 INFO 149: b2b2c students 1451
2020-07-22 15:16:52 INFO 150: b2c students 18130
2020-07-22 15:16:52 INFO 151: b2b students 87228 (not processing now)
2020-07-22 15:16:53 INFO 281: {'i-0cac0ed211111e75e': 'ec2-3-7-251-99.ap-south-1.compute.amazonaws.com'}
2020-07-22 15:23:31 INFO 347: no_usage_b2b2c_students 445
2020-07-22 15:23:31 INFO 348: not_done_b2b2c_students 0
2020-07-22 15:23:31 INFO 349: done b2b2c students 1006
2020-07-22 15:23:31 INFO 347: no_usage_b2c_students 16706
2020-07-22 15:23:31 INFO 348: not_done_b2c_students 0
2020-07-22 15:23:31 INFO 349: done b2c students 1424
2020-07-22 15:23:32 INFO 366: students 19581
2020-07-22 15:23:33 INFO 376: The whole thing took: 9.0 min
2020-07-23 11:51:38 INFO 289: month  June
2020-07-23 11:51:39 INFO 338: ['i-09de4cf74e9664f43']
2020-07-23 11:53:39 INFO 57: SELECT  A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-06-01' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-23 11:53:54 INFO 72: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-23 11:54:23 INFO 85: SELECT MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-06-01'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-06-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-23 11:56:02 INFO 96: select oldupid as upid,childname,oldschoolcode,class,gender,monthly_correct_ques,monthly_login_days,monthly_total_ques,monthly_accuracy,monthly_usage_time from msm_usage_monthly where calendar_month ='6' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-23 11:56:04 INFO 106: select oldupid as upid,class,contentid,contenttype,monthly_ques_attempts,progress_of_first_attempt,monthly_accuracy from msm_moduleprogress_monthly where calendar_month =6  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and oldschoolcode=4156961
    
2020-07-23 11:56:14 INFO 116: select old_upid as upid,class,contentid,contentattemptnumber,mapped_ttid,accuracy from msm_moduleprogress_attemptid where ((startdate>='2020-06-01' and startdate <='2020-06-30') or (enddate>='2020-06-01' and enddate <='2020-06-30')) and  contenttype='concept'   
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-06-01' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-06-30') ) and old_school_code=4156961
    
2020-07-23 11:56:23 INFO 194: Total students 20
2020-07-23 11:56:23 INFO 195: Distinct student and class count 20
2020-07-23 11:56:23 INFO 196: usage data length 20
2020-07-23 11:56:23 INFO 197: topics data length 77
2020-07-23 11:56:23 INFO 198: concepts data length 153
2020-07-23 11:56:23 INFO 204: b2b2c distinct student and class count 0
2020-07-23 11:56:23 INFO 205: b2c distinct student and class count 0
2020-07-23 11:56:23 INFO 206: b2b distinct student and class count 20 n
2020-07-23 11:56:23 INFO 208: no of splits 1
2020-07-23 11:56:25 INFO 352: {'i-09de4cf74e9664f43': 'ec2-3-7-74-24.ap-south-1.compute.amazonaws.com'}
2020-07-23 11:57:18 INFO 418: no_usage b2b2c students 0
2020-07-23 11:57:18 INFO 419: not_done b2b2c students 0
2020-07-23 11:57:18 INFO 420: done b2b2c students 0
2020-07-23 11:57:18 INFO 418: no_usage b2b students 4
2020-07-23 11:57:18 INFO 419: not_done b2b students 0
2020-07-23 11:57:18 INFO 420: done b2b students 16
2020-07-23 11:57:18 INFO 418: no_usage b2c students 0
2020-07-23 11:57:18 INFO 419: not_done b2c students 0
2020-07-23 11:57:18 INFO 420: done b2c students 0
2020-07-23 11:57:19 INFO 433: The whole thing took: 5.68 min
2020-07-28 09:32:29 INFO 224: week start date 2020-07-10
2020-07-28 09:32:30 INFO 276: ['i-0176ff1bb0741b4d5']
2020-07-28 09:34:30 INFO 51: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-28 09:34:31 ERROR 395: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 583, in connect
    **kwargs)
  File "/home/anaconda3/lib/python3.7/socket.py", line 727, in create_connection
    raise err
  File "/home/anaconda3/lib/python3.7/socket.py", line 716, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction3.py", line 279, in <module>
    split_and_save(no_of_instances)
  File "extraction3.py", line 106, in split_and_save
    b2b2c_users = get_b2b2c(last_fri_str,thur_str)
  File "extraction3.py", line 52, in get_b2b2c
    livecon_r()
  File "extraction3.py", line 34, in livecon_r
    mysql = pymysql.connect(host=db_config.staging_ip, user=db_config.username_staging, password=db_config.pwd_staging, db="educatio_adepts")
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 630, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '122.248.246.221' ([Errno 111] Connection refused)")
2020-07-28 19:10:24 INFO 224: week start date 2020-07-10
2020-07-28 19:10:26 INFO 276: ['i-064030539bd63f8b1']
2020-07-28 19:12:26 INFO 51: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-10' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-16')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-28 19:12:36 ERROR 395: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 583, in connect
    **kwargs)
  File "/home/anaconda3/lib/python3.7/socket.py", line 727, in create_connection
    raise err
  File "/home/anaconda3/lib/python3.7/socket.py", line 716, in create_connection
    sock.connect(sa)
socket.timeout: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction3.py", line 279, in <module>
    split_and_save(no_of_instances)
  File "extraction3.py", line 106, in split_and_save
    b2b2c_users = get_b2b2c(last_fri_str,thur_str)
  File "extraction3.py", line 52, in get_b2b2c
    livecon_r()
  File "extraction3.py", line 34, in livecon_r
    mysql = pymysql.connect(host=db_config.staging_ip, user=db_config.username_staging, password=db_config.pwd_staging, db="educatio_adepts")
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 630, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '10.0.6.154' (timed out)")
2020-07-28 19:13:47 INFO 224: week start date 2020-07-24
2020-07-28 19:13:48 INFO 276: ['i-0e0d1fbdca17db65c']
2020-07-28 19:15:05 INFO 224: week start date 2020-07-17
2020-07-28 19:15:06 INFO 276: ['i-01ddfc3bdaf83513c']
2020-07-28 19:17:06 INFO 51: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-17' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-28 19:17:17 ERROR 395: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 583, in connect
    **kwargs)
  File "/home/anaconda3/lib/python3.7/socket.py", line 727, in create_connection
    raise err
  File "/home/anaconda3/lib/python3.7/socket.py", line 716, in create_connection
    sock.connect(sa)
socket.timeout: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction3.py", line 279, in <module>
    split_and_save(no_of_instances)
  File "extraction3.py", line 106, in split_and_save
    b2b2c_users = get_b2b2c(last_fri_str,thur_str)
  File "extraction3.py", line 52, in get_b2b2c
    livecon_r()
  File "extraction3.py", line 34, in livecon_r
    mysql = pymysql.connect(host=db_config.staging_ip, user=db_config.username_staging, password=db_config.pwd_staging, db="educatio_adepts")
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 630, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '10.0.6.154' (timed out)")
2020-07-28 22:38:07 INFO 224: week start date 2020-07-17
2020-07-28 22:38:08 INFO 276: ['i-0caa72153133a9fb1']
2020-07-28 22:40:08 INFO 51: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-17' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-28 22:40:19 ERROR 395: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 583, in connect
    **kwargs)
  File "/home/anaconda3/lib/python3.7/socket.py", line 727, in create_connection
    raise err
  File "/home/anaconda3/lib/python3.7/socket.py", line 716, in create_connection
    sock.connect(sa)
socket.timeout: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction3.py", line 279, in <module>
    split_and_save(no_of_instances)
  File "extraction3.py", line 106, in split_and_save
    b2b2c_users = get_b2b2c(last_fri_str,thur_str)
  File "extraction3.py", line 52, in get_b2b2c
    livecon_r()
  File "extraction3.py", line 34, in livecon_r
    mysql = pymysql.connect(host=db_config.staging_ip, user=db_config.username_staging, password=db_config.pwd_staging, db="educatio_adepts")
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/home/anaconda3/lib/python3.7/site-packages/pymysql/connections.py", line 630, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on '10.0.6.154' (timed out)")
2020-07-30 13:24:39 INFO 224: week start date 2020-07-17
2020-07-30 13:24:40 INFO 276: ['i-0b5a99675b48aef74']
2020-07-30 13:25:49 INFO 224: week start date 2020-07-17
2020-07-30 13:25:50 INFO 276: ['i-0ff56abd93a0c8583']
2020-07-30 13:27:50 INFO 51: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-17' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-07-30 13:27:54 INFO 66: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-17'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-30 13:28:01 INFO 79: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-17'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-23')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-07-30 13:28:22 INFO 88: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-17' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-17' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-23') )
2020-07-30 13:28:24 INFO 98: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-17'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-17' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-23') )
2020-07-30 13:28:28 INFO 142: Total students 99911
2020-07-30 13:28:28 INFO 143: usage data length 99911
2020-07-30 13:28:28 INFO 144: topics data length 64240
2020-07-30 13:28:28 INFO 150: b2b2c students 1877
2020-07-30 13:28:28 INFO 151: b2c students 13447
2020-07-30 13:28:28 INFO 152: b2b students 184319 (not processing now)
2020-07-30 13:28:28 INFO 158: b2b2c students 1625
2020-07-30 13:28:28 INFO 159: b2c students 13421
2020-07-30 13:28:28 INFO 160: b2b students 84865 (not processing now)
2020-07-30 13:28:29 INFO 290: {'i-0ff56abd93a0c8583': 'ec2-13-235-58-244.ap-south-1.compute.amazonaws.com'}
2020-08-01 09:16:14 INFO 226: week start date 2020-07-24
2020-08-01 09:16:15 INFO 278: ['i-049b68ee882402f49']
2020-08-01 09:18:15 INFO 51: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-24' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-30')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-01 09:18:19 INFO 66: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-24'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-01 09:18:26 INFO 79: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-24'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-07-30')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-01 09:18:46 INFO 88: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-24' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-24' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-30') )
2020-08-01 09:18:49 INFO 98: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-24'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-24' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-07-30') )
2020-08-01 09:18:52 INFO 142: Total students 94292
2020-08-01 09:18:52 INFO 143: usage data length 94292
2020-08-01 09:18:52 INFO 144: topics data length 50307
2020-08-01 09:18:53 INFO 150: b2b2c students 2027
2020-08-01 09:18:53 INFO 151: b2c students 9837
2020-08-01 09:18:53 INFO 152: b2b students 188453 (not processing now)
2020-08-01 09:18:53 INFO 158: b2b2c students 1630
2020-08-01 09:18:53 INFO 159: b2c students 9177
2020-08-01 09:18:53 INFO 160: b2b students 83484 (not processing now)
2020-08-01 09:18:53 INFO 292: {'i-049b68ee882402f49': 'ec2-52-66-221-197.ap-south-1.compute.amazonaws.com'}
2020-08-01 09:38:54 INFO 343: no_usage_b2b2c_students 0
2020-08-01 09:38:54 INFO 344: not_done_b2b2c_students 0
2020-08-01 09:38:54 INFO 345: done b2b2c students 0
2020-08-01 09:38:55 INFO 343: no_usage_b2c_students 0
2020-08-01 09:38:55 INFO 344: not_done_b2c_students 0
2020-08-01 09:38:55 INFO 345: done b2c students 0
2020-08-01 09:38:55 INFO 362: students 0
2020-08-01 09:38:55 ERROR 426: extraction failed due to 
Traceback (most recent call last):
  File "extraction3.py", line 364, in <module>
    df4['week_str_date']=pd.to_datetime(df4['week_str_date'],'YYYY-MM-DD')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 778, in to_datetime
    values = convert_listlike(arg._values, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 463, in _convert_listlike_datetimes
    allow_object=True,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py", line 1963, in objects_to_datetime64ns
    assert errors in ["raise", "ignore", "coerce"]
AssertionError
2020-08-01 10:19:55 INFO 51: week start date 2020-07-24
2020-08-01 10:19:55 ERROR 209: extraction failed due to 
Traceback (most recent call last):
  File "extraction_helper.py", line 56, in <module>
    no_of_instances=int(sys.argv[1])
IndexError: list index out of range
2020-08-01 10:21:10 INFO 51: week start date 2020-07-24
2020-08-01 10:21:10 INFO 62: ['i-049b68ee882402f49']
2020-08-01 10:21:10 INFO 75: {'i-049b68ee882402f49': 'ec2-52-66-221-197.ap-south-1.compute.amazonaws.com'}
2020-08-01 10:35:33 INFO 51: week start date 2020-07-24
2020-08-01 10:35:33 INFO 62: ['i-049b68ee882402f49']
2020-08-01 10:35:33 INFO 75: {'i-049b68ee882402f49': 'ec2-52-66-221-197.ap-south-1.compute.amazonaws.com'}
2020-08-01 10:55:14 INFO 126: no_usage_b2b2c_students 0
2020-08-01 10:55:14 INFO 127: not_done_b2b2c_students 0
2020-08-01 10:55:14 INFO 128: done b2b2c students 0
2020-08-01 10:55:14 INFO 126: no_usage_b2c_students 0
2020-08-01 10:55:14 INFO 127: not_done_b2c_students 0
2020-08-01 10:55:14 INFO 128: done b2c students 0
2020-08-01 10:55:14 INFO 145: students 0
2020-08-01 10:55:14 ERROR 209: extraction failed due to 
Traceback (most recent call last):
  File "extraction_helper.py", line 147, in <module>
    df4['week_str_date']=pd.to_datetime(df4['week_str_date'],'YYYY-MM-DD')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 778, in to_datetime
    values = convert_listlike(arg._values, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 463, in _convert_listlike_datetimes
    allow_object=True,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py", line 1963, in objects_to_datetime64ns
    assert errors in ["raise", "ignore", "coerce"]
AssertionError
2020-08-01 11:00:00 INFO 51: week start date 2020-07-24
2020-08-01 11:00:00 INFO 62: ['i-049b68ee882402f49']
2020-08-01 11:00:00 INFO 75: {'i-049b68ee882402f49': 'ec2-52-66-221-197.ap-south-1.compute.amazonaws.com'}
2020-08-01 11:00:00 INFO 126: no_usage_b2b2c_students 583
2020-08-01 11:00:00 INFO 127: not_done_b2b2c_students 0
2020-08-01 11:00:00 INFO 128: done b2b2c students 1047
2020-08-01 11:00:01 INFO 126: no_usage_b2c_students 8525
2020-08-01 11:00:01 INFO 127: not_done_b2c_students 0
2020-08-01 11:00:01 INFO 128: done b2c students 652
2020-08-01 11:00:01 INFO 145: students 10807
2020-08-01 11:00:01 ERROR 209: extraction failed due to 
Traceback (most recent call last):
  File "extraction_helper.py", line 147, in <module>
    df4['week_str_date']=pd.to_datetime(df4['week_str_date'],'YYYY-MM-DD')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 774, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 156, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 463, in _convert_listlike_datetimes
    allow_object=True,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py", line 1963, in objects_to_datetime64ns
    assert errors in ["raise", "ignore", "coerce"]
AssertionError
2020-08-01 11:12:05 INFO 51: week start date 2020-07-24
2020-08-01 11:12:05 INFO 62: ['i-049b68ee882402f49']
2020-08-01 11:12:05 INFO 75: {'i-049b68ee882402f49': 'ec2-52-66-221-197.ap-south-1.compute.amazonaws.com'}
2020-08-01 11:16:31 INFO 126: no_usage_b2b2c_students 583
2020-08-01 11:16:31 INFO 127: not_done_b2b2c_students 0
2020-08-01 11:16:31 INFO 128: done b2b2c students 1047
2020-08-01 11:16:31 INFO 126: no_usage_b2c_students 8525
2020-08-01 11:16:31 INFO 127: not_done_b2c_students 0
2020-08-01 11:16:31 INFO 128: done b2c students 652
2020-08-01 11:16:32 INFO 145: students 10807
2020-08-01 11:16:32 ERROR 211: extraction failed due to 
Traceback (most recent call last):
  File "extraction_helper.py", line 149, in <module>
    df4['week_str_date']=pd.to_datetime(df4['week_str_date'],'YYYY-MM-DD')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 774, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 156, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 463, in _convert_listlike_datetimes
    allow_object=True,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py", line 1963, in objects_to_datetime64ns
    assert errors in ["raise", "ignore", "coerce"]
AssertionError
2020-08-01 11:21:37 INFO 51: week start date 2020-07-24
2020-08-01 11:21:37 INFO 62: ['i-049b68ee882402f49']
2020-08-01 11:21:37 INFO 75: {'i-049b68ee882402f49': 'ec2-52-66-221-197.ap-south-1.compute.amazonaws.com'}
2020-08-01 11:26:02 INFO 126: no_usage_b2b2c_students 583
2020-08-01 11:26:02 INFO 127: not_done_b2b2c_students 0
2020-08-01 11:26:02 INFO 128: done b2b2c students 1047
2020-08-01 11:26:03 INFO 126: no_usage_b2c_students 8525
2020-08-01 11:26:03 INFO 127: not_done_b2c_students 0
2020-08-01 11:26:03 INFO 128: done b2c students 652
2020-08-01 11:26:03 INFO 145: students 10807
2020-08-01 11:26:03 ERROR 211: extraction failed due to 
Traceback (most recent call last):
  File "extraction_helper.py", line 149, in <module>
    df4['week_str_date']=pd.to_datetime(df4['week_str_date'],'DD-MM-YYYY')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 774, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 156, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 463, in _convert_listlike_datetimes
    allow_object=True,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py", line 1963, in objects_to_datetime64ns
    assert errors in ["raise", "ignore", "coerce"]
AssertionError
2020-08-03 10:59:31 INFO 51: week start date 2020-07-31
2020-08-03 10:59:31 ERROR 211: extraction failed due to 
Traceback (most recent call last):
  File "extraction_helper.py", line 56, in <module>
    no_of_instances=int(sys.argv[1])
IndexError: list index out of range
2020-08-03 11:00:15 INFO 51: week start date 2020-07-31
2020-08-03 11:00:15 INFO 62: ['i-049b68ee882402f49']
2020-08-03 11:00:15 INFO 75: {}
2020-08-03 11:00:15 INFO 126: no_usage_b2b2c_students 583
2020-08-03 11:00:15 INFO 127: not_done_b2b2c_students 0
2020-08-03 11:00:15 INFO 128: done b2b2c students 1047
2020-08-03 11:00:16 INFO 126: no_usage_b2c_students 8525
2020-08-03 11:00:16 INFO 127: not_done_b2c_students 0
2020-08-03 11:00:16 INFO 128: done b2c students 652
2020-08-03 11:00:16 INFO 145: students 10807
2020-08-03 11:00:16 ERROR 211: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 448, in _convert_listlike_datetimes
    values, tz = conversion.datetime_to_datetime64(arg)
  File "pandas/_libs/tslibs/conversion.pyx", line 200, in pandas._libs.tslibs.conversion.datetime_to_datetime64
TypeError: Unrecognized value type: <class 'str'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction_helper.py", line 149, in <module>
    df4['week_str_date']=pd.to_datetime(df4['week_str_date'],format='YYYY-MM-DD')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 774, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 156, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 451, in _convert_listlike_datetimes
    raise e
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 416, in _convert_listlike_datetimes
    arg, format, exact=exact, errors=errors
  File "pandas/_libs/tslibs/strptime.pyx", line 142, in pandas._libs.tslibs.strptime.array_strptime
ValueError: time data '2020-07-31' does not match format 'YYYY-MM-DD' (match)
2020-08-03 11:02:19 INFO 51: week start date 2020-07-31
2020-08-03 11:02:19 INFO 62: ['i-049b68ee882402f49']
2020-08-03 11:02:19 INFO 75: {}
2020-08-03 11:02:20 INFO 126: no_usage_b2b2c_students 583
2020-08-03 11:02:20 INFO 127: not_done_b2b2c_students 0
2020-08-03 11:02:20 INFO 128: done b2b2c students 1047
2020-08-03 11:02:20 INFO 126: no_usage_b2c_students 8525
2020-08-03 11:02:20 INFO 127: not_done_b2c_students 0
2020-08-03 11:02:20 INFO 128: done b2c students 652
2020-08-03 11:02:20 INFO 145: students 10807
2020-08-03 11:02:20 ERROR 211: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 448, in _convert_listlike_datetimes
    values, tz = conversion.datetime_to_datetime64(arg)
  File "pandas/_libs/tslibs/conversion.pyx", line 200, in pandas._libs.tslibs.conversion.datetime_to_datetime64
TypeError: Unrecognized value type: <class 'str'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction_helper.py", line 149, in <module>
    df4['week_str_date']=pd.to_datetime(df4['week_str_date'],format='yyyy-mm-dd')
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 774, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 156, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 451, in _convert_listlike_datetimes
    raise e
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 416, in _convert_listlike_datetimes
    arg, format, exact=exact, errors=errors
  File "pandas/_libs/tslibs/strptime.pyx", line 142, in pandas._libs.tslibs.strptime.array_strptime
ValueError: time data '2020-07-31' does not match format 'yyyy-mm-dd' (match)
2020-08-03 11:03:53 INFO 51: week start date 2020-07-31
2020-08-03 11:03:53 INFO 62: ['i-049b68ee882402f49']
2020-08-03 11:03:53 INFO 75: {}
2020-08-03 11:03:53 INFO 126: no_usage_b2b2c_students 583
2020-08-03 11:03:53 INFO 127: not_done_b2b2c_students 0
2020-08-03 11:03:53 INFO 128: done b2b2c students 1047
2020-08-03 11:03:54 INFO 126: no_usage_b2c_students 8525
2020-08-03 11:03:54 INFO 127: not_done_b2c_students 0
2020-08-03 11:03:54 INFO 128: done b2c students 652
2020-08-03 11:03:54 INFO 145: students 10807
2020-08-03 11:03:55 INFO 163: The whole thing took: 0.04 min
2020-08-03 11:03:59 ERROR 211: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   Unmatched number of columns between table and file. Table columns: 4, Data columns: 5, File name: https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet?&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AS
  query:     1478270
  location:  dory_util.cpp:939
  process:   __padb__ [pid=16001]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "extraction_helper.py", line 205, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   Unmatched number of columns between table and file. Table columns: 4, Data columns: 5, File name: https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet?&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AS
  query:     1478270
  location:  dory_util.cpp:939
  process:   __padb__ [pid=16001]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-08-03 11:26:25 INFO 51: week start date 2020-07-31
2020-08-03 11:26:25 INFO 62: ['i-049b68ee882402f49']
2020-08-03 11:26:25 INFO 75: {}
2020-08-03 11:26:26 INFO 126: no_usage_b2b2c_students 583
2020-08-03 11:26:26 INFO 127: not_done_b2b2c_students 0
2020-08-03 11:26:26 INFO 128: done b2b2c students 1047
2020-08-03 11:26:26 INFO 126: no_usage_b2c_students 8525
2020-08-03 11:26:26 INFO 127: not_done_b2c_students 0
2020-08-03 11:26:26 INFO 128: done b2c students 652
2020-08-03 11:26:27 INFO 145: students 10807
2020-08-03 11:26:27 INFO 163: The whole thing took: 0.04 min
2020-08-03 11:26:32 INFO 209: Table loading took : 0.07 min
2020-08-08 09:48:27 INFO 226: week start date 2020-07-31
2020-08-08 09:48:28 INFO 278: ['i-09da394f4eab468a5']
2020-08-08 09:50:28 INFO 51: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-31' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-08 09:50:33 INFO 66: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-08 09:50:40 INFO 79: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-08 09:51:04 INFO 88: select oldupid as upid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-31' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-08 09:51:07 INFO 98: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-31'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-08 09:51:19 INFO 142: Total students 82352
2020-08-08 09:51:19 INFO 143: usage data length 82352
2020-08-08 09:51:19 INFO 144: topics data length 51077
2020-08-08 09:51:20 INFO 150: b2b2c students 2194
2020-08-08 09:51:20 INFO 151: b2c students 6935
2020-08-08 09:51:20 INFO 152: b2b students 167910 (not processing now)
2020-08-08 09:51:20 INFO 158: b2b2c students 1640
2020-08-08 09:51:20 INFO 159: b2c students 5296
2020-08-08 09:51:20 INFO 160: b2b students 75416 (not processing now)
2020-08-08 09:51:20 INFO 292: {'i-09da394f4eab468a5': 'ec2-13-235-65-55.ap-south-1.compute.amazonaws.com'}
2020-08-08 09:55:53 INFO 351: no_usage_b2b2c_students 0
2020-08-08 09:55:53 INFO 352: not_done_b2b2c_students 0
2020-08-08 09:55:53 INFO 353: done b2b2c students 0
2020-08-08 09:55:54 INFO 351: no_usage_b2c_students 0
2020-08-08 09:55:54 INFO 352: not_done_b2c_students 0
2020-08-08 09:55:54 INFO 353: done b2c students 0
2020-08-08 09:55:54 INFO 370: students 0
2020-08-08 09:55:55 INFO 386: The whole thing took: 7.46 min
2020-08-08 09:56:00 ERROR 434: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet.category'. Column type: VAR
  query:     1644643
  location:  dory_util.cpp:939
  process:   __padb__ [pid=2049]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "extraction3.py", line 428, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet.category'. Column type: VAR
  query:     1644643
  location:  dory_util.cpp:939
  process:   __padb__ [pid=2049]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-marketingdata/parentReport_weekly_2020_07_31/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-08-08 10:12:29 INFO 51: week start date 2020-07-31
2020-08-08 10:12:29 INFO 62: ['i-09da394f4eab468a5']
2020-08-08 10:12:29 INFO 75: {'i-09da394f4eab468a5': 'ec2-13-235-65-55.ap-south-1.compute.amazonaws.com'}
2020-08-08 10:12:30 INFO 135: no_usage_b2b2c_students 595
2020-08-08 10:12:30 INFO 136: not_done_b2b2c_students 0
2020-08-08 10:12:30 INFO 137: done b2b2c students 1045
2020-08-08 10:12:31 INFO 135: no_usage_b2c_students 4768
2020-08-08 10:12:31 INFO 136: not_done_b2c_students 0
2020-08-08 10:12:31 INFO 137: done b2c students 528
2020-08-08 10:12:32 INFO 154: students 6936
2020-08-08 10:12:32 INFO 172: The whole thing took: 0.05 min
2020-08-08 10:12:35 INFO 218: Table loading took : 0.04 min
2020-08-13 12:26:34 INFO 259: week start date 2020-08-07
2020-08-13 12:26:35 INFO 311: ['i-0bc3b81114729ed80']
2020-08-13 12:28:35 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-07' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-13 12:28:50 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 12:28:53 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 12:29:13 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-07' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-13 12:29:20 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-07'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-13 12:29:23 ERROR 468: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.ProgrammingError: syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extraction4.py", line 314, in <module>
    split_and_save(no_of_instances)
  File "extraction4.py", line 150, in split_and_save
    topic_name_1 = pd.read_sql(query,redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select  contentid,contentname from msm_topic_flow where contentid in ()': syntax error at or near ")"
LINE 1: ...tentid,contentname from msm_topic_flow where contentid in ()
                                                                      ^

2020-08-13 12:34:06 INFO 259: week start date 2020-07-31
2020-08-13 12:34:07 INFO 311: ['i-0d4c49e2af27afcbf']
2020-08-13 12:36:07 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-31' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-13 12:36:11 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 12:36:17 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 12:36:40 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-31' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 12:36:46 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-31'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 12:36:54 INFO 161: Total students 82566
2020-08-13 12:36:54 INFO 162: usage data length 82566
2020-08-13 12:36:54 INFO 163: topics data length 51094
2020-08-13 12:36:54 INFO 164: super_df data length 655
2020-08-13 12:36:54 INFO 175: super b2b2c students 33
2020-08-13 12:36:54 INFO 176: super b2c students 621
2020-08-13 12:36:54 INFO 177: super b2b students 0 (not processing now)
2020-08-13 12:36:54 INFO 179: b2b2c students 2238
2020-08-13 12:36:54 INFO 180: b2c students 6934
2020-08-13 12:36:54 INFO 181: b2b students 169102 (not processing now)
2020-08-13 12:36:55 INFO 187: b2b2c students 1646
2020-08-13 12:36:55 INFO 188: b2c students 5292
2020-08-13 12:36:55 INFO 189: b2b students 75628 (not processing now)
2020-08-13 12:36:55 INFO 325: {'i-0d4c49e2af27afcbf': 'ec2-13-234-7-175.ap-south-1.compute.amazonaws.com'}
2020-08-13 12:37:02 INFO 385: no_usage_b2b2c_students 0
2020-08-13 12:37:02 INFO 386: not_done_b2b2c_students 0
2020-08-13 12:37:02 INFO 387: done b2b2c students 0
2020-08-13 12:37:03 INFO 385: no_usage_b2c_students 0
2020-08-13 12:37:03 INFO 386: not_done_b2c_students 0
2020-08-13 12:37:03 INFO 387: done b2c students 0
2020-08-13 12:37:03 INFO 404: students 0
2020-08-13 12:37:04 INFO 420: The whole thing took: 2.96 min
2020-08-13 12:37:04 INFO 466: Table loading took : 0.0 min
2020-08-13 13:23:56 INFO 259: week start date 2020-07-31
2020-08-13 13:23:57 INFO 311: ['i-0a6ae6c6f9c5e62fb']
2020-08-13 13:25:57 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-31' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-13 13:26:02 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 13:26:09 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 13:26:29 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-31' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 13:26:33 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-31'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 13:26:41 INFO 161: Total students 82566
2020-08-13 13:26:41 INFO 162: usage data length 82566
2020-08-13 13:26:41 INFO 163: topics data length 51094
2020-08-13 13:26:41 INFO 164: super_df data length 655
2020-08-13 13:26:41 INFO 175: super b2b2c students 33
2020-08-13 13:26:41 INFO 176: super b2c students 621
2020-08-13 13:26:41 INFO 177: super b2b students 0 (not processing now)
2020-08-13 13:26:41 INFO 179: b2b2c students 2238
2020-08-13 13:26:41 INFO 180: b2c students 6934
2020-08-13 13:26:41 INFO 181: b2b students 169102 (not processing now)
2020-08-13 13:26:41 INFO 187: b2b2c students 1646
2020-08-13 13:26:41 INFO 188: b2c students 5292
2020-08-13 13:26:41 INFO 189: b2b students 75628 (not processing now)
2020-08-13 13:26:42 INFO 325: {'i-0a6ae6c6f9c5e62fb': 'ec2-15-207-104-213.ap-south-1.compute.amazonaws.com'}
2020-08-13 13:26:52 INFO 385: no_usage_b2b2c_students 0
2020-08-13 13:26:52 INFO 386: not_done_b2b2c_students 0
2020-08-13 13:26:52 INFO 387: done b2b2c students 0
2020-08-13 13:26:53 INFO 385: no_usage_b2c_students 0
2020-08-13 13:26:53 INFO 386: not_done_b2c_students 0
2020-08-13 13:26:53 INFO 387: done b2c students 0
2020-08-13 13:26:53 INFO 404: students 0
2020-08-13 13:26:54 INFO 420: The whole thing took: 2.96 min
2020-08-13 13:26:54 INFO 466: Table loading took : 0.0 min
2020-08-13 13:32:50 INFO 259: week start date 2020-07-31
2020-08-13 13:32:51 INFO 311: ['i-031372b26d7ce30a8']
2020-08-13 13:34:52 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-31' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-13 13:34:54 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 13:34:58 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 13:35:20 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-31' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 13:35:23 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-31'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 13:35:31 INFO 161: Total students 82566
2020-08-13 13:35:31 INFO 162: usage data length 82566
2020-08-13 13:35:31 INFO 163: topics data length 51094
2020-08-13 13:35:31 INFO 164: super_df data length 655
2020-08-13 13:35:31 INFO 175: super b2b2c students 33
2020-08-13 13:35:31 INFO 176: super b2c students 621
2020-08-13 13:35:31 INFO 177: super b2b students 0 (not processing now)
2020-08-13 13:35:31 INFO 179: b2b2c students 2238
2020-08-13 13:35:31 INFO 180: b2c students 6934
2020-08-13 13:35:31 INFO 181: b2b students 169102 (not processing now)
2020-08-13 13:35:32 INFO 187: b2b2c students 1646
2020-08-13 13:35:32 INFO 188: b2c students 5292
2020-08-13 13:35:32 INFO 189: b2b students 75628 (not processing now)
2020-08-13 13:35:32 INFO 325: {'i-031372b26d7ce30a8': 'ec2-52-66-228-235.ap-south-1.compute.amazonaws.com'}
2020-08-13 13:36:38 INFO 385: no_usage_b2b2c_students 598
2020-08-13 13:36:38 INFO 386: not_done_b2b2c_students 1048
2020-08-13 13:36:38 INFO 387: done b2b2c students 0
2020-08-13 13:36:39 INFO 385: no_usage_b2c_students 0
2020-08-13 13:36:39 INFO 386: not_done_b2c_students 0
2020-08-13 13:36:39 INFO 387: done b2c students 0
2020-08-13 13:36:39 INFO 404: students 1646
2020-08-13 13:36:40 INFO 420: The whole thing took: 3.82 min
2020-08-13 13:36:40 INFO 466: Table loading took : 0.0 min
2020-08-13 14:30:46 INFO 259: week start date 2020-07-31
2020-08-13 14:30:47 INFO 313: ['i-0ae39059a8eae6fae']
2020-08-13 14:32:47 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-07-31' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-13 14:32:52 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 14:32:59 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-07-31'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-06')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-13 14:33:19 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-07-31' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 14:33:23 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-07-31'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-07-31' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-06') )
2020-08-13 14:33:31 INFO 161: Total students 82566
2020-08-13 14:33:31 INFO 162: usage data length 82566
2020-08-13 14:33:31 INFO 163: topics data length 51094
2020-08-13 14:33:31 INFO 164: super_df data length 655
2020-08-13 14:33:31 INFO 175: super b2b2c students 33
2020-08-13 14:33:31 INFO 176: super b2c students 621
2020-08-13 14:33:31 INFO 177: super b2b students 0 (not processing now)
2020-08-13 14:33:31 INFO 179: b2b2c students 2238
2020-08-13 14:33:31 INFO 180: b2c students 6934
2020-08-13 14:33:31 INFO 181: b2b students 169108 (not processing now)
2020-08-13 14:33:31 INFO 187: b2b2c students 1646
2020-08-13 14:33:31 INFO 188: b2c students 5292
2020-08-13 14:33:31 INFO 189: b2b students 75628 (not processing now)
2020-08-13 14:33:32 INFO 327: {'i-0ae39059a8eae6fae': 'ec2-15-207-119-96.ap-south-1.compute.amazonaws.com'}
2020-08-13 14:34:51 INFO 387: no_usage_b2b2c_students 0
2020-08-13 14:34:51 INFO 388: not_done_b2b2c_students 0
2020-08-13 14:34:51 INFO 389: done b2b2c students 0
2020-08-13 14:34:52 INFO 387: no_usage_b2c_students 0
2020-08-13 14:34:52 INFO 388: not_done_b2c_students 0
2020-08-13 14:34:52 INFO 389: done b2c students 0
2020-08-13 14:34:52 INFO 406: students 0
2020-08-13 14:34:53 INFO 422: The whole thing took: 4.11 min
2020-08-13 14:34:53 INFO 468: Table loading took : 0.0 min
2020-08-15 09:45:33 INFO 263: week start date 2020-08-07
2020-08-15 09:45:34 INFO 317: ['i-0054d4ecaaa6264e9']
2020-08-15 09:47:34 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-07' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-15 09:47:40 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 09:47:46 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 09:48:07 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-07' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 09:48:20 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-07'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 09:48:41 INFO 161: Total students 76432
2020-08-15 09:48:41 INFO 162: usage data length 76432
2020-08-15 09:48:41 INFO 163: topics data length 47004
2020-08-15 09:48:41 INFO 164: super_df data length 202
2020-08-15 09:48:41 INFO 175: super b2b2c students 7
2020-08-15 09:48:41 INFO 176: super b2c students 194
2020-08-15 09:48:41 INFO 177: super b2b students 1 (not processing now)
2020-08-15 09:48:41 INFO 179: b2b2c students 2308
2020-08-15 09:48:41 INFO 180: b2c students 5101
2020-08-15 09:48:41 INFO 181: b2b students 154012 (not processing now)
2020-08-15 09:48:42 INFO 187: b2b2c students 2098
2020-08-15 09:48:42 INFO 188: b2c students 4186
2020-08-15 09:48:42 INFO 189: b2b students 70147 (not processing now)
2020-08-15 09:48:42 INFO 331: {'i-0054d4ecaaa6264e9': 'ec2-52-66-232-19.ap-south-1.compute.amazonaws.com'}
2020-08-15 09:49:08 INFO 393: no_usage_b2b2c_students 0
2020-08-15 09:49:08 INFO 394: not_done_b2b2c_students 0
2020-08-15 09:49:08 INFO 395: done b2b2c students 0
2020-08-15 09:49:08 INFO 393: no_usage_b2c_students 0
2020-08-15 09:49:08 INFO 394: not_done_b2c_students 0
2020-08-15 09:49:08 INFO 395: done b2c students 0
2020-08-15 09:49:09 INFO 412: students 0
2020-08-15 09:49:09 INFO 428: The whole thing took: 3.6 min
2020-08-15 09:49:23 ERROR 476: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet.category'. Column type: VAR
  query:     1858522
  location:  dory_util.cpp:948
  process:   __padb__ [pid=26888]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "extraction4.py", line 470, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet.category'. Column type: VAR
  query:     1858522
  location:  dory_util.cpp:948
  process:   __padb__ [pid=26888]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-08-15 09:56:01 INFO 263: week start date 2020-08-07
2020-08-15 09:56:02 INFO 317: ['i-0a399e5a67dd2af5a']
2020-08-15 09:58:02 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-07' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-15 09:58:03 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 09:58:04 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 09:58:09 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-07' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 09:58:11 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-07'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 09:58:16 INFO 161: Total students 76432
2020-08-15 09:58:16 INFO 162: usage data length 76432
2020-08-15 09:58:16 INFO 163: topics data length 47004
2020-08-15 09:58:16 INFO 164: super_df data length 202
2020-08-15 09:58:16 INFO 175: super b2b2c students 7
2020-08-15 09:58:16 INFO 176: super b2c students 194
2020-08-15 09:58:16 INFO 177: super b2b students 1 (not processing now)
2020-08-15 09:58:16 INFO 179: b2b2c students 2308
2020-08-15 09:58:16 INFO 180: b2c students 5101
2020-08-15 09:58:16 INFO 181: b2b students 154012 (not processing now)
2020-08-15 09:58:17 INFO 187: b2b2c students 2098
2020-08-15 09:58:17 INFO 188: b2c students 4186
2020-08-15 09:58:17 INFO 189: b2b students 70147 (not processing now)
2020-08-15 09:58:17 INFO 331: {'i-0a399e5a67dd2af5a': 'ec2-15-207-121-119.ap-south-1.compute.amazonaws.com'}
2020-08-15 09:58:36 INFO 393: no_usage_b2b2c_students 0
2020-08-15 09:58:36 INFO 394: not_done_b2b2c_students 0
2020-08-15 09:58:36 INFO 395: done b2b2c students 0
2020-08-15 09:58:36 INFO 393: no_usage_b2c_students 0
2020-08-15 09:58:36 INFO 394: not_done_b2c_students 0
2020-08-15 09:58:36 INFO 395: done b2c students 0
2020-08-15 09:58:37 INFO 412: students 0
2020-08-15 09:58:37 INFO 428: The whole thing took: 2.61 min
2020-08-15 09:58:40 ERROR 476: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet.category'. Column type: VAR
  query:     1858713
  location:  dory_util.cpp:948
  process:   __padb__ [pid=26891]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "extraction4.py", line 470, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet.category'. Column type: VAR
  query:     1858713
  location:  dory_util.cpp:948
  process:   __padb__ [pid=26891]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-marketingdata/parentReport_weekly_2020_08_07/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-08-15 09:59:53 INFO 263: week start date 2020-08-07
2020-08-15 09:59:54 INFO 317: ['i-0234b9030205ab187']
2020-08-15 10:01:54 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-07' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-15 10:01:54 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 10:01:56 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 10:02:00 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-07' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 10:02:02 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-07'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 10:02:07 INFO 161: Total students 76432
2020-08-15 10:02:07 INFO 162: usage data length 76432
2020-08-15 10:02:07 INFO 163: topics data length 47004
2020-08-15 10:02:07 INFO 164: super_df data length 202
2020-08-15 10:02:07 INFO 175: super b2b2c students 7
2020-08-15 10:02:07 INFO 176: super b2c students 194
2020-08-15 10:02:07 INFO 177: super b2b students 1 (not processing now)
2020-08-15 10:02:07 INFO 179: b2b2c students 2308
2020-08-15 10:02:07 INFO 180: b2c students 5101
2020-08-15 10:02:07 INFO 181: b2b students 154012 (not processing now)
2020-08-15 10:02:08 INFO 187: b2b2c students 2098
2020-08-15 10:02:08 INFO 188: b2c students 4186
2020-08-15 10:02:08 INFO 189: b2b students 70147 (not processing now)
2020-08-15 10:02:08 INFO 331: {'i-0234b9030205ab187': 'ec2-3-7-250-45.ap-south-1.compute.amazonaws.com'}
2020-08-15 10:07:22 INFO 393: no_usage_b2b2c_students 740
2020-08-15 10:07:22 INFO 394: not_done_b2b2c_students 0
2020-08-15 10:07:22 INFO 395: done b2b2c students 1358
2020-08-15 10:07:23 INFO 393: no_usage_b2c_students 3633
2020-08-15 10:07:23 INFO 394: not_done_b2c_students 0
2020-08-15 10:07:23 INFO 395: done b2c students 553
2020-08-15 10:07:23 INFO 412: students 6284
2020-08-15 10:07:24 INFO 428: The whole thing took: 7.52 min
2020-08-15 10:07:36 INFO 474: Table loading took : 0.21 min
2020-08-15 10:22:11 INFO 263: week start date 2020-08-07
2020-08-15 10:22:12 INFO 317: ['i-0c2e7ebfab4477f14']
2020-08-15 10:24:13 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-07' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-15 10:24:13 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 10:24:15 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-15 10:24:24 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-07' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 10:24:26 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-07'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-08-15 10:24:31 INFO 161: Total students 76432
2020-08-15 10:24:31 INFO 162: usage data length 76432
2020-08-15 10:24:31 INFO 163: topics data length 47004
2020-08-15 10:24:31 INFO 164: super_df data length 202
2020-08-15 10:24:31 INFO 175: super b2b2c students 7
2020-08-15 10:24:31 INFO 176: super b2c students 194
2020-08-15 10:24:31 INFO 177: super b2b students 1 (not processing now)
2020-08-15 10:24:31 INFO 179: b2b2c students 2308
2020-08-15 10:24:31 INFO 180: b2c students 5101
2020-08-15 10:24:31 INFO 181: b2b students 154012 (not processing now)
2020-08-15 10:24:32 INFO 187: b2b2c students 2098
2020-08-15 10:24:32 INFO 188: b2c students 4186
2020-08-15 10:24:32 INFO 189: b2b students 70147 (not processing now)
2020-08-15 10:24:32 INFO 331: {'i-0c2e7ebfab4477f14': 'ec2-15-207-120-166.ap-south-1.compute.amazonaws.com'}
2020-08-15 10:29:44 INFO 393: no_usage_b2b2c_students 740
2020-08-15 10:29:44 INFO 394: not_done_b2b2c_students 0
2020-08-15 10:29:44 INFO 395: done b2b2c students 1358
2020-08-15 10:29:45 INFO 393: no_usage_b2c_students 3633
2020-08-15 10:29:45 INFO 394: not_done_b2c_students 0
2020-08-15 10:29:45 INFO 395: done b2c students 553
2020-08-15 10:29:45 INFO 412: students 6284
2020-08-15 10:29:46 INFO 428: The whole thing took: 7.58 min
2020-08-15 10:29:49 INFO 474: Table loading took : 0.04 min
2020-08-18 14:11:58 INFO 223: week start date 2020-08-14
2020-08-18 14:12:00 INFO 272: ['i-04ff1909c90538ac3']
2020-08-18 14:14:00 INFO 38: select userID as upid,startdate, enddate,userName,childClass,childName,gender from userDetails where category='STUDENT' and enabled in (1,0) and userID not in (select userID from userCategory) and enddate>='2020-08-14' and startDate<='2020-08-20' and (childEmail is not null or parentEmail is not null or contactno_cel is not null) 
2020-08-18 14:14:04 ERROR 409: extraction failed due to 
Traceback (most recent call last):
  File "pandas/_libs/tslib.pyx", line 610, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslibs/parsing.pyx", line 225, in pandas._libs.tslibs.parsing.parse_datetime_string
  File "/home/anaconda3/lib/python3.7/site-packages/dateutil/parser/_parser.py", line 1358, in parse
    return DEFAULTPARSER.parse(timestr, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/dateutil/parser/_parser.py", line 654, in parse
    ret = self._build_naive(res, default)
  File "/home/anaconda3/lib/python3.7/site-packages/dateutil/parser/_parser.py", line 1229, in _build_naive
    naive = default.replace(**repl)
ValueError: year 0 is out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mse_extraction.py", line 275, in <module>
    split_and_save(no_of_instances)
  File "mse_extraction.py", line 73, in split_and_save
    u_df['startdate']= pd.to_datetime(u_df['startdate'])
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/util/_decorators.py", line 208, in wrapper
    return func(*args, **kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 774, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 156, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, True, format)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 463, in _convert_listlike_datetimes
    allow_object=True,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/core/arrays/datetimes.py", line 1975, in objects_to_datetime64ns
    require_iso8601=require_iso8601,
  File "pandas/_libs/tslib.pyx", line 465, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 688, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 826, in pandas._libs.tslib.array_to_datetime_object
  File "pandas/_libs/tslib.pyx", line 617, in pandas._libs.tslib.array_to_datetime
TypeError: invalid string coercion to datetime
2020-08-22 10:15:32 INFO 253: week start date 2020-08-14
2020-08-22 10:15:34 INFO 307: ['i-0c1e4f9e867be2796']
2020-08-22 10:17:34 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-14' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-20')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-22 10:17:46 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-14'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-20')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-22 10:17:50 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-14'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-20')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-22 10:18:09 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-14' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-14' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-20') )
2020-08-22 10:18:18 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-14'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-14' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-20') )
2020-08-22 10:18:38 INFO 161: Total students 69968
2020-08-22 10:18:38 INFO 162: usage data length 69968
2020-08-22 10:18:38 INFO 163: topics data length 52842
2020-08-22 10:18:38 INFO 164: super_df data length 289
2020-08-22 10:18:39 INFO 175: super b2b2c students 7
2020-08-22 10:18:39 INFO 176: super b2c students 281
2020-08-22 10:18:39 INFO 177: super b2b students 1 (not processing now)
2020-08-22 10:18:39 INFO 179: b2b2c students 2416
2020-08-22 10:18:39 INFO 180: b2c students 4030
2020-08-22 10:18:39 INFO 181: b2b students 139791 (not processing now)
2020-08-22 10:18:39 INFO 187: b2b2c students 2110
2020-08-22 10:18:39 INFO 188: b2c students 2358
2020-08-22 10:18:39 INFO 189: b2b students 65500 (not processing now)
2020-08-22 10:18:39 INFO 321: {'i-0c1e4f9e867be2796': 'ec2-52-66-225-156.ap-south-1.compute.amazonaws.com'}
2020-08-22 10:18:46 INFO 383: no_usage_b2b2c_students 0
2020-08-22 10:18:46 INFO 384: not_done_b2b2c_students 0
2020-08-22 10:18:46 INFO 385: done b2b2c students 0
2020-08-22 10:18:46 INFO 383: no_usage_b2c_students 0
2020-08-22 10:18:46 INFO 384: not_done_b2c_students 0
2020-08-22 10:18:46 INFO 385: done b2c students 0
2020-08-22 10:18:47 INFO 402: students 0
2020-08-22 10:18:47 INFO 418: The whole thing took: 3.25 min
2020-08-22 10:18:59 ERROR 466: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_08_14/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_08_14/students.parquet.category'. Column type: VAR
  query:     2022760
  location:  dory_util.cpp:948
  process:   __padb__ [pid=14799]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "extraction4.py", line 460, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_08_14/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_08_14/students.parquet.category'. Column type: VAR
  query:     2022760
  location:  dory_util.cpp:948
  process:   __padb__ [pid=14799]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-marketingdata/parentReport_weekly_2020_08_14/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-08-22 10:24:45 INFO 253: week start date 2020-08-14
2020-08-22 10:24:46 INFO 307: ['i-0908b0fd452d985ac']
2020-08-22 10:26:46 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-14' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-20')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-22 10:26:49 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-14'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-20')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-22 10:26:51 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-14'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-20')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-22 10:26:56 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-14' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-14' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-20') )
2020-08-22 10:26:58 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-14'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-14' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-20') )
2020-08-22 10:27:03 INFO 161: Total students 69968
2020-08-22 10:27:03 INFO 162: usage data length 69968
2020-08-22 10:27:03 INFO 163: topics data length 52842
2020-08-22 10:27:03 INFO 164: super_df data length 289
2020-08-22 10:27:03 INFO 175: super b2b2c students 7
2020-08-22 10:27:03 INFO 176: super b2c students 281
2020-08-22 10:27:03 INFO 177: super b2b students 1 (not processing now)
2020-08-22 10:27:03 INFO 179: b2b2c students 2416
2020-08-22 10:27:03 INFO 180: b2c students 4030
2020-08-22 10:27:03 INFO 181: b2b students 139791 (not processing now)
2020-08-22 10:27:03 INFO 187: b2b2c students 2110
2020-08-22 10:27:03 INFO 188: b2c students 2358
2020-08-22 10:27:03 INFO 189: b2b students 65500 (not processing now)
2020-08-22 10:27:04 INFO 321: {'i-0908b0fd452d985ac': 'ec2-52-66-220-124.ap-south-1.compute.amazonaws.com'}
2020-08-22 10:32:25 INFO 383: no_usage_b2b2c_students 776
2020-08-22 10:32:25 INFO 384: not_done_b2b2c_students 0
2020-08-22 10:32:25 INFO 385: done b2b2c students 1334
2020-08-22 10:32:26 INFO 383: no_usage_b2c_students 1926
2020-08-22 10:32:26 INFO 384: not_done_b2c_students 0
2020-08-22 10:32:26 INFO 385: done b2c students 432
2020-08-22 10:32:26 INFO 402: students 4468
2020-08-22 10:32:27 INFO 418: The whole thing took: 7.7 min
2020-08-22 10:32:38 INFO 464: Table loading took : 0.19 min
2020-08-28 20:42:03 INFO 253: week start date 2020-08-21
2020-08-28 20:42:04 INFO 307: ['i-0c8012cd99151ee0f']
2020-08-28 20:44:04 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-21' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-27')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-08-28 20:44:17 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-21'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-27')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-28 20:44:21 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-21'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-27')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-08-28 20:44:40 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-21' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-21' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-27') )
2020-08-28 20:44:42 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-21'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-21' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-27') )
2020-08-28 20:44:48 INFO 161: Total students 68222
2020-08-28 20:44:48 INFO 162: usage data length 68222
2020-08-28 20:44:48 INFO 163: topics data length 52887
2020-08-28 20:44:48 INFO 164: super_df data length 233
2020-08-28 20:44:48 INFO 175: super b2b2c students 9
2020-08-28 20:44:48 INFO 176: super b2c students 222
2020-08-28 20:44:48 INFO 177: super b2b students 1 (not processing now)
2020-08-28 20:44:48 INFO 179: b2b2c students 2522
2020-08-28 20:44:48 INFO 180: b2c students 3924
2020-08-28 20:44:48 INFO 181: b2b students 138591 (not processing now)
2020-08-28 20:44:48 INFO 187: b2b2c students 2130
2020-08-28 20:44:48 INFO 188: b2c students 1479
2020-08-28 20:44:48 INFO 189: b2b students 64613 (not processing now)
2020-08-28 20:44:49 INFO 321: {'i-0c8012cd99151ee0f': 'ec2-15-207-236-196.ap-south-1.compute.amazonaws.com'}
2020-08-28 20:49:58 INFO 383: no_usage_b2b2c_students 866
2020-08-28 20:49:58 INFO 384: not_done_b2b2c_students 0
2020-08-28 20:49:58 INFO 385: done b2b2c students 1264
2020-08-28 20:49:58 INFO 383: no_usage_b2c_students 1115
2020-08-28 20:49:58 INFO 384: not_done_b2c_students 0
2020-08-28 20:49:58 INFO 385: done b2c students 364
2020-08-28 20:49:59 INFO 402: students 3609
2020-08-28 20:49:59 INFO 418: The whole thing took: 7.94 min
2020-08-28 20:50:02 INFO 464: Table loading took : 0.04 min
2020-09-01 16:11:24 INFO 253: week start date 2020-08-07
2020-09-01 16:11:26 INFO 307: ['i-002e8301400009ca1']
2020-09-01 16:13:26 INFO 53: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-07' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-09-01 16:13:29 INFO 68: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-01 16:13:31 INFO 81: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-07'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-08-13')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-01 16:13:36 INFO 90: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-07' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-09-01 16:13:44 INFO 100: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-07'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-07' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-08-13') )
2020-09-01 16:13:56 INFO 161: Total students 77123
2020-09-01 16:13:56 INFO 162: usage data length 77123
2020-09-01 16:13:56 INFO 163: topics data length 52645
2020-09-01 16:13:56 INFO 164: super_df data length 202
2020-09-01 16:13:56 INFO 175: super b2b2c students 12
2020-09-01 16:13:56 INFO 176: super b2c students 187
2020-09-01 16:13:56 INFO 177: super b2b students 1 (not processing now)
2020-09-01 16:13:56 INFO 179: b2b2c students 2394
2020-09-01 16:13:56 INFO 180: b2c students 5083
2020-09-01 16:13:56 INFO 181: b2b students 155372 (not processing now)
2020-09-01 16:13:56 INFO 187: b2b2c students 2118
2020-09-01 16:13:56 INFO 188: b2c students 4159
2020-09-01 16:13:56 INFO 189: b2b students 70845 (not processing now)
2020-09-01 16:13:57 INFO 321: {'i-002e8301400009ca1': 'ec2-52-66-219-221.ap-south-1.compute.amazonaws.com'}
2020-09-01 16:19:40 INFO 383: no_usage_b2b2c_students 753
2020-09-01 16:19:40 INFO 384: not_done_b2b2c_students 0
2020-09-01 16:19:40 INFO 385: done b2b2c students 1365
2020-09-01 16:19:41 INFO 383: no_usage_b2c_students 3626
2020-09-01 16:19:41 INFO 384: not_done_b2c_students 0
2020-09-01 16:19:41 INFO 385: done b2c students 533
2020-09-01 16:19:41 INFO 402: students 6277
2020-09-01 16:19:42 INFO 418: The whole thing took: 8.3 min
2020-09-01 16:19:44 INFO 464: Table loading took : 0.03 min
2020-09-05 09:35:43 INFO 296: week start date 2020-08-28
2020-09-05 09:35:45 INFO 350: ['i-01321c8e60b76f971']
2020-09-05 09:37:45 INFO 96: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-08-28' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-03')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-09-05 09:37:58 INFO 111: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-28'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-03')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-05 09:38:02 INFO 124: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-08-28'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-03')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-05 09:38:20 INFO 133: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-08-28' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-28' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-03') )
2020-09-05 09:38:31 INFO 143: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-08-28'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-08-28' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-03') )
2020-09-05 09:38:59 INFO 204: Total students 68283
2020-09-05 09:38:59 INFO 205: usage data length 68283
2020-09-05 09:38:59 INFO 206: topics data length 55674
2020-09-05 09:38:59 INFO 207: super_df data length 238
2020-09-05 09:38:59 INFO 218: super b2b2c students 6
2020-09-05 09:38:59 INFO 219: super b2c students 232
2020-09-05 09:38:59 INFO 220: super b2b students 0 (not processing now)
2020-09-05 09:38:59 INFO 222: b2b2c students 2607
2020-09-05 09:38:59 INFO 223: b2c students 3685
2020-09-05 09:38:59 INFO 224: b2b students 138972 (not processing now)
2020-09-05 09:38:59 INFO 230: b2b2c students 2142
2020-09-05 09:38:59 INFO 231: b2c students 1346
2020-09-05 09:38:59 INFO 232: b2b students 64795 (not processing now)
2020-09-05 09:39:00 INFO 364: {'i-01321c8e60b76f971': 'ec2-3-7-59-202.ap-south-1.compute.amazonaws.com'}
2020-09-05 09:43:46 INFO 426: no_usage_b2b2c_students 915
2020-09-05 09:43:46 INFO 427: not_done_b2b2c_students 0
2020-09-05 09:43:46 INFO 428: done b2b2c students 1227
2020-09-05 09:43:47 INFO 426: no_usage_b2c_students 1020
2020-09-05 09:43:47 INFO 427: not_done_b2c_students 0
2020-09-05 09:43:47 INFO 428: done b2c students 326
2020-09-05 09:43:47 INFO 445: students 3488
2020-09-05 09:43:48 INFO 461: The whole thing took: 8.07 min
2020-09-05 09:43:50 INFO 68: Email sent!
2020-09-05 09:44:13 INFO 528: Table loading took : 0.37 min
2020-09-12 11:00:03 INFO 296: week start date 2020-09-04
2020-09-12 11:00:04 INFO 350: ['i-0cff8fe9b9268dc71']
2020-09-12 11:02:04 INFO 96: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-04' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-10')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-09-12 11:02:19 INFO 111: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-04'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-10')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-12 11:02:23 INFO 124: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-04'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-10')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-12 11:02:42 INFO 133: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-09-04' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-04' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-10') )
2020-09-12 11:02:49 INFO 143: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-09-04'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-04' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-10') )
2020-09-12 11:03:08 INFO 204: Total students 61669
2020-09-12 11:03:08 INFO 205: usage data length 61669
2020-09-12 11:03:08 INFO 206: topics data length 51890
2020-09-12 11:03:08 INFO 207: super_df data length 214
2020-09-12 11:03:08 INFO 218: super b2b2c students 13
2020-09-12 11:03:08 INFO 219: super b2c students 201
2020-09-12 11:03:08 INFO 220: super b2b students 0 (not processing now)
2020-09-12 11:03:08 INFO 222: b2b2c students 2699
2020-09-12 11:03:08 INFO 223: b2c students 3408
2020-09-12 11:03:08 INFO 224: b2b students 125235 (not processing now)
2020-09-12 11:03:09 INFO 230: b2b2c students 2152
2020-09-12 11:03:09 INFO 231: b2c students 1308
2020-09-12 11:03:09 INFO 232: b2b students 58208 (not processing now)
2020-09-12 11:03:09 INFO 364: {'i-0cff8fe9b9268dc71': 'ec2-3-6-7-250.ap-south-1.compute.amazonaws.com'}
2020-09-12 11:07:54 INFO 426: no_usage_b2b2c_students 980
2020-09-12 11:07:54 INFO 427: not_done_b2b2c_students 0
2020-09-12 11:07:54 INFO 428: done b2b2c students 1172
2020-09-12 11:07:55 INFO 426: no_usage_b2c_students 996
2020-09-12 11:07:55 INFO 427: not_done_b2c_students 0
2020-09-12 11:07:55 INFO 428: done b2c students 312
2020-09-12 11:07:55 INFO 445: students 3460
2020-09-12 11:07:56 INFO 461: The whole thing took: 7.89 min
2020-09-12 11:07:59 INFO 68: Email sent!
2020-09-12 11:08:13 INFO 528: Table loading took : 0.24 min
2020-09-19 11:00:02 INFO 298: week start date 2020-09-11
2020-09-19 11:00:03 INFO 352: ['i-066f44bd7cc9a63ff']
2020-09-19 11:02:03 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-11' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-17')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-09-19 11:02:17 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-11'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-17')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-19 11:02:21 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-11'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-17')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-19 11:02:40 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-09-11' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-11' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-17') )
2020-09-19 11:02:43 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-09-11'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-11' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-17') )
2020-09-19 11:03:04 INFO 206: Total students 64678
2020-09-19 11:03:04 INFO 207: usage data length 64678
2020-09-19 11:03:04 INFO 208: topics data length 53533
2020-09-19 11:03:04 INFO 209: super_df data length 185
2020-09-19 11:03:04 INFO 220: super b2b2c students 0
2020-09-19 11:03:04 INFO 221: super b2c students 184
2020-09-19 11:03:04 INFO 222: super b2b students 0 (not processing now)
2020-09-19 11:03:04 INFO 224: b2b2c students 2745
2020-09-19 11:03:04 INFO 225: b2c students 2954
2020-09-19 11:03:04 INFO 226: b2b students 125068 (not processing now)
2020-09-19 11:03:04 INFO 232: b2b2c students 2639
2020-09-19 11:03:04 INFO 233: b2c students 2938
2020-09-19 11:03:04 INFO 234: b2b students 59096 (not processing now)
2020-09-19 11:03:04 INFO 366: {'i-066f44bd7cc9a63ff': 'ec2-13-234-10-15.ap-south-1.compute.amazonaws.com'}
2020-09-19 11:09:26 INFO 428: no_usage_b2b2c_students 1091
2020-09-19 11:09:26 INFO 429: not_done_b2b2c_students 0
2020-09-19 11:09:26 INFO 430: done b2b2c students 1548
2020-09-19 11:09:27 INFO 428: no_usage_b2c_students 2254
2020-09-19 11:09:27 INFO 429: not_done_b2c_students 0
2020-09-19 11:09:27 INFO 430: done b2c students 684
2020-09-19 11:09:28 INFO 447: students 5577
2020-09-19 11:09:28 INFO 463: The whole thing took: 9.45 min
2020-09-19 11:09:31 INFO 68: Email sent!
2020-09-19 11:09:34 INFO 530: Table loading took : 0.05 min
2020-09-26 11:00:02 INFO 298: week start date 2020-09-18
2020-09-26 11:00:03 INFO 352: ['i-0f4d1cd01d4977f94']
2020-09-26 11:02:03 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-18' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-09-26 11:02:16 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-26 11:02:19 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-26 11:02:36 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-09-18' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-09-26 11:02:47 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-09-18'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-09-26 11:02:55 ERROR 532: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
psycopg2.ProgrammingError: syntax error at or near ")"
LINE 1: ...nd as contentname from msm_topic_flow  where contentid in ()
                                                                      ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ei_datascience/Parent_reports/extraction4.py", line 355, in <module>
    split_and_save(no_of_instances)
  File "/home/ei_datascience/Parent_reports/extraction4.py", line 194, in split_and_save
    topic_name_1 = pd.read_sql(query,redshift)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 410, in read_sql
    chunksize=chunksize,
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1645, in read_query
    cursor = self.execute(*args)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1610, in execute
    raise_with_traceback(ex)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/compat/__init__.py", line 47, in raise_with_traceback
    raise exc.with_traceback(traceback)
  File "/home/anaconda3/lib/python3.7/site-packages/pandas/io/sql.py", line 1595, in execute
    cur.execute(*args)
pandas.io.sql.DatabaseError: Execution failed on sql 'select contentid,case when type='worksheet' then 'Work Sheet - '||contentname else contentname end as contentname from msm_topic_flow  where contentid in ()': syntax error at or near ")"
LINE 1: ...nd as contentname from msm_topic_flow  where contentid in ()
                                                                      ^

2020-09-26 13:05:25 INFO 298: week start date 2020-09-18
2020-09-26 13:05:26 INFO 352: ['i-06a37d491c5a6ec6c']
2020-09-26 13:07:26 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-18' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-09-26 13:07:39 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-26 13:07:43 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-26 13:08:01 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-09-18' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-09-26 13:08:04 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-09-18'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-09-26 13:08:28 INFO 206: Total students 65294
2020-09-26 13:08:28 INFO 207: usage data length 65294
2020-09-26 13:08:28 INFO 208: topics data length 48211
2020-09-26 13:08:28 INFO 209: super_df data length 226
2020-09-26 13:08:29 INFO 220: super b2b2c students 3
2020-09-26 13:08:29 INFO 221: super b2c students 223
2020-09-26 13:08:29 INFO 222: super b2b students 0 (not processing now)
2020-09-26 13:08:29 INFO 224: b2b2c students 2798
2020-09-26 13:08:29 INFO 225: b2c students 2950
2020-09-26 13:08:29 INFO 226: b2b students 125317 (not processing now)
2020-09-26 13:08:29 INFO 232: b2b2c students 2692
2020-09-26 13:08:29 INFO 233: b2c students 2933
2020-09-26 13:08:29 INFO 234: b2b students 59666 (not processing now)
2020-09-26 13:08:29 INFO 366: {'i-06a37d491c5a6ec6c': 'ec2-3-6-150-233.ap-south-1.compute.amazonaws.com'}
2020-09-26 13:08:46 INFO 428: no_usage_b2b2c_students 0
2020-09-26 13:08:46 INFO 429: not_done_b2b2c_students 0
2020-09-26 13:08:46 INFO 430: done b2b2c students 0
2020-09-26 13:08:46 INFO 428: no_usage_b2c_students 0
2020-09-26 13:08:46 INFO 429: not_done_b2c_students 0
2020-09-26 13:08:46 INFO 430: done b2c students 0
2020-09-26 13:08:47 INFO 447: students 0
2020-09-26 13:08:47 INFO 463: The whole thing took: 3.37 min
2020-09-26 13:08:50 INFO 68: Email sent!
2020-09-26 13:09:03 ERROR 532: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_09_18/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_09_18/students.parquet.category'. Column type: VAR
  query:     2883801
  location:  dory_util.cpp:941
  process:   fetchtask_thread [pid=29386]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "extraction4.py", line 526, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-marketingdata/parentReport_weekly_2020_09_18/students.parquet  has an incompatible Parquet schema for column 's3://ei-marketingdata/parentReport_weekly_2020_09_18/students.parquet.category'. Column type: VAR
  query:     2883801
  location:  dory_util.cpp:941
  process:   fetchtask_thread [pid=29386]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-marketingdata/parentReport_weekly_2020_09_18/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-09-26 13:19:54 INFO 298: week start date 2020-09-18
2020-09-26 13:19:55 INFO 352: ['i-0b7a00f69069d3c39']
2020-09-26 13:21:55 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-18' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-09-26 13:22:02 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-26 13:22:05 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-09-26 13:22:21 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-09-18' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-09-26 13:22:23 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-09-18'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-09-26 13:22:31 INFO 206: Total students 65294
2020-09-26 13:22:31 INFO 207: usage data length 65294
2020-09-26 13:22:31 INFO 208: topics data length 48211
2020-09-26 13:22:31 INFO 209: super_df data length 226
2020-09-26 13:22:31 INFO 220: super b2b2c students 3
2020-09-26 13:22:31 INFO 221: super b2c students 223
2020-09-26 13:22:31 INFO 222: super b2b students 0 (not processing now)
2020-09-26 13:22:31 INFO 224: b2b2c students 2798
2020-09-26 13:22:31 INFO 225: b2c students 2950
2020-09-26 13:22:31 INFO 226: b2b students 125317 (not processing now)
2020-09-26 13:22:31 INFO 232: b2b2c students 2692
2020-09-26 13:22:31 INFO 233: b2c students 2933
2020-09-26 13:22:31 INFO 234: b2b students 59666 (not processing now)
2020-09-26 13:22:32 INFO 366: {'i-0b7a00f69069d3c39': 'ec2-13-235-54-18.ap-south-1.compute.amazonaws.com'}
2020-09-26 13:29:25 INFO 428: no_usage_b2b2c_students 1058
2020-09-26 13:29:25 INFO 429: not_done_b2b2c_students 0
2020-09-26 13:29:25 INFO 430: done b2b2c students 1634
2020-09-26 13:29:26 INFO 428: no_usage_b2c_students 2168
2020-09-26 13:29:26 INFO 429: not_done_b2c_students 0
2020-09-26 13:29:26 INFO 430: done b2c students 765
2020-09-26 13:29:26 INFO 447: students 5625
2020-09-26 13:29:27 INFO 463: The whole thing took: 9.55 min
2020-09-26 13:29:30 INFO 68: Email sent!
2020-09-26 13:29:42 INFO 530: Table loading took : 0.2 min
2020-10-01 12:13:15 INFO 327: week start date 2020-09-18
2020-10-01 12:13:16 INFO 381: ['i-035f87870fdb732b2']
2020-10-01 12:15:16 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-18' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-01 12:15:29 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:15:33 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:15:54 ERROR 561: extraction failed due to 
Traceback (most recent call last):
  File "extraction4.py", line 384, in <module>
    split_and_save(no_of_instances)
  File "extraction4.py", line 178, in split_and_save
    ms2_retail_users = pd.read_sql(query.format(week_st_date,week_en_date), adepts)
NameError: name 'week_st_date' is not defined
2020-10-01 12:20:19 INFO 327: week start date 2020-09-18
2020-10-01 12:20:20 INFO 381: ['i-0099cc7cdbebd6e38']
2020-10-01 12:22:20 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-18' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-01 12:22:25 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:22:28 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:22:42 INFO 187: b2b 125349
2020-10-01 12:22:42 INFO 188: b2c 2943
2020-10-01 12:22:42 INFO 189: b2b2c 2818
2020-10-01 12:22:42 ERROR 561: extraction failed due to 
Traceback (most recent call last):
  File "extraction4.py", line 384, in <module>
    split_and_save(no_of_instances)
  File "extraction4.py", line 191, in split_and_save
    b2_users = b2c_users + ms2_wrongly_tagged_users_list
TypeError: unsupported operand type(s) for +: 'set' and 'set'
2020-10-01 12:27:13 INFO 327: week start date 2020-09-18
2020-10-01 12:27:15 INFO 381: ['i-04369bd332080ec0a']
2020-10-01 12:29:15 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-18' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-01 12:29:26 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:29:30 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:29:49 INFO 187: b2b 125349
2020-10-01 12:29:49 INFO 188: b2c 2943
2020-10-01 12:29:49 INFO 189: b2b2c 2818
2020-10-01 12:29:49 INFO 194: wrong b2c 104
2020-10-01 12:29:49 INFO 197: b2b 125248
2020-10-01 12:29:49 INFO 198: b2c 2943
2020-10-01 12:29:49 INFO 199: b2b2c 2818
2020-10-01 12:29:49 ERROR 561: extraction failed due to 
Traceback (most recent call last):
  File "extraction4.py", line 384, in <module>
    split_and_save(no_of_instances)
  File "extraction4.py", line 201, in split_and_save
    logging.info('wrong b2c sample '+ str(ms2_wrongly_tagged_users_list[:6]))
TypeError: 'set' object is not subscriptable
2020-10-01 12:36:14 INFO 327: week start date 2020-09-18
2020-10-01 12:36:15 INFO 381: ['i-072b77e69d65f4942']
2020-10-01 12:38:15 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-18' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-01 12:38:28 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:38:32 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-18'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-09-24')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-01 12:38:52 INFO 187: b2b 125349
2020-10-01 12:38:52 INFO 188: b2c 2943
2020-10-01 12:38:52 INFO 189: b2b2c 2818
2020-10-01 12:38:52 INFO 194: wrong b2c 104
2020-10-01 12:38:52 INFO 197: b2b 125248
2020-10-01 12:38:52 INFO 198: b2c 3047
2020-10-01 12:38:52 INFO 199: b2b2c 2818
2020-10-01 12:38:52 INFO 201: wrong b2c sample {'1883844', '497017', '1091765', '1708989', '1708628', '631638', '1708927', '1350874', '991294', '1835917', '1617930', '776489', '1639959', '308728', '935042', '1834840', '567229', '1835607', '1350712', '1198764', '1835198', '1835613', '1834434', '1812370', '1771831', '1779051', '1834812', '619251', '59949', '1688848', '1552448', '832159', '479406', '1386745', '1680770', '1483418', '1587290', '1836201', '1691449', '480282', '957906', '544643', '1835199', '1300541', '1835606', '1836533', '1835794', '1835608', '265590', '1708966', '1385206', '1518275', '1288365', '1205090', '519561', '1386881', '1355694', '729842', '350028', '1835610', '388159', '1708920', '1708983', '492886', '1667685', '1471246', '961017', '776781', '749837', '1835285', '1836195', '1350720', '1316578', '610171', '1253747', '1835612', '939049', '1835331', '1543487', '1835303', '1835611', '1189541', '1721848', '1835330', '1812371', '1334950', '1721452', '915871', '1151306', '1774101', '745824', '730318', '631550', '1836377', '1835609', '1834535', '1136373', '1433039', '1781402', '1254878', '357229', '1783326', '1549130', '1834397'}
2020-10-01 12:38:52 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-09-18' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-10-01 12:39:00 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-09-18'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-18' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-09-24') )
2020-10-01 12:39:14 INFO 235: Total students 65437
2020-10-01 12:39:14 INFO 236: usage data length 65437
2020-10-01 12:39:14 INFO 237: topics data length 48274
2020-10-01 12:39:14 INFO 238: super_df data length 226
2020-10-01 12:39:14 INFO 249: super b2b2c students 3
2020-10-01 12:39:14 INFO 250: super b2c students 222
2020-10-01 12:39:14 INFO 251: super b2b students 0 (not processing now)
2020-10-01 12:39:14 INFO 253: b2b2c students 2818
2020-10-01 12:39:14 INFO 254: b2c students 3047
2020-10-01 12:39:14 INFO 255: b2b students 125248 (not processing now)
2020-10-01 12:39:14 INFO 261: b2b2c students 2699
2020-10-01 12:39:14 INFO 262: b2c students 3026
2020-10-01 12:39:14 INFO 263: b2b students 59709 (not processing now)
2020-10-01 12:39:15 INFO 395: {'i-072b77e69d65f4942': 'ec2-15-207-237-220.ap-south-1.compute.amazonaws.com'}
2020-10-01 12:43:59 INFO 457: no_usage_b2b2c_students 1065
2020-10-01 12:43:59 INFO 458: not_done_b2b2c_students 0
2020-10-01 12:43:59 INFO 459: done b2b2c students 1634
2020-10-01 12:44:00 INFO 457: no_usage_b2c_students 2243
2020-10-01 12:44:00 INFO 458: not_done_b2c_students 0
2020-10-01 12:44:00 INFO 459: done b2c students 783
2020-10-01 12:44:00 INFO 476: students 5725
2020-10-01 12:44:00 INFO 492: The whole thing took: 7.77 min
2020-10-01 12:44:03 INFO 68: Email sent!
2020-10-01 12:44:04 ERROR 561: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: S3ServiceException:The S3 bucket addressed by the query is in a different region from this cluster.,Status 301,Error PermanentRedirect,Rid 18E1FD441C0E121B,ExtRid +5ahqzE6UYhyfjM5N7/PyyDRohG13n6/gIgszrgZKoMIjFnSWnzY3fNpgPsHlHUtoSt4iBXUfgU=,CanRetry 1
DETAIL:  
  -----------------------------------------------
  error:  S3ServiceException:The S3 bucket addressed by the query is in a different region from this cluster.,Status 301,Error PermanentRedirect,Rid 18E1FD441C0E121B,ExtRid +5ahqzE6UYhyfjM5N7/PyyDRohG13n6/gIgszrgZKoMIjFnSWnzY3fNpgPsHlHUtoSt4iBXUfgU=,CanRetry 1
  code:      8001
  context:   Listing bucket=ei-marketingdata prefix=parentReport_weekly_2020_09_18/students.parquet
  query:     3281824
  location:  scan_range_manager.cpp:671
  process:   padbmaster [pid=12064]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "extraction4.py", line 555, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) S3ServiceException:The S3 bucket addressed by the query is in a different region from this cluster.,Status 301,Error PermanentRedirect,Rid 18E1FD441C0E121B,ExtRid +5ahqzE6UYhyfjM5N7/PyyDRohG13n6/gIgszrgZKoMIjFnSWnzY3fNpgPsHlHUtoSt4iBXUfgU=,CanRetry 1
DETAIL:  
  -----------------------------------------------
  error:  S3ServiceException:The S3 bucket addressed by the query is in a different region from this cluster.,Status 301,Error PermanentRedirect,Rid 18E1FD441C0E121B,ExtRid +5ahqzE6UYhyfjM5N7/PyyDRohG13n6/gIgszrgZKoMIjFnSWnzY3fNpgPsHlHUtoSt4iBXUfgU=,CanRetry 1
  code:      8001
  context:   Listing bucket=ei-marketingdata prefix=parentReport_weekly_2020_09_18/students.parquet
  query:     3281824
  location:  scan_range_manager.cpp:671
  process:   padbmaster [pid=12064]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-marketingdata/parentReport_weekly_2020_09_18/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-10-03 11:00:03 INFO 327: week start date 2020-09-25
2020-10-03 11:00:04 INFO 381: ['i-08dea0f17b1a34286']
2020-10-03 11:02:04 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-09-25' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-01')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-03 11:02:18 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-25'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-01')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-03 11:02:22 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-09-25'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-01')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-03 11:02:41 INFO 187: b2b 125167
2020-10-03 11:02:41 INFO 188: b2c 3042
2020-10-03 11:02:41 INFO 189: b2b2c 2841
2020-10-03 11:02:41 INFO 194: wrong b2c 102
2020-10-03 11:02:41 INFO 197: b2b 125067
2020-10-03 11:02:41 INFO 198: b2c 3144
2020-10-03 11:02:41 INFO 199: b2b2c 2841
2020-10-03 11:02:41 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-09-25' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-25' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-01') )
2020-10-03 11:02:45 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-09-25'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-09-25' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-01') )
2020-10-03 11:02:54 INFO 235: Total students 65714
2020-10-03 11:02:54 INFO 236: usage data length 65714
2020-10-03 11:02:54 INFO 237: topics data length 48620
2020-10-03 11:02:54 INFO 238: super_df data length 390
2020-10-03 11:02:54 INFO 249: super b2b2c students 0
2020-10-03 11:02:54 INFO 250: super b2c students 390
2020-10-03 11:02:54 INFO 251: super b2b students 0 (not processing now)
2020-10-03 11:02:54 INFO 253: b2b2c students 2841
2020-10-03 11:02:54 INFO 254: b2c students 3144
2020-10-03 11:02:54 INFO 255: b2b students 125067 (not processing now)
2020-10-03 11:02:54 INFO 261: b2b2c students 2739
2020-10-03 11:02:54 INFO 262: b2c students 3124
2020-10-03 11:02:54 INFO 263: b2b students 59847 (not processing now)
2020-10-03 11:02:54 INFO 395: {'i-08dea0f17b1a34286': 'ec2-65-0-54-227.ap-south-1.compute.amazonaws.com'}
2020-10-03 11:07:40 INFO 457: no_usage_b2b2c_students 1174
2020-10-03 11:07:40 INFO 458: not_done_b2b2c_students 0
2020-10-03 11:07:40 INFO 459: done b2b2c students 1565
2020-10-03 11:07:40 INFO 457: no_usage_b2c_students 2288
2020-10-03 11:07:40 INFO 458: not_done_b2c_students 0
2020-10-03 11:07:40 INFO 459: done b2c students 836
2020-10-03 11:07:40 INFO 476: students 5863
2020-10-03 11:07:41 ERROR 562: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/home/anaconda3/lib/python3.7/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/home/anaconda3/lib/python3.7/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/home/anaconda3/lib/python3.7/site-packages/s3transfer/tasks.py", line 126, in __call__
    return self._execute_main(kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/s3transfer/tasks.py", line 150, in _execute_main
    return_value = self._main(**kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/s3transfer/upload.py", line 692, in _main
    client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
  File "/home/anaconda3/lib/python3.7/site-packages/botocore/client.py", line 357, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/anaconda3/lib/python3.7/site-packages/botocore/client.py", line 661, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (AccessDenied) when calling the PutObject operation: Access Denied

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ei_datascience/Parent_reports/extraction4.py", line 490, in <module>
    s3.upload_file(local_file, bucket, s3_file,ExtraArgs={'ACL':'public-read'})
  File "/home/anaconda3/lib/python3.7/site-packages/boto3/s3/inject.py", line 131, in upload_file
    extra_args=ExtraArgs, callback=Callback)
  File "/home/anaconda3/lib/python3.7/site-packages/boto3/s3/transfer.py", line 287, in upload_file
    filename, '/'.join([bucket, key]), e))
boto3.exceptions.S3UploadFailedError: Failed to upload students.parquet to ei-pr-studentdata/parentReport_weekly_2020_09_25/students.parquet: An error occurred (AccessDenied) when calling the PutObject operation: Access Denied
2020-10-10 11:00:03 INFO 327: week start date 2020-10-02
2020-10-10 11:00:04 INFO 381: ['i-0215f47d976fba1e7']
2020-10-10 11:02:04 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-10-02' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-08')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-10 11:02:17 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-10-02'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-08')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-10 11:02:20 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-10-02'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-08')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-10 11:02:39 INFO 187: b2b 124346
2020-10-10 11:02:39 INFO 188: b2c 3062
2020-10-10 11:02:39 INFO 189: b2b2c 2910
2020-10-10 11:02:39 INFO 194: wrong b2c 96
2020-10-10 11:02:39 INFO 197: b2b 124255
2020-10-10 11:02:39 INFO 198: b2c 3158
2020-10-10 11:02:39 INFO 199: b2b2c 2910
2020-10-10 11:02:39 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-10-02' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-10-02' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-08') )
2020-10-10 11:02:40 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-10-02'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-10-02' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-08') )
2020-10-10 11:02:52 INFO 235: Total students 0
2020-10-10 11:02:52 INFO 236: usage data length 0
2020-10-10 11:02:52 INFO 237: topics data length 47048
2020-10-10 11:02:52 INFO 238: super_df data length 270
2020-10-10 11:02:52 INFO 249: super b2b2c students 13
2020-10-10 11:02:52 INFO 250: super b2c students 258
2020-10-10 11:02:52 INFO 251: super b2b students 0 (not processing now)
2020-10-10 11:02:52 INFO 253: b2b2c students 2910
2020-10-10 11:02:52 INFO 254: b2c students 3158
2020-10-10 11:02:52 INFO 255: b2b students 124255 (not processing now)
2020-10-10 11:02:53 INFO 261: b2b2c students 0
2020-10-10 11:02:53 INFO 262: b2c students 0
2020-10-10 11:02:53 INFO 263: b2b students 0 (not processing now)
2020-10-10 11:02:53 INFO 395: {'i-0215f47d976fba1e7': 'ec2-13-235-64-142.ap-south-1.compute.amazonaws.com'}
2020-10-10 11:03:58 INFO 457: no_usage_b2b2c_students 0
2020-10-10 11:03:58 INFO 458: not_done_b2b2c_students 0
2020-10-10 11:03:58 INFO 459: done b2b2c students 0
2020-10-10 11:03:58 INFO 457: no_usage_b2c_students 0
2020-10-10 11:03:58 INFO 458: not_done_b2c_students 0
2020-10-10 11:03:58 INFO 459: done b2c students 0
2020-10-10 11:03:58 INFO 476: students 0
2020-10-10 11:03:59 INFO 493: The whole thing took: 3.94 min
2020-10-10 11:04:02 INFO 68: Email sent!
2020-10-10 11:04:05 ERROR 562: extraction failed due to 
Traceback (most recent call last):
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
psycopg2.InternalError: Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-pr-studentdata/parentReport_weekly_2020_10_02/students.parquet  has an incompatible Parquet schema for column 's3://ei-pr-studentdata/parentReport_weekly_2020_10_02/students.parquet.category'. Column type: V
  query:     3530070
  location:  dory_util.cpp:941
  process:   fetchtask_thread [pid=3438]
  -----------------------------------------------



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ei_datascience/Parent_reports/extraction4.py", line 556, in <module>
    engine.execute(sql)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2166, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 982, in execute
    return self._execute_text(object_, multiparams, params)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1155, in _execute_text
    parameters,
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1466, in _handle_dbapi_exception
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 399, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 153, in reraise
    raise value.with_traceback(tb)
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1244, in _execute_context
    cursor, statement, parameters, context
  File "/home/anaconda3/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 550, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.InternalError: (psycopg2.InternalError) Spectrum Scan Error
DETAIL:  
  -----------------------------------------------
  error:  Spectrum Scan Error
  code:      15001
  context:   File 'https://s3.ap-southeast-1.amazonaws.com/ei-pr-studentdata/parentReport_weekly_2020_10_02/students.parquet  has an incompatible Parquet schema for column 's3://ei-pr-studentdata/parentReport_weekly_2020_10_02/students.parquet.category'. Column type: V
  query:     3530070
  location:  dory_util.cpp:941
  process:   fetchtask_thread [pid=3438]
  -----------------------------------------------


[SQL: 

    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs_stg(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date);


    COPY  weekly_parent_report_logs_stg
    FROM 's3://ei-pr-studentdata/parentReport_weekly_2020_10_02/students.parquet'
    IAM_ROLE 'arn:aws:iam::866998810058:role/myRedshiftRole'
    Format as parquet;


    CREATE TABLE IF NOT EXISTS weekly_parent_report_logs(
    category VARCHAR(100),oldupid int8,
    report_status VARCHAR(100),
    week_str_date date,
    lastModified datetime default sysdate);

    INSERT INTO "public"."weekly_parent_report_logs"
    (SELECT category,oldupid,report_status,trunc(week_str_date) as week_str_date
    FROM "public"."weekly_parent_report_logs_stg");
     
    DROP TABLE IF EXISTS weekly_parent_report_logs_stg;

    commit;
    ]
(Background on this error at: http://sqlalche.me/e/2j85)
2020-10-10 11:35:13 INFO 327: week start date 2020-10-02
2020-10-10 11:35:14 INFO 381: ['i-045fdd64076bdc866']
2020-10-10 11:37:14 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-10-02' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-08')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-10 11:37:28 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-10-02'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-08')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-10 11:37:32 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-10-02'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-08')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-10 11:37:50 INFO 187: b2b 124346
2020-10-10 11:37:50 INFO 188: b2c 3062
2020-10-10 11:37:50 INFO 189: b2b2c 2910
2020-10-10 11:37:50 INFO 194: wrong b2c 96
2020-10-10 11:37:50 INFO 197: b2b 124255
2020-10-10 11:37:50 INFO 198: b2c 3158
2020-10-10 11:37:50 INFO 199: b2b2c 2910
2020-10-10 11:37:50 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-10-02' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-10-02' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-08') )
2020-10-10 11:37:53 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-10-02'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-10-02' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-08') )
2020-10-10 11:38:00 INFO 235: Total students 65197
2020-10-10 11:38:00 INFO 236: usage data length 65197
2020-10-10 11:38:00 INFO 237: topics data length 47048
2020-10-10 11:38:00 INFO 238: super_df data length 270
2020-10-10 11:38:00 INFO 249: super b2b2c students 13
2020-10-10 11:38:00 INFO 250: super b2c students 258
2020-10-10 11:38:00 INFO 251: super b2b students 0 (not processing now)
2020-10-10 11:38:00 INFO 253: b2b2c students 2910
2020-10-10 11:38:00 INFO 254: b2c students 3158
2020-10-10 11:38:00 INFO 255: b2b students 124255 (not processing now)
2020-10-10 11:38:00 INFO 261: b2b2c students 2809
2020-10-10 11:38:00 INFO 262: b2c students 3137
2020-10-10 11:38:00 INFO 263: b2b students 59251 (not processing now)
2020-10-10 11:38:01 INFO 395: {'i-045fdd64076bdc866': 'ec2-15-207-105-87.ap-south-1.compute.amazonaws.com'}
2020-10-10 11:42:25 INFO 457: no_usage_b2b2c_students 1290
2020-10-10 11:42:25 INFO 458: not_done_b2b2c_students 0
2020-10-10 11:42:25 INFO 459: done b2b2c students 1519
2020-10-10 11:42:25 INFO 457: no_usage_b2c_students 2427
2020-10-10 11:42:25 INFO 458: not_done_b2c_students 0
2020-10-10 11:42:25 INFO 459: done b2c students 710
2020-10-10 11:42:25 INFO 476: students 5946
2020-10-10 11:42:26 INFO 493: The whole thing took: 7.21 min
2020-10-10 11:42:28 INFO 68: Email sent!
2020-10-10 11:42:31 INFO 560: Table loading took : 0.04 min
2020-10-17 11:00:03 INFO 327: week start date 2020-10-09
2020-10-17 11:00:04 INFO 381: ['i-0d0d56e88cbd588f6']
2020-10-17 11:02:04 INFO 97: SELECT distinct A.MS_userID
    FROM educatio_educat.common_user_details A, mapping.user_management_mapping B,
    educatio_adepts.adepts_registrationDetailsLog C WHERE A.id=B.oldID AND A.userName=C.username
    AND enddate>'2020-10-09' AND category='STUDENT' AND subCategory='School'
    AND A.MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-15')
    AND (A.childEmail is not null or A.additionalEmail is not null or A.contactno_cel is not null)
2020-10-17 11:02:17 INFO 112: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-10-09'
    AND category='STUDENT'
    AND subCategory='Individual'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-15')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-17 11:02:21 INFO 125: SELECT distinct MS_userID
    FROM educatio_educat.common_user_details
    WHERE enddate>='2020-10-09'
    AND category='STUDENT'
    AND subCategory='School'
    AND MS_userID not in (SELECT MS_userID from educatio_educat.common_user_details where startDate > '2020-10-15')
    AND (childEmail is not null or additionalEmail is not null or contactno_cel is not null)
2020-10-17 11:02:42 INFO 187: b2b 124013
2020-10-17 11:02:42 INFO 188: b2c 2875
2020-10-17 11:02:42 INFO 189: b2b2c 2926
2020-10-17 11:02:42 INFO 194: wrong b2c 92
2020-10-17 11:02:42 INFO 197: b2b 123927
2020-10-17 11:02:42 INFO 198: b2c 2967
2020-10-17 11:02:42 INFO 199: b2b2c 2926
2020-10-17 11:02:42 INFO 134: select oldupid as upid,upid as newupid,childname as child_name,class,gender,round(weekly_accuracy) as weekly_accuracy,weekly_total_ques as weekly_ques_attempts,weekly_correct_ques as weekly_correct_ques_attempts,usage_time_fri,usage_time_sat,usage_time_sun,usage_time_mon,usage_time_tue,usage_time_wed,usage_time_thu from msm_usage_weekly where week_start_date ='2020-10-09' 
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-10-09' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-15') )
2020-10-17 11:02:46 INFO 144: select oldupid as upid,contentid,weekly_correct_ques_attempts,weekly_ques_attempts,progress_of_first_attempt,round(weekly_accuracy*100) as weekly_accuracy from msm_moduleprogress_weekly where week_start_date ='2020-10-09'  
    and upid in (select upid from userdetails_dim where category='STUDENT'and enabled in (1,0) and enddate>= '2020-10-09' and (parentemail is not null or contactno_cel is not null or childemail is not null)
    and upid not in (select upid from userdetails_dim where category='STUDENT' and startdate > '2020-10-15') )
2020-10-17 11:02:53 INFO 235: Total students 65015
2020-10-17 11:02:53 INFO 236: usage data length 65015
2020-10-17 11:02:53 INFO 237: topics data length 45001
2020-10-17 11:02:53 INFO 238: super_df data length 199
2020-10-17 11:02:54 INFO 249: super b2b2c students 0
2020-10-17 11:02:54 INFO 250: super b2c students 198
2020-10-17 11:02:54 INFO 251: super b2b students 0 (not processing now)
2020-10-17 11:02:54 INFO 253: b2b2c students 2926
2020-10-17 11:02:54 INFO 254: b2c students 2967
2020-10-17 11:02:54 INFO 255: b2b students 123927 (not processing now)
2020-10-17 11:02:54 INFO 261: b2b2c students 2828
2020-10-17 11:02:54 INFO 262: b2c students 2945
2020-10-17 11:02:54 INFO 263: b2b students 59240 (not processing now)
2020-10-17 11:02:55 INFO 395: {'i-0d0d56e88cbd588f6': 'ec2-3-7-59-182.ap-south-1.compute.amazonaws.com'}
2020-10-17 11:07:29 INFO 457: no_usage_b2b2c_students 1245
2020-10-17 11:07:29 INFO 458: not_done_b2b2c_students 0
2020-10-17 11:07:29 INFO 459: done b2b2c students 1583
2020-10-17 11:07:29 INFO 457: no_usage_b2c_students 2275
2020-10-17 11:07:29 INFO 458: not_done_b2c_students 0
2020-10-17 11:07:29 INFO 459: done b2c students 670
2020-10-17 11:07:29 INFO 476: students 5773
2020-10-17 11:07:30 INFO 493: The whole thing took: 7.45 min
2020-10-17 11:07:32 INFO 68: Email sent!
2020-10-17 11:07:35 INFO 560: Table loading took : 0.04 min
